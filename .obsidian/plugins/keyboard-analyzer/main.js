"use strict";var bo=Object.defineProperty;var xr=t=>{throw TypeError(t)};var ko=(t,e,n)=>e in t?bo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Z=(t,e,n)=>ko(t,typeof e!="symbol"?e+"":e,n),zs=(t,e,n)=>e.has(t)||xr("Cannot "+n);var V=(t,e,n)=>(zs(t,e,"read from private field"),n?n.call(t):e.get(t)),Pe=(t,e,n)=>e.has(t)?xr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Dt=(t,e,n,i)=>(zs(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n),bn=(t,e,n)=>(zs(t,e,"access private method"),n);const rt=require("obsidian"),la=!1;var xs=Array.isArray,wo=Array.prototype.indexOf,or=Array.from,js=Object.defineProperty,xn=Object.getOwnPropertyDescriptor,ca=Object.getOwnPropertyDescriptors,Mo=Object.prototype,So=Array.prototype,lr=Object.getPrototypeOf,Er=Object.isExtensible;function Jn(t){return typeof t=="function"}const yi=()=>{};function Co(t){return t()}function Qs(t){for(var e=0;e<t.length;e++)t[e]()}function Ao(){var t,e,n=new Promise((i,s)=>{t=i,e=s});return{promise:n,resolve:t,reject:e}}function xo(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const n=[];for(const i of t)if(n.push(i),n.length===e)break;return n}const Nt=2,cr=4,Es=8,fi=16,gn=32,Bn=64,ua=128,Ut=256,us=512,yt=1024,jt=2048,Dn=4096,Xt=8192,Wn=16384,Ds=32768,es=65536,Dr=1<<17,Eo=1<<18,ur=1<<19,dr=1<<20,Ys=1<<21,fr=1<<22,Nn=1<<23,ln=Symbol("$state"),da=Symbol("legacy props"),Do=Symbol(""),vr=new class extends Error{constructor(){super(...arguments);Z(this,"name","StaleReactionError");Z(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Lo(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function pr(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Ko(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Po(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Go(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Oo(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Fo(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Io(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function To(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function No(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function zo(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Ls=1,Ks=2,fa=4,Vo=8,$o=16,qo=1,Ro=2,va=4,Ho=8,Bo=16,Wo=4,Uo=1,jo=2,ct=Symbol(),Qo="http://www.w3.org/1999/xhtml",Yo="http://www.w3.org/2000/svg",Xo="@attach";function Zo(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}let Jo=!1;function pa(t){return t===this.v}function ha(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function el(t,e){return t!==e}function ma(t){return!ha(t,this.v)}let vi=!1,tl=!1;function nl(){vi=!0}let Re=null;function ds(t){Re=t}function Tt(t){return ga().get(t)}function wi(t,e){return ga().set(t,e),e}function en(t,e=!1,n){Re={p:Re,c:null,e:null,s:t,x:null,l:vi&&!e?{s:null,u:null,$:[]}:null}}function tn(t){var e=Re,n=e.e;if(n!==null){e.e=null;for(var i of n)Ka(i)}return Re=e.p,{}}function Un(){return!vi||Re!==null&&Re.l===null}function ga(t){return Re===null&&pr(),Re.c??(Re.c=new Map(il(Re)||void 0))}function il(t){let e=t.p;for(;e!==null;){const n=e.c;if(n!==null)return n;e=e.p}return null}const sl=new WeakMap;function rl(t){var e=ge;if(e===null)return Me.f|=Nn,t;if((e.f&Ds)===0){if((e.f&ua)===0)throw!e.parent&&t instanceof Error&&ya(t),t;e.b.error(t)}else hr(t,e)}function hr(t,e){for(;e!==null;){if((e.f&ua)!==0)try{e.b.error(t);return}catch(n){t=n}e=e.parent}throw t instanceof Error&&ya(t),t}function ya(t){const e=sl.get(t);e&&(js(t,"message",{value:e.message}),js(t,"stack",{value:e.stack}))}let fs=[];function al(){var t=fs;fs=[],Qs(t)}function ts(t){fs.length===0&&queueMicrotask(al),fs.push(t)}function ol(){for(var t=ge.b;t!==null&&!t.has_pending_snippet();)t=t.parent;return t===null&&Lo(),t}function ns(t){var e=Nt|jt,n=Me!==null&&(Me.f&Nt)!==0?Me:null;return ge===null||n!==null&&(n.f&Ut)!==0?e|=Ut:ge.f|=ur,{ctx:Re,deps:null,effects:null,equals:pa,f:e,fn:t,reactions:null,rv:0,v:ct,wv:0,parent:n??ge,ac:null}}function ll(t,e){let n=ge;n===null&&Ko();var i=n.b,s=void 0,r=ci(ct),o=null,l=!Me;return bl(()=>{try{var c=t()}catch(y){c=Promise.reject(y)}var u=()=>c;s=(o==null?void 0:o.then(u,u))??Promise.resolve(c),o=s;var d=Te,f=i.pending;l&&(i.update_pending_count(1),f||d.increment());const m=(y,p=void 0)=>{o=null,f||d.activate(),p?p!==vr&&(r.f|=Nn,Di(r,p)):((r.f&Nn)!==0&&(r.f^=Nn),Di(r,y)),l&&(i.update_pending_count(-1),f||d.decrement()),wa()};if(s.then(m,y=>m(null,y||"unknown")),d)return()=>{queueMicrotask(()=>d.neuter())}}),new Promise(c=>{function u(d){function f(){d===s?c(r):u(s)}d.then(f,f)}u(s)})}function He(t){const e=ns(t);return Na(e),e}function mr(t){const e=ns(t);return e.equals=ma,e}function _a(t){var e=t.effects;if(e!==null){t.effects=null;for(var n=0;n<e.length;n+=1)zt(e[n])}}function cl(t){for(var e=t.parent;e!==null;){if((e.f&Nt)===0)return e;e=e.parent}return null}function gr(t){var e,n=ge;un(cl(t));try{_a(t),e=qa(t)}finally{un(n)}return e}function ba(t){var e=gr(t);if(t.equals(e)||(t.v=e,t.wv=Va()),!Yn)if(Cn!==null)Cn.set(t,t.v);else{var n=(An||(t.f&Ut)!==0)&&t.deps!==null?Dn:yt;Kt(t,n)}}function ka(t,e,n){const i=Un()?ns:mr;if(e.length===0){n(t.map(i));return}var s=Te,r=ge,o=ul(),l=ol();Promise.all(e.map(c=>ll(c))).then(c=>{s==null||s.activate(),o();try{n([...t.map(i),...c])}catch(u){(r.f&Wn)===0&&hr(u,r)}s==null||s.deactivate(),wa()}).catch(c=>{l.error(c)})}function ul(){var t=ge,e=Me,n=Re;return function(){un(t),cn(e),ds(n)}}function wa(){un(null),cn(null),ds(null)}const _i=new Set;let Te=null,ls=null,Cn=null,Lr=new Set,vs=[];function Ma(){const t=vs.shift();vs.length>0&&queueMicrotask(Ma),t()}let xi=[],yr=null,Xs=!1;var si,ri,wn,Ti,Ni,In,ai,Tn,Mn,oi,zi,Vi,Zt,Sa,cs,Zs;const Ss=class Ss{constructor(){Pe(this,Zt);Z(this,"current",new Map);Pe(this,si,new Map);Pe(this,ri,new Set);Pe(this,wn,0);Pe(this,Ti,null);Pe(this,Ni,!1);Pe(this,In,[]);Pe(this,ai,[]);Pe(this,Tn,[]);Pe(this,Mn,[]);Pe(this,oi,[]);Pe(this,zi,[]);Pe(this,Vi,[]);Z(this,"skipped_effects",new Set)}process(e){var r;xi=[],ls=null;var n=null;if(_i.size>1){n=new Map,Cn=new Map;for(const[o,l]of this.current)n.set(o,{v:o.v,wv:o.wv}),o.v=l;for(const o of _i)if(o!==this)for(const[l,c]of V(o,si))n.has(l)||(n.set(l,{v:l.v,wv:l.wv}),l.v=c)}for(const o of e)bn(this,Zt,Sa).call(this,o);if(V(this,In).length===0&&V(this,wn)===0){bn(this,Zt,Zs).call(this);var i=V(this,Tn),s=V(this,Mn);Dt(this,Tn,[]),Dt(this,Mn,[]),Dt(this,oi,[]),ls=Te,Te=null,Kr(i),Kr(s),Te===null?Te=this:_i.delete(this),(r=V(this,Ti))==null||r.resolve()}else bn(this,Zt,cs).call(this,V(this,Tn)),bn(this,Zt,cs).call(this,V(this,Mn)),bn(this,Zt,cs).call(this,V(this,oi));if(n){for(const[o,{v:l,wv:c}]of n)o.wv<=c&&(o.v=l);Cn=null}for(const o of V(this,In))Ci(o);for(const o of V(this,ai))Ci(o);Dt(this,In,[]),Dt(this,ai,[])}capture(e,n){V(this,si).has(e)||V(this,si).set(e,n),this.current.set(e,e.v)}activate(){Te=this}deactivate(){Te=null,ls=null;for(const e of Lr)if(Lr.delete(e),e(),Te!==null)break}neuter(){Dt(this,Ni,!0)}flush(){xi.length>0?dl():bn(this,Zt,Zs).call(this),Te===this&&(V(this,wn)===0&&_i.delete(this),this.deactivate())}increment(){Dt(this,wn,V(this,wn)+1)}decrement(){if(Dt(this,wn,V(this,wn)-1),V(this,wn)===0){for(const e of V(this,zi))Kt(e,jt),qn(e);for(const e of V(this,Vi))Kt(e,Dn),qn(e);Dt(this,Tn,[]),Dt(this,Mn,[]),this.flush()}else this.deactivate()}add_callback(e){V(this,ri).add(e)}settled(){return(V(this,Ti)??Dt(this,Ti,Ao())).promise}static ensure(){if(Te===null){const e=Te=new Ss;_i.add(Te),Ss.enqueue(()=>{Te===e&&e.flush()})}return Te}static enqueue(e){vs.length===0&&queueMicrotask(Ma),vs.unshift(e)}};si=new WeakMap,ri=new WeakMap,wn=new WeakMap,Ti=new WeakMap,Ni=new WeakMap,In=new WeakMap,ai=new WeakMap,Tn=new WeakMap,Mn=new WeakMap,oi=new WeakMap,zi=new WeakMap,Vi=new WeakMap,Zt=new WeakSet,Sa=function(e){var d;e.f^=yt;for(var n=e.first;n!==null;){var i=n.f,s=(i&(gn|Bn))!==0,r=s&&(i&yt)!==0,o=r||(i&Xt)!==0||this.skipped_effects.has(n);if(!o&&n.fn!==null){if(s)n.f^=yt;else if((i&yt)===0)if((i&cr)!==0)V(this,Mn).push(n);else if((i&fr)!==0){var l=(d=n.b)!=null&&d.pending?V(this,ai):V(this,In);l.push(n)}else Os(n)&&((n.f&fi)!==0&&V(this,oi).push(n),Ci(n));var c=n.first;if(c!==null){n=c;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)n=u.next,u=u.parent}},cs=function(e){for(const n of e)((n.f&jt)!==0?V(this,zi):V(this,Vi)).push(n),Kt(n,yt);e.length=0},Zs=function(){if(!V(this,Ni))for(const e of V(this,ri))e();V(this,ri).clear()};let Ei=Ss;function dl(){var t=ni;Xs=!0;try{var e=0;for(Fr(!0);xi.length>0;){var n=Ei.ensure();if(e++>1e3){var i,s;fl()}n.process(xi),zn.clear()}}finally{Xs=!1,Fr(t),yr=null}}function fl(){try{Fo()}catch(t){hr(t,yr)}}function Kr(t){var e=t.length;if(e!==0){for(var n=0;n<e;){var i=t[n++];if((i.f&(Wn|Xt))===0&&Os(i)){var s=Te?Te.current.size:0;if(Ci(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null&&i.ac===null?Fa(i):i.fn=null),Te!==null&&Te.current.size>s&&(i.f&dr)!==0)break}}for(;n<e;)qn(t[n++])}}function qn(t){for(var e=yr=t;e.parent!==null;){e=e.parent;var n=e.f;if(Xs&&e===ge&&(n&fi)!==0)return;if((n&(Bn|gn))!==0){if((n&yt)===0)return;e.f^=yt}}xi.push(e)}const zn=new Map;function ci(t,e){var n={f:0,v:t,reactions:null,equals:pa,rv:0,wv:0};return n}function F(t,e){const n=ci(t);return Na(n),n}function vl(t,e=!1,n=!0){var s;const i=ci(t);return e||(i.equals=ma),vi&&n&&Re!==null&&Re.l!==null&&((s=Re.l).s??(s.s=[])).push(i),i}function g(t,e,n=!1){Me!==null&&(!on||(Me.f&Dr)!==0)&&Un()&&(Me.f&(Nt|fi|fr|Dr))!==0&&!(Ct!=null&&Ct.includes(t))&&zo();let i=n?Be(e):e;return Di(t,i)}function Di(t,e){if(!t.equals(e)){var n=t.v;Yn?zn.set(t,e):zn.set(t,n),t.v=e;var i=Ei.ensure();i.capture(t,n),(t.f&Nt)!==0&&((t.f&jt)!==0&&gr(t),Kt(t,(t.f&Ut)===0?yt:Dn)),t.wv=Va(),Ca(t,jt),Un()&&ge!==null&&(ge.f&yt)!==0&&(ge.f&(gn|Bn))===0&&(Bt===null?Ml([t]):Bt.push(t))}return e}function Pr(t,e=1){var n=a(t),i=e===1?n++:n--;return g(t,n),i}function Vs(t){g(t,t.v+1)}function Ca(t,e){var n=t.reactions;if(n!==null)for(var i=Un(),s=n.length,r=0;r<s;r++){var o=n[r],l=o.f;if(!(!i&&o===ge)){var c=(l&jt)===0;c&&Kt(o,e),(l&Nt)!==0?Ca(o,Dn):c&&qn(o)}}}function Be(t){if(typeof t!="object"||t===null||ln in t)return t;const e=lr(t);if(e!==Mo&&e!==So)return t;var n=new Map,i=xs(t),s=F(0),r=Vn,o=l=>{if(Vn===r)return l();var c=Me,u=Vn;cn(null),Tr(r);var d=l();return cn(c),Tr(u),d};return i&&n.set("length",F(t.length)),new Proxy(t,{defineProperty(l,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&To();var d=n.get(c);return d===void 0?d=o(()=>{var f=F(u.value);return n.set(c,f),f}):g(d,u.value,!0),!0},deleteProperty(l,c){var u=n.get(c);if(u===void 0){if(c in l){const d=o(()=>F(ct));n.set(c,d),Vs(s)}}else g(u,ct),Vs(s);return!0},get(l,c,u){var y;if(c===ln)return t;var d=n.get(c),f=c in l;if(d===void 0&&(!f||(y=xn(l,c))!=null&&y.writable)&&(d=o(()=>{var p=Be(f?l[c]:ct),_=F(p);return _}),n.set(c,d)),d!==void 0){var m=a(d);return m===ct?void 0:m}return Reflect.get(l,c,u)},getOwnPropertyDescriptor(l,c){var u=Reflect.getOwnPropertyDescriptor(l,c);if(u&&"value"in u){var d=n.get(c);d&&(u.value=a(d))}else if(u===void 0){var f=n.get(c),m=f==null?void 0:f.v;if(f!==void 0&&m!==ct)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return u},has(l,c){var m;if(c===ln)return!0;var u=n.get(c),d=u!==void 0&&u.v!==ct||Reflect.has(l,c);if(u!==void 0||ge!==null&&(!d||(m=xn(l,c))!=null&&m.writable)){u===void 0&&(u=o(()=>{var y=d?Be(l[c]):ct,p=F(y);return p}),n.set(c,u));var f=a(u);if(f===ct)return!1}return d},set(l,c,u,d){var x;var f=n.get(c),m=c in l;if(i&&c==="length")for(var y=u;y<f.v;y+=1){var p=n.get(y+"");p!==void 0?g(p,ct):y in l&&(p=o(()=>F(ct)),n.set(y+"",p))}if(f===void 0)(!m||(x=xn(l,c))!=null&&x.writable)&&(f=o(()=>F(void 0)),g(f,Be(u)),n.set(c,f));else{m=f.v!==ct;var _=o(()=>Be(u));g(f,_)}var w=Reflect.getOwnPropertyDescriptor(l,c);if(w!=null&&w.set&&w.set.call(d,u),!m){if(i&&typeof c=="string"){var S=n.get("length"),A=Number(c);Number.isInteger(A)&&A>=S.v&&g(S,A+1)}Vs(s)}return!0},ownKeys(l){a(s);var c=Reflect.ownKeys(l).filter(f=>{var m=n.get(f);return m===void 0||m.v!==ct});for(var[u,d]of n)d.v!==ct&&!(u in l)&&c.push(u);return c},setPrototypeOf(){No()}})}function Gr(t){try{if(t!==null&&typeof t=="object"&&ln in t)return t[ln]}catch{}return t}function pl(t,e){return Object.is(Gr(t),Gr(e))}var Or,Aa,xa,Ea;function hl(){if(Or===void 0){Or=window,Aa=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,n=Text.prototype;xa=xn(e,"firstChild").get,Ea=xn(e,"nextSibling").get,Er(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),Er(n)&&(n.__t=void 0)}}function jn(t=""){return document.createTextNode(t)}function ui(t){return xa.call(t)}function Ps(t){return Ea.call(t)}function h(t,e){return ui(t)}function Le(t,e){{var n=ui(t);return n instanceof Comment&&n.data===""?Ps(n):n}}function k(t,e=1,n=!1){let i=t;for(;e--;)i=Ps(i);return i}function ml(t){t.textContent=""}function _r(){return!1}function Da(t){ge===null&&Me===null&&Oo(),Me!==null&&(Me.f&Ut)!==0&&ge===null&&Go(),Yn&&Po()}function gl(t,e){var n=e.last;n===null?e.last=e.first=t:(n.next=t,t.prev=n,e.last=t)}function dn(t,e,n,i=!0){var s=ge;s!==null&&(s.f&Xt)!==0&&(t|=Xt);var r={ctx:Re,deps:null,nodes_start:null,nodes_end:null,f:t|jt,first:null,fn:e,last:null,next:null,parent:s,b:s&&s.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{Ci(r),r.f|=Ds}catch(c){throw zt(r),c}else e!==null&&qn(r);var o=n&&r.deps===null&&r.first===null&&r.nodes_start===null&&r.teardown===null&&(r.f&ur)===0;if(!o&&i&&(s!==null&&gl(r,s),Me!==null&&(Me.f&Nt)!==0&&(t&Bn)===0)){var l=Me;(l.effects??(l.effects=[])).push(r)}return r}function La(t){const e=dn(Es,null,!1);return Kt(e,yt),e.teardown=t,e}function gt(t){Da();var e=ge.f,n=!Me&&(e&gn)!==0&&(e&Ds)===0;if(n){var i=Re;(i.e??(i.e=[])).push(t)}else return Ka(t)}function Ka(t){return dn(cr|dr,t,!1)}function yl(t){return Da(),dn(Es|dr,t,!0)}function _l(t){Ei.ensure();const e=dn(Bn,t,!0);return(n={})=>new Promise(i=>{n.outro?is(e,()=>{zt(e),i(void 0)}):(zt(e),i(void 0))})}function Qn(t){return dn(cr,t,!1)}function bl(t){return dn(fr|ur,t,!0)}function Pa(t,e=0){return dn(Es|e,t,!0)}function ee(t,e=[],n=[]){ka(e,n,i=>{dn(Es,()=>t(...i.map(a)),!0)})}function pi(t,e=0){var n=dn(fi|e,t,!0);return n}function mn(t,e=!0){return dn(gn,t,!0,e)}function Ga(t){var e=t.teardown;if(e!==null){const n=Yn,i=Me;Ir(!0),cn(null);try{e.call(null)}finally{Ir(n),cn(i)}}}function Oa(t,e=!1){var s;var n=t.first;for(t.first=t.last=null;n!==null;){(s=n.ac)==null||s.abort(vr);var i=n.next;(n.f&Bn)!==0?n.parent=null:zt(n,e),n=i}}function kl(t){for(var e=t.first;e!==null;){var n=e.next;(e.f&gn)===0&&zt(e),e=n}}function zt(t,e=!0){var n=!1;(e||(t.f&Eo)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(wl(t.nodes_start,t.nodes_end),n=!0),Oa(t,e&&!n),ps(t,0),Kt(t,Wn);var i=t.transitions;if(i!==null)for(const r of i)r.stop();Ga(t);var s=t.parent;s!==null&&s.first!==null&&Fa(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function wl(t,e){for(;t!==null;){var n=t===e?null:Ps(t);t.remove(),t=n}}function Fa(t){var e=t.parent,n=t.prev,i=t.next;n!==null&&(n.next=i),i!==null&&(i.prev=n),e!==null&&(e.first===t&&(e.first=i),e.last===t&&(e.last=n))}function is(t,e){var n=[];br(t,n,!0),Ia(n,()=>{zt(t),e&&e()})}function Ia(t,e){var n=t.length;if(n>0){var i=()=>--n||e();for(var s of t)s.out(i)}else e()}function br(t,e,n){if((t.f&Xt)===0){if(t.f^=Xt,t.transitions!==null)for(const o of t.transitions)(o.is_global||n)&&e.push(o);for(var i=t.first;i!==null;){var s=i.next,r=(i.f&es)!==0||(i.f&gn)!==0;br(i,e,r?n:!1),i=s}}}function Gs(t){Ta(t,!0)}function Ta(t,e){if((t.f&Xt)!==0){t.f^=Xt,(t.f&yt)===0&&(Kt(t,jt),qn(t));for(var n=t.first;n!==null;){var i=n.next,s=(n.f&es)!==0||(n.f&gn)!==0;Ta(n,s?e:!1),n=i}if(t.transitions!==null)for(const r of t.transitions)(r.is_global||e)&&r.in()}}let ni=!1;function Fr(t){ni=t}let Yn=!1;function Ir(t){Yn=t}let Me=null,on=!1;function cn(t){Me=t}let ge=null;function un(t){ge=t}let Ct=null;function Na(t){Me!==null&&(Ct===null?Ct=[t]:Ct.push(t))}let wt=null,Ot=0,Bt=null;function Ml(t){Bt=t}let za=1,Li=0,Vn=Li;function Tr(t){Vn=t}let An=!1;function Va(){return++za}function Os(t){var f;var e=t.f;if((e&jt)!==0)return!0;if((e&Dn)!==0){var n=t.deps,i=(e&Ut)!==0;if(n!==null){var s,r,o=(e&us)!==0,l=i&&ge!==null&&!An,c=n.length;if((o||l)&&(ge===null||(ge.f&Wn)===0)){var u=t,d=u.parent;for(s=0;s<c;s++)r=n[s],(o||!((f=r==null?void 0:r.reactions)!=null&&f.includes(u)))&&(r.reactions??(r.reactions=[])).push(u);o&&(u.f^=us),l&&d!==null&&(d.f&Ut)===0&&(u.f^=Ut)}for(s=0;s<c;s++)if(r=n[s],Os(r)&&ba(r),r.wv>t.wv)return!0}(!i||ge!==null&&!An)&&Kt(t,yt)}return!1}function $a(t,e,n=!0){var i=t.reactions;if(i!==null&&!(Ct!=null&&Ct.includes(t)))for(var s=0;s<i.length;s++){var r=i[s];(r.f&Nt)!==0?$a(r,e,!1):e===r&&(n?Kt(r,jt):(r.f&yt)!==0&&Kt(r,Dn),qn(r))}}function qa(t){var p;var e=wt,n=Ot,i=Bt,s=Me,r=An,o=Ct,l=Re,c=on,u=Vn,d=t.f;wt=null,Ot=0,Bt=null,An=(d&Ut)!==0&&(on||!ni||Me===null),Me=(d&(gn|Bn))===0?t:null,Ct=null,ds(t.ctx),on=!1,Vn=++Li,t.ac!==null&&(t.ac.abort(vr),t.ac=null);try{t.f|=Ys;var f=(0,t.fn)(),m=t.deps;if(wt!==null){var y;if(ps(t,Ot),m!==null&&Ot>0)for(m.length=Ot+wt.length,y=0;y<wt.length;y++)m[Ot+y]=wt[y];else t.deps=m=wt;if(!An||(d&Nt)!==0&&t.reactions!==null)for(y=Ot;y<m.length;y++)((p=m[y]).reactions??(p.reactions=[])).push(t)}else m!==null&&Ot<m.length&&(ps(t,Ot),m.length=Ot);if(Un()&&Bt!==null&&!on&&m!==null&&(t.f&(Nt|Dn|jt))===0)for(y=0;y<Bt.length;y++)$a(Bt[y],t);return s!==null&&s!==t&&(Li++,Bt!==null&&(i===null?i=Bt:i.push(...Bt))),(t.f&Nn)!==0&&(t.f^=Nn),f}catch(_){return rl(_)}finally{t.f^=Ys,wt=e,Ot=n,Bt=i,Me=s,An=r,Ct=o,ds(l),on=c,Vn=u}}function Sl(t,e){let n=e.reactions;if(n!==null){var i=wo.call(n,t);if(i!==-1){var s=n.length-1;s===0?n=e.reactions=null:(n[i]=n[s],n.pop())}}n===null&&(e.f&Nt)!==0&&(wt===null||!wt.includes(e))&&(Kt(e,Dn),(e.f&(Ut|us))===0&&(e.f^=us),_a(e),ps(e,0))}function ps(t,e){var n=t.deps;if(n!==null)for(var i=e;i<n.length;i++)Sl(t,n[i])}function Ci(t){var e=t.f;if((e&Wn)===0){Kt(t,yt);var n=ge,i=ni;ge=t,ni=!0;try{(e&fi)!==0?kl(t):Oa(t),Ga(t);var s=qa(t);t.teardown=typeof s=="function"?s:null,t.wv=za;var r;la&&tl&&(t.f&jt)!==0&&t.deps}finally{ni=i,ge=n}}}function a(t){var e=t.f,n=(e&Nt)!==0;if(Me!==null&&!on){var i=ge!==null&&(ge.f&Wn)!==0;if(!i&&!(Ct!=null&&Ct.includes(t))){var s=Me.deps;if((Me.f&Ys)!==0)t.rv<Li&&(t.rv=Li,wt===null&&s!==null&&s[Ot]===t?Ot++:wt===null?wt=[t]:(!An||!wt.includes(t))&&wt.push(t));else{(Me.deps??(Me.deps=[])).push(t);var r=t.reactions;r===null?t.reactions=[Me]:r.includes(Me)||r.push(Me)}}}else if(n&&t.deps===null&&t.effects===null){var o=t,l=o.parent;l!==null&&(l.f&Ut)===0&&(o.f^=Ut)}if(Yn){if(zn.has(t))return zn.get(t);if(n){o=t;var c=o.v;return((o.f&yt)===0&&o.reactions!==null||Ra(o))&&(c=gr(o)),zn.set(o,c),c}}else if(n){if(o=t,Cn!=null&&Cn.has(o))return Cn.get(o);Os(o)&&ba(o)}if((t.f&Nn)!==0)throw t.v;return t.v}function Ra(t){if(t.v===ct)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(zn.has(e)||(e.f&Nt)!==0&&Ra(e))return!0;return!1}function Jt(t){var e=on;try{return on=!0,t()}finally{on=e}}const Cl=-7169;function Kt(t,e){t.f=t.f&Cl|e}function ei(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ln in t)Js(t);else if(!Array.isArray(t))for(let e in t){const n=t[e];typeof n=="object"&&n&&ln in n&&Js(n)}}}function Js(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let i in t)try{Js(t[i],e)}catch{}const n=lr(t);if(n!==Object.prototype&&n!==Array.prototype&&n!==Map.prototype&&n!==Set.prototype&&n!==Date.prototype){const i=ca(n);for(let s in i){const r=i[s].get;if(r)try{r.call(t)}catch{}}}}}function Al(t){return t.endsWith("capture")&&t!=="gotpointercapture"&&t!=="lostpointercapture"}const xl=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function El(t){return xl.includes(t)}const Dl={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Ll(t){return t=t.toLowerCase(),Dl[t]??t}const Kl=["touchstart","touchmove"];function Pl(t){return Kl.includes(t)}function Gl(t,e){if(e){const n=document.body;t.autofocus=!0,ts(()=>{document.activeElement===n&&t.focus()})}}let Nr=!1;function Ol(){Nr||(Nr=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const n of t.target.elements)(e=n.__on_r)==null||e.call(n)})},{capture:!0}))}function Fs(t){var e=Me,n=ge;cn(null),un(null);try{return t()}finally{cn(e),un(n)}}function Ha(t,e,n,i=n){t.addEventListener(e,()=>Fs(n));const s=t.__on_r;s?t.__on_r=()=>{s(),i(!0)}:t.__on_r=()=>i(!0),Ol()}const Ba=new Set,er=new Set;function Wa(t,e,n,i={}){function s(r){if(i.capture||Mi.call(e,r),!r.cancelBubble)return Fs(()=>n==null?void 0:n.call(this,r))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?ts(()=>{e.addEventListener(t,s,i)}):e.addEventListener(t,s,i),s}function Qe(t,e,n,i,s){var r={capture:i,passive:s},o=Wa(t,e,n,r);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&La(()=>{e.removeEventListener(t,o,r)})}function yn(t){for(var e=0;e<t.length;e++)Ba.add(t[e]);for(var n of er)n(t)}let zr=null;function Mi(t){var A;var e=this,n=e.ownerDocument,i=t.type,s=((A=t.composedPath)==null?void 0:A.call(t))||[],r=s[0]||t.target;zr=t;var o=0,l=zr===t&&t.__root;if(l){var c=s.indexOf(l);if(c!==-1&&(e===document||e===window)){t.__root=e;return}var u=s.indexOf(e);if(u===-1)return;c<=u&&(o=c)}if(r=s[o]||t.target,r!==e){js(t,"currentTarget",{configurable:!0,get(){return r||n}});var d=Me,f=ge;cn(null),un(null);try{for(var m,y=[];r!==null;){var p=r.assignedSlot||r.parentNode||r.host||null;try{var _=r["__"+i];if(_!=null&&(!r.disabled||t.target===r))if(xs(_)){var[w,...S]=_;w.apply(r,[t,...S])}else _.call(r,t)}catch(x){m?y.push(x):m=x}if(t.cancelBubble||p===e||p===null)break;r=p}if(m){for(let x of y)queueMicrotask(()=>{throw x});throw m}}finally{t.__root=e,delete t.currentTarget,cn(d),un(f)}}}function Ua(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Ki(t,e){var n=ge;n.nodes_start===null&&(n.nodes_start=t,n.nodes_end=e)}function I(t,e){var n=(e&Uo)!==0,i=(e&jo)!==0,s,r=!t.startsWith("<!>");return()=>{s===void 0&&(s=Ua(r?t:"<!>"+t),n||(s=ui(s)));var o=i||Aa?document.importNode(s,!0):s.cloneNode(!0);if(n){var l=ui(o),c=o.lastChild;Ki(l,c)}else Ki(o,o);return o}}function Fl(t,e,n="svg"){var i=!t.startsWith("<!>"),s=`<${n}>${i?t:"<!>"+t}</${n}>`,r;return()=>{if(!r){var o=Ua(s),l=ui(o);r=ui(l)}var c=r.cloneNode(!0);return Ki(c,c),c}}function Il(t,e){return Fl(t,e,"svg")}function Xe(){var t=document.createDocumentFragment(),e=document.createComment(""),n=jn();return t.append(e,n),Ki(e,n),t}function E(t,e){t!==null&&t.before(e)}let hs=!0;function Vr(t){hs=t}function ae(t,e){var n=e==null?"":typeof e=="object"?e+"":e;n!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=n,t.nodeValue=n+"")}function ja(t,e){return Tl(t,e)}const Xn=new Map;function Tl(t,{target:e,anchor:n,props:i={},events:s,context:r,intro:o=!0}){hl();var l=new Set,c=f=>{for(var m=0;m<f.length;m++){var y=f[m];if(!l.has(y)){l.add(y);var p=Pl(y);e.addEventListener(y,Mi,{passive:p});var _=Xn.get(y);_===void 0?(document.addEventListener(y,Mi,{passive:p}),Xn.set(y,1)):Xn.set(y,_+1)}}};c(or(Ba)),er.add(c);var u=void 0,d=_l(()=>{var f=n??e.appendChild(jn());return mn(()=>{if(r){en({});var m=Re;m.c=r}s&&(i.$$events=s),hs=o,u=t(f,i)||{},hs=!0,r&&tn()}),()=>{var p;for(var m of l){e.removeEventListener(m,Mi);var y=Xn.get(m);--y===0?(document.removeEventListener(m,Mi),Xn.delete(m)):Xn.set(m,y)}er.delete(c),f!==n&&((p=f.parentNode)==null||p.removeChild(f))}});return tr.set(u,d),u}let tr=new WeakMap;function Qa(t,e){const n=tr.get(t);return n?(tr.delete(t),n(e)):Promise.resolve()}function ve(t,e,n=!1){var i=t,s=null,r=null,o=ct,l=n?es:0,c=!1;const u=(y,p=!0)=>{c=!0,m(p,y)};var d=null;function f(){d!==null&&(d.lastChild.remove(),i.before(d),d=null);var y=o?s:r,p=o?r:s;y&&Gs(y),p&&is(p,()=>{o?r=null:s=null})}const m=(y,p)=>{if(o!==(o=y)){var _=_r(),w=i;if(_&&(d=document.createDocumentFragment(),d.append(w=jn())),o?s??(s=p&&mn(()=>p(w))):r??(r=p&&mn(()=>p(w))),_){var S=Te,A=o?s:r,x=o?r:s;A&&S.skipped_effects.delete(A),x&&S.skipped_effects.add(x),S.add_callback(f)}else f()}};pi(()=>{c=!1,e(u),c||m(null,null)},l)}function nr(t,e,n){var i=t,s=ct,r,o,l=null,c=Un()?el:ha;function u(){r&&is(r),l!==null&&(l.lastChild.remove(),i.before(l),l=null),r=o}pi(()=>{if(c(s,s=e())){var d=i,f=_r();f&&(l=document.createDocumentFragment(),l.append(d=jn())),o=mn(()=>n(d)),f?Te.add_callback(u):u()}})}function It(t,e){return e}function Nl(t,e,n){for(var i=t.items,s=[],r=e.length,o=0;o<r;o++)br(e[o].e,s,!0);var l=r>0&&s.length===0&&n!==null;if(l){var c=n.parentNode;ml(c),c.append(n),i.clear(),an(t,e[0].prev,e[r-1].next)}Ia(s,()=>{for(var u=0;u<r;u++){var d=e[u];l||(i.delete(d.k),an(t,d.prev,d.next)),zt(d.e,!l)}})}function Je(t,e,n,i,s,r=null){var o=t,l={flags:e,items:new Map,first:null},c=(e&fa)!==0;if(c){var u=t;o=u.appendChild(jn())}var d=null,f=!1,m=new Map,y=mr(()=>{var S=n();return xs(S)?S:S==null?[]:or(S)}),p,_;function w(){zl(_,p,l,m,o,s,e,i,n),r!==null&&(p.length===0?d?Gs(d):d=mn(()=>r(o)):d!==null&&is(d,()=>{d=null}))}pi(()=>{_??(_=ge),p=a(y);var S=p.length;if(!(f&&S===0)){f=S===0;var A,x,L,K;if(_r()){var M=new Set,z=Te;for(x=0;x<S;x+=1){L=p[x],K=i(L,x);var te=l.items.get(K)??m.get(K);te?(e&(Ls|Ks))!==0&&Ya(te,L,x,e):(A=Xa(null,l,null,null,L,K,x,s,e,n,!0),m.set(K,A)),M.add(K)}for(const[se,N]of l.items)M.has(se)||z.skipped_effects.add(N.e);z.add_callback(w)}else w();a(y)}})}function zl(t,e,n,i,s,r,o,l,c){var j,Y,Q,fe;var u=(o&Vo)!==0,d=(o&(Ls|Ks))!==0,f=e.length,m=n.items,y=n.first,p=y,_,w=null,S,A=[],x=[],L,K,M,z;if(u)for(z=0;z<f;z+=1)L=e[z],K=l(L,z),M=m.get(K),M!==void 0&&((j=M.a)==null||j.measure(),(S??(S=new Set)).add(M));for(z=0;z<f;z+=1){if(L=e[z],K=l(L,z),M=m.get(K),M===void 0){var te=i.get(K);if(te!==void 0){i.delete(K),m.set(K,te);var se=w?w.next:p;an(n,w,te),an(n,te,se),$s(te,se,s),w=te}else{var N=p?p.e.nodes_start:s;w=Xa(N,n,w,w===null?n.first:w.next,L,K,z,r,o,c)}m.set(K,w),A=[],x=[],p=w.next;continue}if(d&&Ya(M,L,z,o),(M.e.f&Xt)!==0&&(Gs(M.e),u&&((Y=M.a)==null||Y.unfix(),(S??(S=new Set)).delete(M))),M!==p){if(_!==void 0&&_.has(M)){if(A.length<x.length){var J=x[0],oe;w=J.prev;var U=A[0],$=A[A.length-1];for(oe=0;oe<A.length;oe+=1)$s(A[oe],J,s);for(oe=0;oe<x.length;oe+=1)_.delete(x[oe]);an(n,U.prev,$.next),an(n,w,U),an(n,$,J),p=J,w=$,z-=1,A=[],x=[]}else _.delete(M),$s(M,p,s),an(n,M.prev,M.next),an(n,M,w===null?n.first:w.next),an(n,w,M),w=M;continue}for(A=[],x=[];p!==null&&p.k!==K;)(p.e.f&Xt)===0&&(_??(_=new Set)).add(p),x.push(p),p=p.next;if(p===null)continue;M=p}A.push(M),w=M,p=M.next}if(p!==null||_!==void 0){for(var re=_===void 0?[]:or(_);p!==null;)(p.e.f&Xt)===0&&re.push(p),p=p.next;var Ge=re.length;if(Ge>0){var b=(o&fa)!==0&&f===0?s:null;if(u){for(z=0;z<Ge;z+=1)(Q=re[z].a)==null||Q.measure();for(z=0;z<Ge;z+=1)(fe=re[z].a)==null||fe.fix()}Nl(n,re,b)}}u&&ts(()=>{var W;if(S!==void 0)for(M of S)(W=M.a)==null||W.apply()}),t.first=n.first&&n.first.e,t.last=w&&w.e;for(var O of i.values())zt(O.e);i.clear()}function Ya(t,e,n,i){(i&Ls)!==0&&Di(t.v,e),(i&Ks)!==0?Di(t.i,n):t.i=n}function Xa(t,e,n,i,s,r,o,l,c,u,d){var f=(c&Ls)!==0,m=(c&$o)===0,y=f?m?vl(s,!1,!1):ci(s):s,p=(c&Ks)===0?o:ci(o),_={i:p,v:y,k:r,a:null,e:null,prev:n,next:i};try{if(t===null){var w=document.createDocumentFragment();w.append(t=jn())}return _.e=mn(()=>l(t,y,p,u),Jo),_.e.prev=n&&n.e,_.e.next=i&&i.e,n===null?d||(e.first=_):(n.next=_,n.e.next=_.e),i!==null&&(i.prev=_,i.e.prev=_.e),_}finally{}}function $s(t,e,n){for(var i=t.next?t.next.e.nodes_start:n,s=e?e.e.nodes_start:n,r=t.e.nodes_start;r!==null&&r!==i;){var o=Ps(r);s.before(r),r=o}}function an(t,e,n){e===null?t.first=n:(e.next=n,e.e.next=n&&n.e),n!==null&&(n.prev=e,n.e.prev=e&&e.e)}function Pt(t,e,n,i,s){var l;var r=(l=e.$$slots)==null?void 0:l[n],o=!1;r===!0&&(r=e.children,o=!0),r===void 0||r(t,o?()=>i:i)}function Vl(t,e,n,i,s,r){var o,l,c=null,u=t,d;pi(()=>{const f=e()||null;var m=Yo;f!==o&&(d&&(f===null?is(d,()=>{d=null,l=null}):f===l?Gs(d):(zt(d),Vr(!1))),f&&f!==l&&(d=mn(()=>{if(c=document.createElementNS(m,f),Ki(c,c),i){var y=c.appendChild(jn());i(c,y)}ge.nodes_end=c,u.before(c)})),o=f,o&&(l=o),Vr(!0))},es)}function Pi(t,e,n){Qn(()=>{var i=Jt(()=>e(t,n==null?void 0:n())||{});if(i!=null&&i.destroy)return()=>i.destroy()})}function $l(t,e){var n=void 0,i;pi(()=>{n!==(n=e())&&(i&&(zt(i),i=null),n&&(i=mn(()=>{Qn(()=>n(t))})))})}function Za(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=Za(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function ql(){for(var t,e,n=0,i="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=Za(t))&&(i&&(i+=" "),i+=e);return i}function ii(t){return typeof t=="object"?ql(t):t??""}const $r=[...` 	
\r\f \v\uFEFF`];function Rl(t,e,n){var i=t==null?"":""+t;if(e&&(i=i?i+" "+e:e),n){for(var s in n)if(n[s])i=i?i+" "+s:s;else if(i.length)for(var r=s.length,o=0;(o=i.indexOf(s,o))>=0;){var l=o+r;(o===0||$r.includes(i[o-1]))&&(l===i.length||$r.includes(i[l]))?i=(o===0?"":i.substring(0,o))+i.substring(l+1):o=l}}return i===""?null:i}function qr(t,e=!1){var n=e?" !important;":";",i="";for(var s in t){var r=t[s];r!=null&&r!==""&&(i+=" "+s+": "+r+n)}return i}function qs(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Hl(t,e){if(e){var n="",i,s;if(Array.isArray(e)?(i=e[0],s=e[1]):i=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var r=!1,o=0,l=!1,c=[];i&&c.push(...Object.keys(i).map(qs)),s&&c.push(...Object.keys(s).map(qs));var u=0,d=-1;const _=t.length;for(var f=0;f<_;f++){var m=t[f];if(l?m==="/"&&t[f-1]==="*"&&(l=!1):r?r===m&&(r=!1):m==="/"&&t[f+1]==="*"?l=!0:m==='"'||m==="'"?r=m:m==="("?o++:m===")"&&o--,!l&&r===!1&&o===0){if(m===":"&&d===-1)d=f;else if(m===";"||f===_-1){if(d!==-1){var y=qs(t.substring(u,d).trim());if(!c.includes(y)){m!==";"&&f++;var p=t.substring(u,f).trim();n+=" "+p+";"}}u=f+1,d=-1}}}}return i&&(n+=qr(i)),s&&(n+=qr(s,!0)),n=n.trim(),n===""?null:n}return t==null?null:String(t)}function Ce(t,e,n,i,s,r){var o=t.__className;if(o!==n||o===void 0){var l=Rl(n,i,r);l==null?t.removeAttribute("class"):e?t.className=l:t.setAttribute("class",l),t.__className=n}else if(r&&s!==r)for(var c in r){var u=!!r[c];(s==null||u!==!!s[c])&&t.classList.toggle(c,u)}return r}function Rs(t,e={},n,i){for(var s in n){var r=n[s];e[s]!==r&&(n[s]==null?t.style.removeProperty(s):t.style.setProperty(s,r,i))}}function Rn(t,e,n,i){var s=t.__style;if(s!==e){var r=Hl(e,i);r==null?t.removeAttribute("style"):t.style.cssText=r,t.__style=e}else i&&(Array.isArray(i)?(Rs(t,n==null?void 0:n[0],i[0]),Rs(t,n==null?void 0:n[1],i[1],"important")):Rs(t,n,i));return i}function ms(t,e,n=!1){if(t.multiple){if(e==null)return;if(!xs(e))return Zo();for(var i of t.options)i.selected=e.includes(Ai(i));return}for(i of t.options){var s=Ai(i);if(pl(s,e)){i.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Ja(t){var e=new MutationObserver(()=>{ms(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),La(()=>{e.disconnect()})}function kr(t,e,n=e){var i=!0;Ha(t,"change",s=>{var r=s?"[selected]":":checked",o;if(t.multiple)o=[].map.call(t.querySelectorAll(r),Ai);else{var l=t.querySelector(r)??t.querySelector("option:not([disabled])");o=l&&Ai(l)}n(o)}),Qn(()=>{var s=e();if(ms(t,s,i),i&&s===void 0){var r=t.querySelector(":checked");r!==null&&(s=Ai(r),n(s))}t.__value=s,i=!1}),Ja(t)}function Ai(t){return"__value"in t?t.__value:t.value}const bi=Symbol("class"),ki=Symbol("style"),eo=Symbol("is custom element"),to=Symbol("is html");function Mt(t,e){var n=wr(t);n.checked!==(n.checked=e??void 0)&&(t.checked=e)}function Bl(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function le(t,e,n,i){var s=wr(t);s[e]!==(s[e]=n)&&(e==="loading"&&(t[Do]=n),n==null?t.removeAttribute(e):typeof n!="string"&&no(t).includes(e)?t[e]=n:t.setAttribute(e,n))}function Wl(t,e,n,i,s=!1){var r=wr(t),o=r[eo],l=!r[to],c=e||{},u=t.tagName==="OPTION";for(var d in e)d in n||(n[d]=null);n.class?n.class=ii(n.class):n[bi]&&(n.class=null),n[ki]&&(n.style??(n.style=null));var f=no(t);for(const A in n){let x=n[A];if(u&&A==="value"&&x==null){t.value=t.__value="",c[A]=x;continue}if(A==="class"){var m=t.namespaceURI==="http://www.w3.org/1999/xhtml";Ce(t,m,x,i,e==null?void 0:e[bi],n[bi]),c[A]=x,c[bi]=n[bi];continue}if(A==="style"){Rn(t,x,e==null?void 0:e[ki],n[ki]),c[A]=x,c[ki]=n[ki];continue}var y=c[A];if(!(x===y&&!(x===void 0&&t.hasAttribute(A)))){c[A]=x;var p=A[0]+A[1];if(p!=="$$")if(p==="on"){const L={},K="$$"+A;let M=A.slice(2);var _=El(M);if(Al(M)&&(M=M.slice(0,-7),L.capture=!0),!_&&y){if(x!=null)continue;t.removeEventListener(M,c[K],L),c[K]=null}if(x!=null)if(_)t[`__${M}`]=x,yn([M]);else{let z=function(te){c[A].call(this,te)};c[K]=Wa(M,t,z,L)}else _&&(t[`__${M}`]=void 0)}else if(A==="style")le(t,A,x);else if(A==="autofocus")Gl(t,!!x);else if(!o&&(A==="__value"||A==="value"&&x!=null))t.value=t.__value=x;else if(A==="selected"&&u)Bl(t,x);else{var w=A;l||(w=Ll(w));var S=w==="defaultValue"||w==="defaultChecked";if(x==null&&!o&&!S)if(r[A]=null,w==="value"||w==="checked"){let L=t;const K=e===void 0;if(w==="value"){let M=L.defaultValue;L.removeAttribute(w),L.defaultValue=M,L.value=L.__value=K?M:null}else{let M=L.defaultChecked;L.removeAttribute(w),L.defaultChecked=M,L.checked=K?M:!1}}else t.removeAttribute(A);else S||f.includes(w)&&(o||typeof x!="string")?(t[w]=x,w in r&&(r[w]=ct)):typeof x!="function"&&le(t,w,x)}}}return c}function Rr(t,e,n=[],i=[],s,r=!1){ka(n,i,o=>{var l=void 0,c={},u=t.nodeName==="SELECT",d=!1;if(pi(()=>{var m=e(...o.map(a)),y=Wl(t,l,m,s,r);d&&u&&"value"in m&&ms(t,m.value);for(let _ of Object.getOwnPropertySymbols(c))m[_]||zt(c[_]);for(let _ of Object.getOwnPropertySymbols(m)){var p=m[_];_.description===Xo&&(!l||p!==l[_])&&(c[_]&&zt(c[_]),c[_]=mn(()=>$l(t,()=>p))),y[_]=p}l=y}),u){var f=t;Qn(()=>{ms(f,l.value,!0),Ja(f)})}d=!0})}function wr(t){return t.__attributes??(t.__attributes={[eo]:t.nodeName.includes("-"),[to]:t.namespaceURI===Qo})}var Hr=new Map;function no(t){var e=Hr.get(t.nodeName);if(e)return e;Hr.set(t.nodeName,e=[]);for(var n,i=t,s=Element.prototype;s!==i;){n=ca(i);for(var r in n)n[r].set&&e.push(r);i=lr(i)}return e}const Ul=()=>performance.now(),vn={tick:t=>requestAnimationFrame(t),now:()=>Ul(),tasks:new Set};function io(){const t=vn.now();vn.tasks.forEach(e=>{e.c(t)||(vn.tasks.delete(e),e.f())}),vn.tasks.size!==0&&vn.tick(io)}function jl(t){let e;return vn.tasks.size===0&&vn.tick(io),{promise:new Promise(n=>{vn.tasks.add(e={c:t,f:n})}),abort(){vn.tasks.delete(e)}}}function ss(t,e){Fs(()=>{t.dispatchEvent(new CustomEvent(e))})}function Ql(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(n=>n[0].toUpperCase()+n.slice(1)).join("")}function Br(t){const e={},n=t.split(";");for(const i of n){const[s,r]=i.split(":");if(!s||r===void 0)break;const o=Ql(s.trim());e[o]=r.trim()}return e}const Yl=t=>t;function Hs(t,e,n,i){var s=(t&Wo)!==0,r="both",o,l=e.inert,c=e.style.overflow,u,d;function f(){return Fs(()=>o??(o=n()(e,(i==null?void 0:i())??{},{direction:r})))}var m={is_global:s,in(){e.inert=l,ss(e,"introstart"),u=ir(e,f(),d,1,()=>{ss(e,"introend"),u==null||u.abort(),u=o=void 0,e.style.overflow=c})},out(w){e.inert=!0,ss(e,"outrostart"),d=ir(e,f(),u,0,()=>{ss(e,"outroend"),w==null||w()})},stop:()=>{u==null||u.abort(),d==null||d.abort()}},y=ge;if((y.transitions??(y.transitions=[])).push(m),hs){var p=s;if(!p){for(var _=y.parent;_&&(_.f&es)!==0;)for(;(_=_.parent)&&(_.f&fi)===0;);p=!_||(_.f&Ds)!==0}p&&Qn(()=>{Jt(()=>m.in())})}}function ir(t,e,n,i,s){var r=i===1;if(Jn(e)){var o,l=!1;return ts(()=>{if(!l){var w=e({direction:r?"in":"out"});o=ir(t,w,n,i,s)}}),{abort:()=>{l=!0,o==null||o.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(n==null||n.deactivate(),!(e!=null&&e.duration))return s(),{abort:yi,deactivate:yi,reset:yi,t:()=>i};const{delay:c=0,css:u,tick:d,easing:f=Yl}=e;var m=[];if(r&&n===void 0&&(d&&d(0,1),u)){var y=Br(u(0,1));m.push(y,y)}var p=()=>1-i,_=t.animate(m,{duration:c,fill:"forwards"});return _.onfinish=()=>{_.cancel();var w=(n==null?void 0:n.t())??1-i;n==null||n.abort();var S=i-w,A=e.duration*Math.abs(S),x=[];if(A>0){var L=!1;if(u)for(var K=Math.ceil(A/16.666666666666668),M=0;M<=K;M+=1){var z=w+S*f(M/K),te=Br(u(z,1-z));x.push(te),L||(L=te.overflow==="hidden")}L&&(t.style.overflow="hidden"),p=()=>{var se=_.currentTime;return w+S*f(se/A)},d&&jl(()=>{if(_.playState!=="running")return!1;var se=p();return d(se,1-se),!0})}_=t.animate(x,{duration:A,fill:"forwards"}),_.onfinish=()=>{p=()=>i,d==null||d(i,1-i),s()}},{abort:()=>{_&&(_.cancel(),_.effect=null,_.onfinish=yi)},deactivate:()=>{s=yi},reset:()=>{i===0&&(d==null||d(1,0))},t:()=>p()}}function di(t,e,n=e){var i=Un(),s=new WeakSet;Ha(t,"input",r=>{var o=r?t.defaultValue:t.value;if(o=Bs(t)?Ws(o):o,n(o),Te!==null&&s.add(Te),i&&o!==(o=e())){var l=t.selectionStart,c=t.selectionEnd;t.value=o??"",c!==null&&(t.selectionStart=l,t.selectionEnd=Math.min(c,t.value.length))}}),Jt(e)==null&&t.value&&(n(Bs(t)?Ws(t.value):t.value),Te!==null&&s.add(Te)),Pa(()=>{var r=e();if(t===document.activeElement){var o=ls??Te;if(s.has(o))return}Bs(t)&&r===Ws(t.value)||t.type==="date"&&!r&&!t.value||r!==t.value&&(t.value=r??"")})}function Bs(t){var e=t.type;return e==="number"||e==="range"}function Ws(t){return t===""?null:+t}var Sn,li,$i,Cs,so;const As=class As{constructor(e){Pe(this,Cs);Pe(this,Sn,new WeakMap);Pe(this,li);Pe(this,$i);Dt(this,$i,e)}observe(e,n){var i=V(this,Sn).get(e)||new Set;return i.add(n),V(this,Sn).set(e,i),bn(this,Cs,so).call(this).observe(e,V(this,$i)),()=>{var s=V(this,Sn).get(e);s.delete(n),s.size===0&&(V(this,Sn).delete(e),V(this,li).unobserve(e))}}};Sn=new WeakMap,li=new WeakMap,$i=new WeakMap,Cs=new WeakSet,so=function(){return V(this,li)??Dt(this,li,new ResizeObserver(e=>{for(var n of e){As.entries.set(n.target,n);for(var i of V(this,Sn).get(n.target)||[])i(n)}}))},Z(As,"entries",new WeakMap);let sr=As;var Xl=new sr({box:"border-box"});function Zl(t,e,n){var i=Xl.observe(t,()=>n(t[e]));Qn(()=>(Jt(()=>n(t[e])),i))}function Wr(t,e){return t===e||(t==null?void 0:t[ln])===e}function $n(t={},e,n,i){return Qn(()=>{var s,r;return Pa(()=>{s=r,r=[],Jt(()=>{t!==n(...r)&&(e(t,...r),s&&Wr(n(...s),t)&&e(null,...s))})}),()=>{ts(()=>{r&&Wr(n(...r),t)&&e(null,...r)})}}),t}function Jl(t=!1){const e=Re,n=e.l.u;if(!n)return;let i=()=>ei(e.s);if(t){let s=0,r={};const o=ns(()=>{let l=!1;const c=e.s;for(const u in c)c[u]!==r[u]&&(r[u]=c[u],l=!0);return l&&s++,s});i=()=>a(o)}n.b.length&&yl(()=>{Ur(e,i),Qs(n.b)}),gt(()=>{const s=Jt(()=>n.m.map(Co));return()=>{for(const r of s)typeof r=="function"&&r()}}),n.a.length&&gt(()=>{Ur(e,i),Qs(n.a)})}function Ur(t,e){if(t.l.s)for(const n of t.l.s)a(n);e()}let rs=!1;function ec(t){var e=rs;try{return rs=!1,[t(),rs]}finally{rs=e}}const tc={get(t,e){if(!t.exclude.includes(e))return a(t.version),e in t.special?t.special[e]():t.props[e]},set(t,e,n){if(!(e in t.special)){var i=ge;try{un(t.parent_effect),t.special[e]=De({get[e](){return t.props[e]}},e,va)}finally{un(i)}}return t.special[e](n),Pr(t.version),!0},getOwnPropertyDescriptor(t,e){if(!t.exclude.includes(e)&&e in t.props)return{enumerable:!0,configurable:!0,value:t.props[e]}},deleteProperty(t,e){return t.exclude.includes(e)||(t.exclude.push(e),Pr(t.version)),!0},has(t,e){return t.exclude.includes(e)?!1:e in t.props},ownKeys(t){return Reflect.ownKeys(t.props).filter(e=>!t.exclude.includes(e))}};function At(t,e){return new Proxy({props:t,exclude:e,special:{},version:ci(0),parent_effect:ge},tc)}const nc={get(t,e){let n=t.props.length;for(;n--;){let i=t.props[n];if(Jn(i)&&(i=i()),typeof i=="object"&&i!==null&&e in i)return i[e]}},set(t,e,n){let i=t.props.length;for(;i--;){let s=t.props[i];Jn(s)&&(s=s());const r=xn(s,e);if(r&&r.set)return r.set(n),!0}return!1},getOwnPropertyDescriptor(t,e){let n=t.props.length;for(;n--;){let i=t.props[n];if(Jn(i)&&(i=i()),typeof i=="object"&&i!==null&&e in i){const s=xn(i,e);return s&&!s.configurable&&(s.configurable=!0),s}}},has(t,e){if(e===ln||e===da)return!1;for(let n of t.props)if(Jn(n)&&(n=n()),n!=null&&e in n)return!0;return!1},ownKeys(t){const e=[];for(let n of t.props)if(Jn(n)&&(n=n()),!!n){for(const i in n)e.includes(i)||e.push(i);for(const i of Object.getOwnPropertySymbols(n))e.includes(i)||e.push(i)}return e}};function Vt(...t){return new Proxy({props:t},nc)}function De(t,e,n,i){var x;var s=!vi||(n&Ro)!==0,r=(n&Ho)!==0,o=(n&Bo)!==0,l=i,c=!0,u=()=>(c&&(c=!1,l=o?Jt(i):i),l),d;if(r){var f=ln in t||da in t;d=((x=xn(t,e))==null?void 0:x.set)??(f&&e in t?L=>t[e]=L:void 0)}var m,y=!1;r?[m,y]=ec(()=>t[e]):m=t[e],m===void 0&&i!==void 0&&(m=u(),d&&(s&&Io(),d(m)));var p;if(s?p=()=>{var L=t[e];return L===void 0?u():(c=!0,L)}:p=()=>{var L=t[e];return L!==void 0&&(l=void 0),L===void 0?l:L},s&&(n&va)===0)return p;if(d){var _=t.$$legacy;return function(L,K){return arguments.length>0?((!s||!K||_||y)&&d(K?p():L),L):p()}}var w=!1,S=((n&qo)!==0?ns:mr)(()=>(w=!1,p()));r&&a(S);var A=ge;return function(L,K){if(arguments.length>0){const M=K?a(S):s&&r?Be(L):L;return g(S,M),w=!0,l!==void 0&&(l=M),L}return Yn&&w||(A.f&Wn)!==0?S.v:a(S)}}function Is(t){Re===null&&pr(),vi&&Re.l!==null?ic(Re).m.push(t):gt(()=>{const e=Jt(t);if(typeof e=="function")return e})}function ro(t){Re===null&&pr(),Is(()=>()=>Jt(t))}function ic(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}const Wt="keyboard-shortcuts-visualization",jr={sections:[{name:"main",gridRatio:3.75,rows:[[{type:"common",label:"Escape",code:"Escape",unicode:"⎋"},{type:"empty",width:.5},{type:"common",label:"F1",code:"F1"},{type:"common",label:"F2",code:"F2"},{type:"common",label:"F3",code:"F3"},{type:"common",label:"F4",code:"F4"},{type:"empty",width:.75},{type:"common",label:"F5",code:"F5"},{type:"common",label:"F6",code:"F6"},{type:"common",label:"F7",code:"F7"},{type:"empty",width:.75},{type:"common",label:"F8",code:"F8"},{type:"common",label:"F9",code:"F9"},{type:"common",label:"F10",code:"F10"},{type:"common",label:"F11",code:"F11"},{type:"common",label:"F12",code:"F12"}],[{type:"common",label:"`",code:"Backquote"},{type:"common",label:"1",code:"Digit1"},{type:"common",label:"2",code:"Digit2"},{type:"common",label:"3",code:"Digit3"},{type:"common",label:"4",code:"Digit4"},{type:"common",label:"5",code:"Digit5"},{type:"common",label:"6",code:"Digit6"},{type:"common",label:"7",code:"Digit7"},{type:"common",label:"8",code:"Digit8"},{type:"common",label:"9",code:"Digit9"},{type:"common",label:"0",code:"Digit0"},{type:"common",label:"-",code:"Minus"},{type:"common",label:"=",code:"Equal"},{type:"common",label:"Backspace",code:"Backspace",width:2,unicode:"⌫"}],[{type:"common",label:"Tab",code:"Tab",width:1.5},{type:"common",label:"Q",code:"KeyQ"},{type:"common",label:"W",code:"KeyW"},{type:"common",label:"E",code:"KeyE"},{type:"common",label:"R",code:"KeyR"},{type:"common",label:"T",code:"KeyT"},{type:"common",label:"Y",code:"KeyY"},{type:"common",label:"U",code:"KeyU"},{type:"common",label:"I",code:"KeyI"},{type:"common",label:"O",code:"KeyO"},{type:"common",label:"P",code:"KeyP"},{type:"common",label:"[",code:"BracketLeft"},{type:"common",label:"]",code:"BracketRight"},{type:"common",label:"\\",code:"Backslash",width:1.5}],[{type:"common",label:"Caps",code:"CapsLock",width:1.75,unicode:"⇪"},{type:"common",label:"A",code:"KeyA"},{type:"common",label:"S",code:"KeyS"},{type:"common",label:"D",code:"KeyD"},{type:"common",label:"F",code:"KeyF"},{type:"common",label:"G",code:"KeyG"},{type:"common",label:"H",code:"KeyH"},{type:"common",label:"J",code:"KeyJ"},{type:"common",label:"K",code:"KeyK"},{type:"common",label:"L",code:"KeyL"},{type:"common",label:";",code:"Semicolon"},{type:"common",label:"'",code:"Quote"},{type:"common",label:"Enter",code:"Enter",width:2.25}],[{type:"common",label:"Shift",code:"ShiftLeft",width:2.25,unicode:"⇧"},{type:"common",label:"Z",code:"KeyZ"},{type:"common",label:"X",code:"KeyX"},{type:"common",label:"C",code:"KeyC"},{type:"common",label:"V",code:"KeyV"},{type:"common",label:"B",code:"KeyB"},{type:"common",label:"N",code:"KeyN"},{type:"common",label:"M",code:"KeyM"},{type:"common",label:",",code:"Comma"},{type:"common",label:".",code:"Period"},{type:"common",label:"/",code:"Slash"},{type:"common",label:"Shift",code:"ShiftRight",width:2.75,unicode:"⇧"}],[{type:"os-specific",width:1.5,os:{macos:{label:"Control",code:"ControlLeft",unicode:"⌃",modifier:"Control"},windows:{label:"Ctrl",code:"ControlLeft",unicode:"Ctrl",modifier:"Control"},linux:{label:"Ctrl",code:"ControlLeft",unicode:"Ctrl",modifier:"Control"}}},{type:"os-specific",width:1.5,os:{macos:{label:"Alt",code:"AltLeft",unicode:"⌥",modifier:"Alt"},windows:{label:"Win",code:"MetaLeft",unicode:"Win",modifier:void 0},linux:{label:"Win",code:"MetaLeft",unicode:"Super",modifier:void 0}}},{type:"os-specific",width:1.5,os:{macos:{label:"Meta",code:"MetaLeft",unicode:"⌘",modifier:"Meta"},windows:{label:"Alt",code:"AltLeft",unicode:"Alt",modifier:"Alt"},linux:{label:"Alt",code:"AltLeft",unicode:"Alt",modifier:"Alt"}}},{type:"common",label:" ",code:"Space",unicode:"⎵",width:6},{type:"os-specific",width:1.5,os:{macos:{label:"Meta",code:"MetaRight",unicode:"⌘",modifier:"Meta"},windows:{label:"Alt",code:"AltRight",unicode:"Alt",modifier:"Alt"},linux:{label:"Alt",code:"AltRight",unicode:"Alt",modifier:"Alt"}}},{type:"os-specific",width:1.5,os:{macos:{label:"Alt",code:"AltRight",unicode:"⌥",modifier:"Alt"},windows:{label:"Win",code:"MetaRight",unicode:"Win",modifier:void 0},linux:{label:"Win",code:"MetaRight",unicode:"Super",modifier:void 0}}},{type:"os-specific",width:1.5,os:{macos:{label:"Control",code:"ControlRight",unicode:"⌃",modifier:"Control"},windows:{label:"Ctrl",code:"ControlRight",unicode:"Ctrl",modifier:"Control"},linux:{label:"Ctrl",code:"ControlRight",unicode:"Ctrl",modifier:"Control"}}}]]},{name:"other",gridRatio:.75,rows:[[{type:"empty"},{type:"empty"},{type:"empty"}],[{type:"common",label:"Insert",code:"Insert",smallText:!0},{type:"common",label:"Home",code:"Home",smallText:!0},{type:"common",label:"PgUp",code:"PageUp",smallText:!0}],[{type:"common",label:"Delete",code:"Delete",smallText:!0},{type:"common",label:"End",code:"End",smallText:!0},{type:"common",label:"PgUp",code:"PageDown",smallText:!0}],[{type:"empty"},{type:"empty"},{type:"empty"}],[{type:"empty"},{type:"common",label:"ArrowUp",code:"ArrowUp",unicode:"↑"},{type:"empty"}],[{type:"common",label:"ArrowLeft",code:"ArrowLeft",unicode:"←"},{type:"common",label:"ArrowDown",code:"ArrowDown",unicode:"↓"},{type:"common",label:"ArrowRight",code:"ArrowRight",unicode:"→"}]]},{name:"num",gridRatio:1,rows:[[{type:"empty"},{type:"empty"},{type:"empty"},{type:"empty"}],[{type:"common",label:"NumLock",code:"NumLock",unicode:"⇭"},{type:"common",label:"/",code:"NumpadDivide"},{type:"common",label:"*",code:"NumpadMultiply",unicode:"×"},{type:"common",label:"-",code:"NumpadSubtract"}],[{type:"common",label:"7",code:"Numpad7"},{type:"common",label:"8",code:"Numpad8"},{type:"common",label:"9",code:"Numpad9"},{type:"common",label:"+",code:"NumpadAdd",height:2}],[{type:"common",label:"4",code:"Numpad4"},{type:"common",label:"5",code:"Numpad5"},{type:"common",label:"6",code:"Numpad6"}],[{type:"common",label:"1",code:"Numpad1"},{type:"common",label:"2",code:"Numpad2"},{type:"common",label:"3",code:"Numpad3"},{type:"common",label:"Enter",code:"Enter",height:2}],[{type:"common",label:"0",code:"Numpad0",width:2},{type:"common",label:".",code:"NumpadDecimal"}]]}]},sc="5";var oa;typeof window<"u"&&((oa=window.__svelte??(window.__svelte={})).v??(oa.v=new Set)).add(sc);let ao=!1,oo="debug",lo="none",co="activeView",uo="click";function gs(t){ao=!!t}function Ts(){return ao}function fo(t){oo=t}function rc(){return oo}function ys(t){lo=t}function ti(){return lo}function Qr(t){co=t==="global"?"global":"activeView"}function Yr(){return co}function Xr(t){uo=t==="press"?"press":"click"}function _s(){return uo==="press"}const Zr={debug:10,info:20,warn:30,error:40};function Si(t){if(!Ts())return!1;const e=rc();return Zr[t]>=Zr[e]}function as(t){try{return t}catch{return t}}function vo(){return typeof performance<"u"&&performance.now?performance.now():Date.now()}const rr=new Map,ar={};function ac(t){Ts()&&rr.set(t,vo())}const oc=5;function lc(t){if(!Ts())return;const e=rr.get(t);if(!e)return;const n=vo()-e;rr.delete(t);const i=ar[t]||{count:0,totalMs:0,lastMs:0};i.count+=1,i.totalMs+=n,i.lastMs=n,ar[t]=i,(n>=oc||i.count<=3)&&Si("debug")&&console.debug("[KB][timing]",t,`${n.toFixed(2)}ms`)}function cc(){if(!Ts())return;const t=[];for(const[e,n]of Object.entries(ar)){const i=n.totalMs/Math.max(1,n.count);t.push(`${e}: count=${n.count} avg=${i.toFixed(2)}ms last=${n.lastMs.toFixed(2)}ms total=${n.totalMs.toFixed(2)}ms`)}if(t.length){const e=t.map(n=>{const i=n.match(/avg=([0-9.]+)ms/),s=i?Number.parseFloat(i[1]):0;return{line:n,avg:s}}).sort((n,i)=>i.avg-n.avg).slice(0,8).map(n=>n.line);console.info("[KB][timings] aggregated timings (top "+String(e.length)+`):
`+e.join(`
`))}else console.info("[KB][timings] no timings recorded")}const D={debug:(...t)=>{Si("debug")&&console.debug("[KB]",...as(t))},info:(...t)=>{Si("info")&&console.info("[KB]",...as(t))},warn:(...t)=>{Si("warn")&&console.warn("[KB]",...as(t))},error:(...t)=>{Si("error")&&console.error("[KB]",...as(t))},timeStart:ac,timeEnd:lc,dumpTimings:cc},uc=Object.freeze(Object.defineProperty({__proto__:null,default:D,logger:D},Symbol.toStringTag,{value:"Module"}));function Fn(){const t=ti();return t==="macos"?!0:t==="windows"||t==="linux"?!1:rt.Platform.isMacOS}const po={Control:"Ctrl",Shift:"Shift",Alt:"Alt",Meta:"Meta",Mod:Fn()?"Meta":"Ctrl"};Fn(),Fn(),Fn(),Fn();function Ft(t){return po[t]||t}function Ns(t){const e=Object.entries(po).find(([n,i])=>i===t);return e?e[0]:t}function En(t){return t.map(Ft)}function dc(t){const e=String(t);return Fn()?e==="Mod"?"Meta":e==="Control"||e==="Ctrl"?"Ctrl":e==="Alt"||e==="Option"?"Alt":e==="Meta"||e==="Cmd"||e==="Win"?"Meta":e==="Shift"?"Shift":e:e==="Mod"||e==="Meta"||e==="Cmd"?"Ctrl":e==="Option"?"Alt":e==="Control"?"Ctrl":e==="Win"?"Meta":e}function Hn(t){return t.map(dc)}function fc(t){return t.map(Ns)}function hn(t){const e=Fn()?["Meta","Ctrl","Alt","Shift"]:["Ctrl","Alt","Shift","Meta","Win"];return[...t].sort((n,i)=>{const s=Ft(n),r=Ft(i),o=e.indexOf(s),l=e.indexOf(r);return o===-1&&l===-1?n.localeCompare(i):o===-1?1:l===-1?-1:o-l})}function ho(t,e){if(!t||!e)return t===e;if(t.length!==e.length)return!1;const n=new Set(t);for(const i of e)if(!n.has(i))return!1;return!0}function Gi(t){let e=t.toLowerCase();const n={space:" ",minus:"-",equal:"=",bracketleft:"[",bracketright:"]",semicolon:";",quote:"'",backquote:"`",comma:",",period:".",slash:"/",backslash:"\\",numpaddivide:"/",numpadmultiply:"*",numpadsubtract:"-",numpadadd:"+",numpaddecimal:".",numpadenter:"enter"};return n[e]?n[e]:e.startsWith("key")?e.slice(3):e.startsWith("digit")?e.slice(5):e}function mo(t,e){return Gi(t)===Gi(e)}function bs(t,e,n,i){const{strictModifierMatch:s=!0,allowKeyOnly:r=!0,platformize:o=!0}=i||{},l=o?Hn(e):e,c=o?Hn(t.modifiers):t.modifiers,u=hn(l),d=hn(c),f=r&&u.length===0?!0:s?ho(u,d):u.length===0&&d.length===0||u.length>0&&u.every(y=>d.includes(y)),m=n?mo(n,t.key):!0;return f&&m}var qi,Ri;class Mr{constructor(){Pe(this,qi,F(Be(jr)));Pe(this,Ri,F(Be({})));Z(this,"codeToObsidianModifier",{});this.layout=this.getProcessedLayout(jr),this.initializeKeyStates()}get layout(){return a(V(this,qi))}set layout(e){g(V(this,qi),e,!0)}get keyStates(){return a(V(this,Ri))}set keyStates(e){g(V(this,Ri),e,!0)}getProcessedLayout(e){const n=ti(),i=n==="none"?rt.Platform.isMacOS?"macos":rt.Platform.isLinux?"linux":"windows":n,s=e.sections.map(r=>({...r,rows:r.rows.map(o=>o.map(l=>{if(l.type==="os-specific"&&l.os){const c=l.os[i];return{...l,label:c.label,code:c.code,unicode:c.unicode,logicalModifier:c.modifier}}return l}))}));return{...e,sections:s}}initializeKeyStates(){this.layout.sections.forEach(e=>{e.rows.forEach(n=>{n.forEach(i=>{if(i.type!=="empty"){const s=(i.code||i.label||"").toLowerCase();if(s){const r={displayValue:this.getUnicodeForKey(i),code:i.code||i.label||"",state:"inactive",smallText:i.smallText,weight:0};this.keyStates[s]=r,i.code&&this.assignModifierRole(i)}else D.warn("Invalid key found:",i)}})})})}assignModifierRole(e){const n=e.code||"",i=e.logicalModifier;if(!i){delete this.codeToObsidianModifier[n];return}this.codeToObsidianModifier[n]=i}mapCodeToObsidianModifier(e){if(this.codeToObsidianModifier[e])return this.codeToObsidianModifier[e];const n=e;if(this.codeToObsidianModifier[n])return this.codeToObsidianModifier[n];if(/^Control(Left|Right)$/.test(e))return"Control";if(/^Alt(Left|Right)$/.test(e))return"Alt";if(/^Shift(Left|Right)$/.test(e))return"Shift";if(/^Meta(Left|Right)$/.test(e)){const i=ti();return(i==="macos"?!0:i==="none"?rt.Platform.isMacOS:!1)?"Meta":void 0}}getUnicodeForKey(e){if(!e)return"";if(e.unicode)return e.unicode;const n=ti(),i=n==="macos"?!0:n==="none"?rt.Platform.isMacOS:!1;return i&&e.mac_unicode?e.mac_unicode:!i&&e.win_unicode?e.win_unicode:e.label||""}calculateAndAssignWeights(e,n=[],i="",s=!1){var c;const r=Array.isArray(e)?e:[],o={};for(const u in this.keyStates)o[u.toLowerCase()]=0;const l=((n==null?void 0:n.length)??0)>0||!!i;for(const u of r){const d=Array.isArray(u.hotkeys)?u.hotkeys:[];for(const f of d){let m=!0;if(s&&l){const w=En(n||[]),S=En(f.modifiers||[]),A=ho(w,S),x=!i||mo(i,f.key||"");m=A&&x}if(!m)continue;const y=(f.key||"").toLowerCase(),p=this.resolveKeyAliases(y);for(const w of p)if(w in o){o[w]=(o[w]||0)+1;break}const _=Array.isArray(f.modifiers)?f.modifiers:[];for(const w of _){const S=w.toLowerCase();let A=null;const x=ti(),L=x==="macos"?!0:x==="none"?rt.Platform.isMacOS:!1;S==="mod"?A=L?"meta":"control":S==="ctrl"||S==="control"?A="control":S==="cmd"||S==="meta"?A=L?"meta":"control":S==="win"?A="meta":S==="alt"||S==="option"?A="alt":S==="shift"&&(A="shift");const K=.25;A?o[A]=(o[A]||0)+K:o[S]=(o[S]||0)+K}}}for(const u in this.keyStates){const d=u.toLowerCase(),f=((c=this.keyStates[u].code)==null?void 0:c.toLowerCase())||"";f.startsWith("control")?this.keyStates[u].weight=o.control||0:f.startsWith("alt")?this.keyStates[u].weight=o.alt||0:f.startsWith("shift")?this.keyStates[u].weight=o.shift||0:f.startsWith("meta")?this.keyStates[u].weight=o.meta||0:this.keyStates[u].weight=o[d]||0}}resolveKeyAliases(e){const n=new Set,i=(e||"").toLowerCase();if(!i)return[];n.add(i);const s={"`":"backquote","-":"minus","=":"equal","[":"bracketleft","]":"bracketright",";":"semicolon","'":"quote",",":"comma",".":"period","/":"slash","\\":"backslash"," ":"space"};i in s&&n.add(s[i]);const r=Object.fromEntries(Object.entries(s).map(([o,l])=>[l,o]));return i in r&&n.add(r[i]),/^[a-z]$/.test(i)&&n.add(`key${i}`),/^key[a-z]$/.test(i)&&n.add(i.slice(3)),/^[0-9]$/.test(i)&&n.add(`digit${i}`),/^digit[0-9]$/.test(i)&&n.add(i.slice(5)),Array.from(n)}getKeyState(e){if(e.type==="empty")return{displayValue:"empty",code:"",state:"empty"};const n=(e.code||e.label||"").toLowerCase();return this.keyStates[n]?this.keyStates[n]:(D.warn(`Key state for ${n} is undefined. Check initialization.`),{displayValue:e.label||"",code:"",state:"inactive"})}toggleKeyActive(e){const n=e.toLowerCase();return this.keyStates[n]?(this.keyStates[n].state=this.keyStates[n].state==="active"?"inactive":"active",this.keyStates[n].state==="active"):(D.warn(`Key state for ${n} is undefined. Check initialization.`),!1)}updateKeyState(e,n,i,s=0){const r=e.toLowerCase();this.keyStates[r]?(this.keyStates[r].state=n?"active":i?"possible":"inactive",this.keyStates[r].weight=s):D.warn(`Key state for ${r} is undefined. Check initialization.`)}updateVisualState(e,n){for(const s in this.keyStates)this.keyStates[s].state="inactive";if(e){const s=e.toLowerCase();this.keyStates[s]&&(this.keyStates[s].state="active")}const i=new Set(fc(n));for(const s in this.keyStates){const r=this.keyStates[s].code,o=this.normalizeModifier(r);o&&i.has(o)&&(this.keyStates[s].state="active")}}previewHoverState(e,n){for(const o in this.keyStates)this.keyStates[o].state==="hover"&&(this.keyStates[o].state="inactive");const i=(e||"").toLowerCase(),s=this.resolveKeyAliases(i);for(const o of s){const l=this.keyStates[o];if(l){l.state="hover";break}}const r=new Set((n||[]).map(o=>Ft(o)));for(const o in this.keyStates){const l=this.keyStates[o].code,c=this.normalizeModifier(l);c&&r.has(c)&&(this.keyStates[o].state="hover")}}normalizeModifier(e){if(!e)return null;const n=e.toLowerCase();return n.startsWith("control")?"Control":n.startsWith("alt")?"Alt":n.startsWith("shift")?"Shift":n.startsWith("meta")?"Meta":null}clearActiveKeys(){for(const e in this.keyStates)this.keyStates[e].state==="active"&&(this.keyStates[e].state="inactive")}resetKeyStates(){for(const e in this.keyStates)this.keyStates[e].weight=0,this.keyStates[e].state="inactive"}}qi=new WeakMap,Ri=new WeakMap;function vc(t,e){var n;try{const i=t.plugins;if(!i)return e;if(typeof i.getPlugin=="function"){const s=i.getPlugin(e);if(s&&typeof s=="object"){const r=((n=s.manifest)==null?void 0:n.name)||s.name||s.displayName;if(typeof r=="string"&&r.length>0)return r}}return e}catch{return e}}function pc(t,e){if(typeof e!="string")return!1;const n=e.toLowerCase().trim();return n.length===0?!1:!!(n.startsWith("app:")||n.startsWith("workspace:")||n.startsWith("editor:")||/\b(app|workspace|core|file|pane|editor)\b/.test(n))}function hc(t,e,n){const i=n.id||"",s=n.name||"";let r={all:[],default:[],custom:[]};try{if(e&&typeof e.getHotkeysForCommand=="function"){const _=e.getHotkeysForCommand(i);_&&Array.isArray(_.all)&&(r={all:_.all,default:_.default||[],custom:_.custom||[]})}}catch{}const[o,...l]=i.split(":"),c=l.join(":")||s;let u=o||"";try{t&&(u=vc(t,o))}catch{u=o}const d=(()=>{try{return pc(t,i)}catch{return o?o==="app"||o==="workspace"||o==="editor":!1}})(),f=Array.isArray(r.default)?r.default:[],m=Array.isArray(r.custom)?r.custom:[],y=Array.isArray(r.all)&&r.all.length>0?r.all:(()=>{const _=new Map,w=S=>{const A=`${(S.modifiers||[]).slice().sort().join(",")}|${S.key||""}`;_.set(A,S)};return f.forEach(w),m.forEach(w),Array.from(_.values())})();return{id:i,name:s,hotkeys:y,defaultHotkeys:f,customHotkeys:m,isInternalModule:d,pluginName:u,cmdName:c}}function Jr(){const t=globalThis.process;return t!=null&&t.platform?t.platform==="darwin":typeof navigator<"u"&&/Mac|iPhone|iPad/.test(navigator.platform)}function mc(){const t=globalThis.process;return t!=null&&t.platform?t.platform==="win32":typeof navigator<"u"&&/Win/.test(navigator.platform)}function gc(){const t=globalThis.process;return t!=null&&t.platform?t.platform==="linux":typeof navigator<"u"&&/Linux/.test(navigator.platform)}function ft(t,e){return{modifiers:t,key:e,isCustom:!1}}function ea(){const t=[],e="System Shortcuts",n=[{id:"system:undo",name:"Undo",hotkeys:[ft(["Mod"],"z")]},{id:"system:redo",name:"Redo",hotkeys:Jr()?[ft(["Mod","Shift"],"z")]:[ft(["Control"],"y")]},{id:"system:cut",name:"Cut",hotkeys:[ft(["Mod"],"x")]},{id:"system:copy",name:"Copy",hotkeys:[ft(["Mod"],"c")]},{id:"system:paste",name:"Paste",hotkeys:[ft(["Mod"],"v")]},{id:"system:zoom-in",name:"Zoom In",hotkeys:[ft(["Mod"],"=")]},{id:"system:zoom-out",name:"Zoom Out",hotkeys:[ft(["Mod"],"-")]},{id:"system:zoom-reset",name:"Reset Zoom",hotkeys:[ft(["Mod"],"0")]}];for(const i of n)t.push({id:i.id,name:i.name,hotkeys:i.hotkeys,defaultHotkeys:i.hotkeys,customHotkeys:[],isInternalModule:!1,pluginName:e,cmdName:i.name});if(mc()||gc()){const i=[{id:"system:copy-insert",name:"Copy (Ctrl+Insert)",hotkeys:[ft(["Control"],"Insert")]},{id:"system:paste-shift-insert",name:"Paste (Shift+Insert)",hotkeys:[ft(["Shift"],"Insert")]},{id:"system:cut-shift-delete",name:"Cut (Shift+Delete)",hotkeys:[ft(["Shift"],"Delete")]},{id:"system:select-char-left",name:"Select Left",hotkeys:[ft(["Shift"],"ArrowLeft")]},{id:"system:select-word-left",name:"Select Word Left",hotkeys:[ft(["Control","Shift"],"ArrowLeft")]},{id:"system:select-word-right",name:"Select Word Right",hotkeys:[ft(["Control","Shift"],"ArrowRight")]}];for(const s of i)t.push({id:s.id,name:s.name,hotkeys:s.hotkeys,defaultHotkeys:s.hotkeys,customHotkeys:[],isInternalModule:!1,pluginName:e,cmdName:s.name})}if(Jr()){const i=[{id:"system:move-word-left",name:"Move Word Left",hotkeys:[ft(["Alt"],"ArrowLeft")]},{id:"system:select-word-left-mac",name:"Select Word Left",hotkeys:[ft(["Alt","Shift"],"ArrowLeft")]},{id:"system:select-word-right-mac",name:"Select Word Right",hotkeys:[ft(["Alt","Shift"],"ArrowRight")]}];for(const s of i)t.push({id:s.id,name:s.name,hotkeys:s.hotkeys,defaultHotkeys:s.hotkeys,customHotkeys:[],isInternalModule:!1,pluginName:e,cmdName:s.name})}return t}var Lt=(t=>(t.All="all",t.Featured="featured",t.Recent="recent",t))(Lt||{}),Hi;const Pn=class Pn{constructor(e){Z(this,"settingsManager");Pe(this,Hi,He(()=>this.settingsManager.settings.commandGroups));Z(this,"writeLocks",new Set);this.settingsManager=e,this.normalizeAllGroups()}get groups(){return a(V(this,Hi))}set groups(e){g(V(this,Hi),e)}static getInstance(e){return Pn.instance||(Pn.instance=new Pn(e)),Pn.instance}getGroups(){return this.groups}getGroup(e){return this.groups.find(n=>n.id===e)}createGroup(e){const n=this.slugifyUnique(e),i={id:n,name:e,commandIds:[],excludedModules:[],filterSettings:{...this.settingsManager.settings.defaultFilterSettings}};return this.settingsManager.updateSettings({commandGroups:[...this.groups,i]}),n}removeGroup(e){this.settingsManager.updateSettings({commandGroups:this.groups.filter(n=>n.id!==e)})}duplicateGroup(e,n){const i=this.getGroup(e);if(!i)return;const s=(n==null?void 0:n.trim())||`${i.name} Copy`,r=this.slugifyUnique(s),o={id:r,name:s,commandIds:[...i.commandIds||[]],excludedModules:[...i.excludedModules||[]],filterSettings:{...i.filterSettings}};return this.settingsManager.updateSettings({commandGroups:[...this.groups,o]}),r}addCommandToGroup(e,n){const i=this.groups.map(s=>s.id===e&&!s.commandIds.includes(n)?{...s,commandIds:[...s.commandIds,n]}:s);this.settingsManager.updateSettings({commandGroups:i})}insertCommandInGroup(e,n,i){const s=this.groups.map(r=>{if(r.id===e&&!r.commandIds.includes(n)){const o=[...r.commandIds],l=Math.max(0,Math.min(i,o.length));return o.splice(l,0,n),{...r,commandIds:o}}return r});this.settingsManager.updateSettings({commandGroups:s})}addCommandToGroupAtTop(e,n){this.insertCommandInGroup(e,n,0)}removeCommandFromAllGroups(e){const n=this.groups.map(i=>({...i,commandIds:i.commandIds.filter(s=>s!==e)}));this.settingsManager.updateSettings({commandGroups:n})}getFeaturedCommandsByGroup(e){const n=this.getGroup(e);return(n==null?void 0:n.commandIds.filter(i=>this.settingsManager.settings.featuredCommandIDs.includes(i)))||[]}removeCommandFromGroup(e,n){const i=this.groups.map(s=>s.id===e?{...s,commandIds:s.commandIds.filter(r=>r!==n)}:s);this.settingsManager.updateSettings({commandGroups:i})}renameGroup(e,n){const i=this.groups.map(s=>s.id===e?{...s,name:n}:s);this.settingsManager.updateSettings({commandGroups:i})}isCommandInGroup(e,n){const i=this.getGroup(e);return!!i&&i.commandIds.includes(n)}getGroupSettings(e){const n=this.getGroup(e),i=this.settingsManager.settings.defaultFilterSettings,s=(n==null?void 0:n.filterSettings)||i;return{...i,...s}}setGroupSetting(e,n,i){const s=this.groups.map(r=>r.id===e?{...r,filterSettings:{...r.filterSettings,[n]:i}}:r);this.settingsManager.updateSettings({commandGroups:s})}updateGroupFilterSettings(e,n){var i;try{if(this.writeLocks.has(e)){D.debug("[groups] updateGroupFilterSettings skipped (locked)",{groupId:e});return}const s=this.groups,r=s.findIndex(l=>l.id===e);if(r!==-1){const l=[...s],c=l[r],d={...this.settingsManager.settings.defaultFilterSettings,...c.filterSettings||{},...n};if(this.isEqualFilters(c.filterSettings,d)){D.debug("[groups] updateGroupFilterSettings noop (no change)",{groupId:e});return}const f={...c,filterSettings:d,...((i=c.behavior)==null?void 0:i.onOpen)==="dynamic"?{lastUsedState:{...c.lastUsedState||{},filters:{...d}}}:{}};this.writeLocks.add(e),l[r]=f,this.settingsManager.updateSettings({commandGroups:l}),setTimeout(()=>this.writeLocks.delete(e),0);return}const o={...this.settingsManager.settings.defaultFilterSettings,...n};this.settingsManager.updateSettings({defaultFilterSettings:o})}catch(s){D.error("[groups] updateGroupFilterSettings failed",{groupId:e,newSettings:n,err:s})}}toggleFilterSetting(e,n){const i=this.groups.map(s=>s.id===e?{...s,filterSettings:{...s.filterSettings,[n]:!s.filterSettings[n]}}:s);this.settingsManager.updateSettings({commandGroups:i})}getExcludedModulesForGroup(e){const n=this.getGroup(e);return(n==null?void 0:n.excludedModules)||[]}toggleExcludedModuleForGroup(e,n){const i=this.groups.map(s=>{if(s.id===e){const o=s.excludedModules.indexOf(n)!==-1?s.excludedModules.filter(l=>l!==n):[...s.excludedModules,n];return{...s,excludedModules:o}}return s});this.settingsManager.updateSettings({commandGroups:i})}moveCommandInGroup(e,n,i){const s=this.groups.map(r=>{if(r.id===e){const o=[...r.commandIds];if(n<0||n>=o.length||i<0||i>=o.length)return r;const[l]=o.splice(n,1);return o.splice(i,0,l),{...r,commandIds:o}}return r});this.settingsManager.updateSettings({commandGroups:s})}setGroupCommandOrder(e,n){const i=this.groups.map(s=>{if(s.id===e){const r=new Set(s.commandIds),o=n.filter(l=>r.has(l));return{...s,commandIds:o}}return s});this.settingsManager.updateSettings({commandGroups:i})}replaceGroupFilters(e,n){try{if(this.writeLocks.has(e)){D.debug("[groups] replaceGroupFilters skipped (locked)",{groupId:e});return}const i=this.settingsManager.settings.defaultFilterSettings,s=this.groups.map(r=>{var o;if(r.id===e){const l={...i,...n||{}};return this.isEqualFilters(r.filterSettings,l)?r:{...r,filterSettings:l,...((o=r.behavior)==null?void 0:o.onOpen)==="dynamic"?{lastUsedState:{...r.lastUsedState||{},filters:{...l}}}:{}}}return r});this.writeLocks.add(e),this.settingsManager.updateSettings({commandGroups:s}),setTimeout(()=>this.writeLocks.delete(e),0)}catch(i){D.error("[groups] replaceGroupFilters failed",{groupId:e,err:i})}}setGroupDefaults(e,n){try{const i=this.settingsManager.settings.defaultFilterSettings,s=this.groups.map(r=>{if(r.id===e){const l=r.defaults,c={...l||{filters:{...r.filterSettings}},...n,filters:{...i,...(l==null?void 0:l.filters)||r.filterSettings,...n.filters||{}}};return l&&this.isEqualFilters(l.filters,c.filters)?(D.debug("[groups] setGroupDefaults noop (no change)",{groupId:e}),r):(D.debug("[groups] setGroupDefaults",{groupId:e,filters:c.filters}),{...r,defaults:c})}return r});this.settingsManager.updateSettings({commandGroups:s})}catch(i){D.error("[groups] setGroupDefaults failed",{groupId:e,state:n,err:i})}}applyDefaultsToGroupFilters(e){try{const n=this.getGroup(e),i=n==null?void 0:n.defaults;if(i!=null&&i.filters){const s=this.settingsManager.settings.defaultFilterSettings;this.replaceGroupFilters(e,{...s,...i.filters})}else D.debug("[groups] no defaults to apply",{groupId:e})}catch(n){D.error("[groups] applyDefaultsToGroupFilters failed",{groupId:e,err:n})}}applyDynamicLastUsedToGroupFilters(e){try{if(this.writeLocks.has(e))return;const n=this.getGroup(e),i=n==null?void 0:n.lastUsedState;if(i!=null&&i.filters){const s=this.settingsManager.settings.defaultFilterSettings;this.replaceGroupFilters(e,{...s,...i.filters})}else D.debug("[groups] no lastUsedState to apply",{groupId:e})}catch(n){D.error("[groups] applyDynamicLastUsedToGroupFilters failed",{groupId:e,err:n})}}isEqualFilters(e,n){const i=this.settingsManager.settings.defaultFilterSettings,s=Object.keys(i);for(const r of s)if(!!(e!=null&&e[r])!=!!(n!=null&&n[r]))return!1;return!0}moveGroup(e,n){const i=[...this.groups];if(e<0||n<0||e>=i.length||n>=i.length)return;const[s]=i.splice(e,1);i.splice(n,0,s),this.settingsManager.updateSettings({commandGroups:i})}setGroupRegisterCommand(e,n){const i=this.groups.map(s=>s.id===e?{...s,registerCommand:!!n}:s);this.settingsManager.updateSettings({commandGroups:i})}normalizeAllGroups(){const e=this.settingsManager.settings.defaultFilterSettings,n=this.groups.map(i=>{const s={...e,...i.filterSettings||{}},r=i.defaults,o=r?{...r,filters:{...e,...r.filters||s}}:void 0,l=i.lastUsedState,c=l?{...l,filters:{...e,...l.filters||s}}:void 0,u={...i,filterSettings:s},d=o?{...u,defaults:o}:u;return c?{...d,lastUsedState:c}:d});try{JSON.stringify(n)!==JSON.stringify(this.groups)&&this.settingsManager.updateSettings({commandGroups:n})}catch{this.settingsManager.updateSettings({commandGroups:n})}}getGroupBehavior(e){var i;if(e==="all")return this.settingsManager.settings.allGroupOnOpen||"default";const n=this.getGroup(e);return((i=n==null?void 0:n.behavior)==null?void 0:i.onOpen)==="dynamic"?"dynamic":"default"}setGroupBehavior(e,n){if(e==="all"){this.settingsManager.updateSettings({allGroupOnOpen:n});return}const i=this.groups.map(s=>{if(s.id===e){const r={...s.behavior||{},onOpen:n};return{...s,behavior:r}}return s});this.settingsManager.updateSettings({commandGroups:i})}setAllGroupDefaults(e){try{const i={...this.settingsManager.settings.defaultFilterSettings,...(e==null?void 0:e.filters)||{}};setTimeout(()=>{this.settingsManager.updateSettings({allGroupDefaultFilters:{...i}})},0)}catch(n){D.error("[groups] setAllGroupDefaults failed",{state:e,err:n})}}applyDefaultsToAllFilters(){var e;try{const n=this.settingsManager.settings.allGroupDefaultFilters||((e=this.settingsManager.settings.allGroupDefaults)==null?void 0:e.filters);if(n){const i=this.settingsManager.settings.defaultFilterSettings,s={...i,...n};if(this.isEqualFilters(i,s))return;this.settingsManager.updateSettings({defaultFilterSettings:s})}else D.debug("[groups] no allGroupDefaults to apply")}catch(n){D.error("[groups] applyDefaultsToAllFilters failed",{err:n})}}slugifyUnique(e){const n=e.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").slice(0,60)||"group";let i=n,s=1;const r=new Set(this.groups.map(o=>String(o.id)));for(;r.has(i);)i=`${n}-${s++}`;return i}};Hi=new WeakMap,Z(Pn,"instance",null);let ks=Pn;const ta={StrictModifierMatch:!0,ViewWOhotkeys:!0,OnlyCustom:!1,OnlyDuplicates:!1,FeaturedFirst:!1,HighlightCustom:!1,HighlightDuplicates:!1,HighlightBuiltIns:!1,DisplayIDs:!1,ShowPluginBadges:!0,GroupByPlugin:!1,DisplayGroupAssignment:!1,DisplayInternalModules:!0,DisplaySystemShortcuts:!1},os={showStatusBarItem:!0,defaultFilterSettings:ta,filters:{isUnifiedAcrossGroups:!1,filterSettings:ta},featuredCommandIDs:[],commandGroups:[],lastOpenedGroupId:"all",pinKeyboardPanel:!1,keyboardCollapsed:!1,enableDeveloperOptions:!1,devLoggingEnabled:!1,emulatedOS:"none",useBakedKeyNames:!0,allGroupOnOpen:"default",keyListenerScope:"activeView",modifierActivationMode:"click",searchDebounceMs:200,quickViewHeight:360,quickViewWidth:420,quickViewAutoRun:!0,settingsSchemaVersion:1};var Bi;const Gn=class Gn{constructor(e){Z(this,"plugin");Pe(this,Bi,F(Be(os)));Z(this,"saveTimer",null);Z(this,"saveInProgress",!1);Z(this,"pendingAfterSave",!1);this.plugin=e}get settings(){return a(V(this,Bi))}set settings(e){g(V(this,Bi),e,!0)}static getInstance(e){return Gn.instance||(Gn.instance=new Gn(e)),Gn.instance}getSetting(e){return this.settings[e]}async loadSettings(){try{const e=await this.plugin.loadData();e&&typeof e=="object"?this.settings={...os,...e}:(this.settings={...os},await this.plugin.saveData(this.settings));const n=Number(this.settings.settingsSchemaVersion??0);if(!n||n<1){Array.isArray(this.settings.commandGroups)||(this.settings.commandGroups=[]),this.settings.settingsSchemaVersion=1;try{await this.plugin.saveData(this.settings)}catch{}}gs(!!this.settings.devLoggingEnabled),ys(this.settings.emulatedOS||"none"),fo("debug"),Qr(this.settings.keyListenerScope||"activeView"),this.settings.chordPreviewMode!==void 0&&this.settings.modifierActivationMode===void 0&&(this.settings.modifierActivationMode=this.settings.chordPreviewMode?"press":"click"),Xr(this.settings.modifierActivationMode||"click"),Number(this.settings.searchDebounceMs??200)}catch(e){D.error("Failed to Plugin load settings:",e);try{this.settings={...os},await this.plugin.saveData(this.settings),D.warn("Settings file was invalid; wrote defaults to repair data.json")}catch(n){D.error("Failed to write default settings after load error:",n)}}}async saveSettings(){try{await this.plugin.saveData(this.settings)}catch(e){D.error("Failed to Plugin save settings:",e)}}scheduleSave(e=150){this.saveTimer&&clearTimeout(this.saveTimer),this.saveTimer=setTimeout(()=>{this.saveTimer=null,this.flushSaveQueue()},e)}async flushSaveQueue(){if(this.saveInProgress){this.pendingAfterSave=!0;return}this.saveInProgress=!0;try{await this.plugin.saveData(this.settings)}catch(e){D.error("Failed to save settings (flush):",e)}finally{this.saveInProgress=!1,this.pendingAfterSave&&(this.pendingAfterSave=!1,this.scheduleSave(50))}}async flushAllSaves(){if(this.saveTimer&&(clearTimeout(this.saveTimer),this.saveTimer=null),this.saveInProgress){this.pendingAfterSave=!0;const e=Date.now();for(;this.saveInProgress&&Date.now()-e<1e3;)await new Promise(n=>setTimeout(n,25))}try{await this.plugin.saveData(this.settings)}catch(e){D.error("Failed to flush settings on unload:",e)}}updateSettings(e){let n=!1;const i={...this.settings};for(const[s,r]of Object.entries(e))i[s]!==r&&(i[s]=r,n=!0);n&&(this.settings=i,"devLoggingEnabled"in e&&(gs(!!this.settings.devLoggingEnabled),D.info("Dev logging",this.settings.devLoggingEnabled?"enabled":"disabled")),"emulatedOS"in e&&(ys(this.settings.emulatedOS||"none"),D.info("Emulated OS set to",this.settings.emulatedOS||"none")),"keyListenerScope"in e&&Qr(this.settings.keyListenerScope||"activeView"),"modifierActivationMode"in e&&Xr(this.settings.modifierActivationMode||"click"),"searchDebounceMs"in e&&(Number(this.settings.searchDebounceMs??200),void 0),this.scheduleSave())}get showStatusBarItem(){return this.settings.showStatusBarItem}set showStatusBarItem(e){this.settings.showStatusBarItem=e,this.scheduleSave()}};Bi=new WeakMap,Z(Gn,"instance",null);let ws=Gn;var Wi,Ui;const kn=class kn{constructor(e,n){Z(this,"app");Z(this,"plugin");Z(this,"hotkeyManager");Z(this,"commands",{});Z(this,"hotkeyIndex",{});Z(this,"settingsManager");Z(this,"groupManager");Pe(this,Wi,F(Be(new Set)));Z(this,"recentCommandIds",[]);Pe(this,Ui,F(Be(new Set)));this.app=e,this.plugin=n,this.hotkeyManager=Fi.getInstance(e),this.settingsManager=ws.getInstance(n),this.groupManager=ks.getInstance(this.settingsManager)}get featuredCommandIds(){return a(V(this,Wi))}set featuredCommandIds(e){g(V(this,Wi),e,!0)}get subscribers(){return a(V(this,Ui))}set subscribers(e){g(V(this,Ui),e,!0)}static getInstance(e,n){return kn.instance||(kn.instance=new kn(e,n)),kn.instance}initialize(){this.loadCommands(),this.loadFeaturedCommands()}loadCommands(){setTimeout(()=>{D.timeStart("CommandsManager.loadCommands");const n=!!globalThis.__KBA_PROFILING__;n&&console.time("CommandsManager.loadCommands");const i=this.getCommands();this.commands=this.rebuildIndex(i);const s=ea();for(const r of s)this.commands[r.id]=r;try{this.notifySubscribers()}catch{}n&&console.timeEnd("CommandsManager.loadCommands"),D.timeEnd("CommandsManager.loadCommands")},0)}getCommands(){return Object.values(this.app.commands.commands)}rebuildIndex(e){const n=!!globalThis.__KBA_PROFILING__;D.timeStart("CommandsManager.rebuildIndex"),n&&console.time("CommandsManager.rebuildIndex");const i={},s=e.reduce((r,o)=>{const l=hc(this.app,this.hotkeyManager,o);r[l.id]=l;try{const c=l.hotkeys||[];for(const u of c){const f=`${hn(Hn(u.modifiers)).join(",")}|${Gi(u.key||"")}`;i[f]||(i[f]=[]),i[f].push(l.id)}}catch{}return r},{});return this.hotkeyIndex=i,n&&console.timeEnd("CommandsManager.rebuildIndex"),D.timeEnd("CommandsManager.rebuildIndex"),s}getCommandsIndex(){return this.commands}getCommandsList(){return Object.values(this.commands)}getCommandsByHotkeyKey(e){return(this.hotkeyIndex[e]||[]).map(i=>this.commands[i]).filter(Boolean)}static makeHotkeyKey(e){return`${hn(Hn(e.modifiers)).join(",")}|${Gi(e.key||"")}`}ensureSystemShortcutsLoaded(){const e=ea();for(const n of e)this.commands[n.id]=n}refreshIndex(){this.loadCommands(),this.notifySubscribers()}subscribe(e){this.subscribers.add(e);try{e(this.getCommandsIndex())}catch{}return()=>{this.subscribers.delete(e)}}notifySubscribers(){const e=this.getCommandsIndex();for(const n of Array.from(this.subscribers))try{n(e)}catch{}}loadFeaturedCommands(){this.featuredCommandIds=new Set(this.settingsManager.getSetting("featuredCommandIDs")||[])}getGroupCommands(e){if(e===Lt.All)return Object.values(this.commands);if(e===Lt.Featured)return Array.from(this.featuredCommandIds).map(i=>this.commands[i]).filter(Boolean);if(e===Lt.Recent)return this.recentCommandIds.map(i=>this.commands[i]).filter(Boolean);const n=this.groupManager.getGroup(e);return n?n.commandIds.map(i=>this.commands[i]).filter(Boolean):[]}toggleFeaturedCommand(e){const n=new Set(this.featuredCommandIds);n.has(e)?n.delete(e):n.add(e),this.featuredCommandIds=n,this.settingsManager.updateSettings({featuredCommandIDs:Array.from(this.featuredCommandIds)})}addRecentCommand(e){this.recentCommandIds=[e,...this.recentCommandIds.filter(n=>n!==e)].slice(0,10)}filterCommands(e,n,i,s){let r=this.groupManager.getGroupSettings(s||Lt.All);if(s){const f=this.groupManager.getGroup(s);r=(f==null?void 0:f.filterSettings)||r}let o=this.getCommandsForGroup(s);const l=!!(r!=null&&r.ViewWOhotkeys)||!!(r!=null&&r.OnlyCustom)||!!(r!=null&&r.OnlyDuplicates)||(r==null?void 0:r.DisplayInternalModules)===!1;if(!e&&n.length===0&&!i&&!l)return r!=null&&r.FeaturedFirst?this.sortByFeaturedFirst(o):o;const c=e.toLowerCase(),u=n&&n.length>0||!!i;if(u&&(r!=null&&r.StrictModifierMatch))try{const f=kn.makeHotkeyKey({modifiers:n,key:i}),m=this.getCommandsByHotkeyKey(f);if(m.length){const y=new Set(m.map(p=>p.id));o=o.filter(p=>y.has(p.id))}}catch{}const d=o.filter(f=>{if(!r)return!0;const m=c.length===0||`${f.pluginName} ${f.name} ${f.cmdName}`.toLowerCase().includes(c)||r.DisplayIDs&&f.id.toLowerCase().includes(c),y=u?f.hotkeys.some(x=>this.hotkeyMatches(x,n,i,r.StrictModifierMatch||!1)):!0,p=r.ViewWOhotkeys?f.hotkeys.length>0:!0,_=r.DisplayInternalModules?!0:!f.isInternalModule,w=r.DisplaySystemShortcuts?!0:f.pluginName!=="System Shortcuts",S=r.OnlyCustom?f.hotkeys.some(x=>x.isCustom):!0,A=r.OnlyDuplicates?f.hotkeys.some(x=>this.hotkeyManager.isHotkeyDuplicate(f.id,x)):!0;return m&&y&&p&&_&&w&&S&&A});return r!=null&&r.FeaturedFirst?this.sortByFeaturedFirst(d):d}getInstalledPluginIDs(){const n=this.app.internalPlugins.getEnabledPlugins().map(r=>{var o;return((o=r.manifest)==null?void 0:o.id)||""}),s=Object.values(this.app.plugins.plugins).map(r=>{var o;return((o=r.manifest)==null?void 0:o.id)||""});return[...n,...s].filter(r=>r!=="")}commandMatchesHotkey(e,n,i,s){const{all:r}=this.hotkeyManager.getHotkeysForCommand(e);return r.some(o=>bs(o,n,i,{strictModifierMatch:s,allowKeyOnly:!0,platformize:!0}))}hotkeyMatches(e,n,i,s){return bs(e,n,i,{strictModifierMatch:s,allowKeyOnly:!0,platformize:!0})}getCommandsForGroup(e){if(!e||e===Lt.All)return Object.values(this.commands);let n=this.groupManager.getGroup(e);return n?(n.commandIds||[]).map(s=>this.commands[s]).filter(Boolean):[]}matchesGroup(e,n){if(!n)return!0;if(n===Lt.Featured)return this.featuredCommandIds.has(e.id);if(n===Lt.Recent)return this.recentCommandIds.includes(e.id);const i=this.groupManager.getGroup(n);return i?i.commandIds.includes(e.id):!0}sortByFeaturedFirst(e){return[...e].sort((n,i)=>{const s=this.featuredCommandIds.has(n.id),r=this.featuredCommandIds.has(i.id);return s&&!r?-1:!s&&r?1:0})}searchCommandsByName(e,n){const i=(e||"").trim().toLowerCase();if(!i)return[];const s=(n==null?void 0:n.excludeIds)||new Set,r=(n==null?void 0:n.limit)??20,o=[];for(const l of Object.values(this.commands)){if(s.has(l.id))continue;if(`${l.pluginName} ${l.name} ${l.cmdName} ${l.id}`.toLowerCase().includes(i)&&(o.push(l),o.length>=r))break}return o}refreshCommands(){this.loadCommands()}};Wi=new WeakMap,Ui=new WeakMap,Z(kn,"instance",null);let Oi=kn;const On=class On{constructor(e){Z(this,"app");Z(this,"cmRef");this.app=e}attachCommandsManager(e){this.cmRef=e}static getInstance(e){return On.instance||(On.instance=new On(e)),On.instance}async initialize(){}getCommandsIndex(){return this.cmRef?this.cmRef.getCommandsIndex():{}}getHotkeysForCommand(e){D.timeStart("HotkeyManager.getHotkeysForCommand");const n=this.cmRef;if(n){const f=n.getCommandsIndex()[e];if(f)return{all:f.hotkeys||[],default:f.defaultHotkeys||[],custom:f.customHotkeys||[]}}const i=this.app.hotkeyManager.getDefaultHotkeys(e)||[],s=this.app.hotkeyManager.customKeys[e]||[],r=(d,f)=>d.map(m=>({modifiers:Array.isArray(m.modifiers)?m.modifiers:typeof m.modifiers=="string"?m.modifiers.split(","):[],key:m.key||"",isCustom:f})),o=r(i,!1),l=r(s,!0),c=new Map;o.forEach(d=>{const f=this.hotkeyToUniqueKey(d);c.set(f,d)}),l.forEach(d=>{const f=this.hotkeyToUniqueKey(d);c.set(f,d)});const u=Array.from(c.values());return D.timeEnd("HotkeyManager.getHotkeysForCommand"),{all:u,default:o,custom:l}}hotkeyToUniqueKey(e){return`${[...e.modifiers].sort().join(",")}|${e.key}`}isHotkeyDuplicate(e,n){const i=this.cmRef;if(!i)return!1;const s=Oi.makeHotkeyKey({modifiers:n.modifiers||[],key:n.key||""}),r=i.getCommandsByHotkeyKey(s);return r&&r.length>0?r.some(o=>o.id!==e):!1}commandMatchesHotkey(e,n,i){const{all:s}=this.getHotkeysForCommand(e);return s.some(r=>this.hotkeyMatches(r,n,i))}hotkeyMatches(e,n,i){return bs(e,n,i,{strictModifierMatch:!0,allowKeyOnly:!0,platformize:!0})}renderHotkey(e){return[...hn(Hn(e.modifiers)),e.key].join(" ")}searchHotkeys(e,n,i){const s=this.cmRef;if(s){const r=(e||"").toLowerCase();if(i||n!=null&&n.length){const l=Oi.makeHotkeyKey({modifiers:n,key:i});return s.getCommandsByHotkeyKey(l).filter(u=>r?u.name.toLowerCase().includes(r)||u.id.toLowerCase().includes(r):!0)}const o=s.getCommandsIndex();return Object.values(o).filter(l=>r?l.name.toLowerCase().includes(r)||l.id.toLowerCase().includes(r):!0)}return[]}};Z(On,"instance",null);let Fi=On;var ji,Qi,Yi,Xi,Zi,Ji;class Sr{constructor(e,n){Z(this,"hotkeyManager");Z(this,"visualKeyboardManager");Z(this,"recognizedModifiers",new Set(["Control","Shift","Alt","Meta","Mod"]));Pe(this,ji,F(""));Pe(this,Qi,F(Be([])));Pe(this,Yi,F(""));Pe(this,Xi,F(null));Pe(this,Zi,F(null));Pe(this,Ji,He(()=>hn(this.activeModifiers)));this.hotkeyManager=Fi.getInstance(e),this.visualKeyboardManager=n}get activeKey(){return a(V(this,ji))}set activeKey(e){g(V(this,ji),e,!0)}get activeModifiers(){return a(V(this,Qi))}set activeModifiers(e){g(V(this,Qi),e,!0)}get lastVKClickRaw(){return a(V(this,Yi))}set lastVKClickRaw(e){g(V(this,Yi),e,!0)}get lastPhysicalRaw(){return a(V(this,Xi))}set lastPhysicalRaw(e){g(V(this,Xi),e,!0)}setActiveKey(e){this.activeKey=e}clearActiveKey(){this.activeKey=""}get ActiveKey(){return this.activeKey}set ActiveKey(e){this.activeKey=e}get ActiveModifiers(){return this.activeModifiers}set ActiveModifiers(e){this.activeModifiers=Array.from(new Set(e))}get state(){return{activeKey:this.activeKey,activeModifiers:this.activeModifiers}}set state(e){this.activeKey=e.activeKey,this.activeModifiers=e.activeModifiers}reset(){this.activeKey="",this.activeModifiers=[]}handleKeyClick(e){this.lastVKClickRaw=e||"";const n=this.visualKeyboardManager.mapCodeToObsidianModifier(e);if(n){this.toggleModifier(n);return}const i=this.normalizeKeyIdentifier(e);this.isModifier(i)?this.toggleModifier(i):this.activeKey=this.activeKey===i?"":i}handleKeyDown(e){if(D.debug("[keys] store.handleKeyDown",{key:e.key,code:e.code}),e.key==="Backspace"){if(this.activeKey!=="")this.activeKey="";else if(this.activeModifiers.length>0){const i=hn(this.activeModifiers);i.pop(),this.activeModifiers=i}D.debug("[keys] backspace applied",this.state);return}const n=e.code;this.handleKeyClick(n),D.debug("[keys] after handleKeyClick",this.state)}handlePhysicalKeyDown(e,n){if(D.debug("[keys] store.handlePhysicalKeyDown",{key:e.key,code:e.code}),this.lastPhysicalRaw={key:e.key||"",code:e.code||""},e.repeat){D.debug("[keys] ignored repeat keydown");return}if(_s()){const r=[];e.ctrlKey&&r.push(Ft("Control")),e.metaKey&&r.push(Ft("Meta")),e.altKey&&r.push(Ft("Alt")),e.shiftKey&&r.push("Shift"),this.activeModifiers=Array.from(new Set(r));const o=this.normalizeKeyIdentifier(e.code||e.key);n!=null&&n.inActiveView&&!this.isModifier(o)&&(this.activeKey===o?(this.activeKey="",D.debug("[keys] hold mode: cleared activeKey (toggle)",this.state)):(this.activeKey=o,D.debug("[keys] hold mode: set activeKey (keydown)",this.state))),D.debug("[keys] hold mode: modifiers updated",this.state);return}const i=this.visualKeyboardManager.mapCodeToObsidianModifier(e.code||e.key);if(i){const r=Ft(i),o=this.activeModifiers.includes(r);this.activeModifiers=o?this.activeModifiers.filter(l=>l!==r):[...this.activeModifiers,r],D.debug("[keys] toggled modifier",{m:r,on:!o,state:this.state});return}const s=this.normalizeKeyIdentifier(e.code||e.key);if(this.isModifier(s)){const r=Ft(s),o=this.activeModifiers.includes(r);this.activeModifiers=o?this.activeModifiers.filter(l=>l!==r):[...this.activeModifiers,r],D.debug("[keys] toggled modifier (normalized)",{m:r,on:!o,state:this.state});return}this.activeKey===s?(this.activeKey="",D.debug("[keys] cleared activeKey (toggle)",this.state)):(this.activeKey=s,D.debug("[keys] set activeKey (toggle)",this.state))}handlePhysicalKeyUp(e,n){if(D.debug("[keys] store.handlePhysicalKeyUp (toggle/chord)",{key:e.key,code:e.code}),_s()){const i=[];e.ctrlKey&&i.push(Ft("Control")),e.metaKey&&i.push(Ft("Meta")),e.altKey&&i.push(Ft("Alt")),e.shiftKey&&i.push("Shift"),this.activeModifiers=Array.from(new Set(i))}}isModifier(e){return this.recognizedModifiers.has(e)}toggleModifier(e){const n=Ft(e),i=new Set(this.activeModifiers);i.has(n)?i.delete(n):i.add(n),this.activeModifiers=Array.from(i)}normalizeKeyIdentifier(e){return{ControlLeft:"Control",ControlRight:"Control",AltLeft:"Alt",AltRight:"Alt",ShiftLeft:"Shift",ShiftRight:"Shift",MetaLeft:"Meta",MetaRight:"Meta"}[e]||e}getDisplayKey(){const e=this.visualKeyboardManager.keyStates[this.activeKey.toLowerCase()];return e?e.displayValue:this.activeKey.length===1?this.activeKey.toUpperCase():this.activeKey}getDevRawInputs(){return{vk:this.lastVKClickRaw,physical:this.lastPhysicalRaw,normalizedActiveKey:this.activeKey,normalizedActiveModifiers:this.activeModifiers}}recordPhysicalRaw(e){this.lastPhysicalRaw={key:e.key||"",code:e.code||""}}get _devLastCmd(){return a(V(this,Zi))}set _devLastCmd(e){g(V(this,Zi),e,!0)}devSetLastCommand(e){try{const n=(e.hotkeys||[]).map(s=>({modifiers:s.modifiers||[],key:s.key||""})),i=n.map(s=>({modifiers:hn(s.modifiers),key:(s.key||"").toLowerCase()}));this._devLastCmd={id:e.id,name:e.name,raw:n,normalized:i}}catch{this._devLastCmd={id:e.id,name:e.name,raw:[],normalized:[]}}}getDevLastCommand(){return this._devLastCmd}filterCommands(e){return this.hotkeyManager.searchHotkeys(e,this.activeModifiers,this.activeKey)}get sortedModifiers(){return a(V(this,Ji))}set sortedModifiers(e){g(V(this,Ji),e)}}ji=new WeakMap,Qi=new WeakMap,Yi=new WeakMap,Xi=new WeakMap,Zi=new WeakMap,Ji=new WeakMap;var yc=I('<button aria-label="Empty key" disabled></button>'),_c=(t,e,n)=>e(n()),bc=I("<button> </button>");function kc(t,e){en(e,!0);let n=De(e,"key",19,()=>({label:"",unicode:"",width:1,height:1,type:"empty"})),i=De(e,"maxWeightSteps",3,5);const s=Tt("visualKeyboardManager"),r=Tt("activeKeysStore"),o=Tt("isPhysicalListenerActive");let l=He(()=>s.getKeyState(n())),c=He(()=>a(l).displayValue),u=He(()=>n().width||1),d=He(()=>n().height||1);function f(U){return`span ${Math.max(1,Math.round(U*4))}`}function m(U){return`span ${Math.max(1,Math.round(U))}`}function y(U){const re=Math.max(...Object.values(s.keyStates).map(Ge=>Ge.weight||0))/i();return Math.min(Math.floor(U/re)+1,i())}function p(U){if(!U)return 0;const $=10,re=(100-$)/Math.max(1,i()-1);return Math.min(Math.round($+(U-1)*re),100)}function _(U){const $=U.code||U.label||"";(async()=>{const{default:re}=await Promise.resolve().then(()=>uc);re.debug("Clicked key:",$)})(),r.handleKeyClick($),s.updateVisualState(r.activeKey,r.activeModifiers)}let w=!1,S=!1,A="",x=null,L=null;function K(){w||(A=r.ActiveKey,L=U=>{(U.key==="Alt"||U.key==="AltGraph")&&M(!0)},window.addEventListener("keyup",L)),w=!0,r.ActiveKey=n().code||n().label||""}function M(U=!0){U?r.ActiveKey=A:(r.clearActiveKey(),A=""),w=!1,L&&(window.removeEventListener("keyup",L),L=null)}function z(U){if(S=!0,!s.mapCodeToObsidianModifier(n().code||n().label||"")){if(o!=null&&o())return;U.altKey&&K(),x=re=>{o!=null&&o()||S&&(re.key==="Alt"||re.key==="AltGraph")&&K()},window.addEventListener("keydown",x,!0)}}function te(){S=!1,w&&M(!0),x&&(window.removeEventListener("keydown",x,!0),x=null)}var se=Xe(),N=Le(se);{var J=U=>{var $=yc();let re;ee((Ge,b)=>{re=Ce($,1,"kb-layout-key svelte-qh98tu",null,re,Ge),Rn($,b)},[()=>({empty:a(l).state==="empty"}),()=>`grid-row: ${m(a(d))}; grid-column: ${f(a(u))};`]),E(U,$)},oe=U=>{var $=bc();let re;$.__click=[_c,_,n];var Ge=h($);ee((b,O,j)=>{re=Ce($,1,"kb-layout-key svelte-qh98tu",null,re,b),le($,"data-key-id",n().code||a(c)),le($,"data-weight",O),Rn($,j),ae(Ge,a(c))},[()=>({"is-active":a(l).state==="active","is-hover":a(l).state==="hover","has-hotkey":a(l).state==="possible","small-text":n().smallText}),()=>a(l).weight&&y(a(l).weight)?y(a(l).weight):0,()=>`grid-row: ${m(a(d))}; grid-column: ${f(a(u))}; ${a(l).state==="active"?"background-color: var(--interactive-accent);":(a(l).state==="inactive"||a(l).state==="possible")&&a(l).weight?`background-color: rgb(from var(--color-red) r g b / ${p(y(a(l).weight))}%);`:""}`]),Qe("mouseenter",$,z),Qe("mouseleave",$,te),E(U,$)};ve(N,U=>{a(c)==="empty"?U(J):U(oe,!1)})}E(t,se),tn()}yn(["click"]);nl();/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 */const wc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var Mc=Il("<svg><!><!></svg>");function $t(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]),i=At(n,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);en(e,!1);let s=De(e,"name",8,void 0),r=De(e,"color",8,"currentColor"),o=De(e,"size",8,24),l=De(e,"strokeWidth",8,2),c=De(e,"absoluteStrokeWidth",8,!1),u=De(e,"iconNode",24,()=>[]);const d=(...p)=>p.filter((_,w,S)=>!!_&&S.indexOf(_)===w).join(" ");Jl();var f=Mc();Rr(f,(p,_)=>({...wc,...i,width:o(),height:o(),stroke:r(),"stroke-width":p,class:_}),[()=>(ei(c()),ei(l()),ei(o()),Jt(()=>c()?Number(l())*24/Number(o()):l())),()=>(ei(s()),ei(n),Jt(()=>d("lucide-icon","lucide",s()?`lucide-${s()}`:"",n.class)))]);var m=h(f);Je(m,1,u,It,(p,_)=>{var w=He(()=>xo(a(_),2));let S=()=>a(w)[0],A=()=>a(w)[1];var x=Xe(),L=Le(x);Vl(L,S,!0,(K,M)=>{Rr(K,()=>({...A()}))}),E(p,x)});var y=k(m);Pt(y,e,"default",{}),E(t,f),tn()}function Sc(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"m6 9 6 6 6-6"}]];$t(t,Vt({name:"chevron-down"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function go(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["circle",{cx:"12",cy:"12",r:"10"}],["circle",{cx:"12",cy:"12",r:"1"}]];$t(t,Vt({name:"circle-dot"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Cc(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M10 2v2"}],["path",{d:"M14 2v2"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1"}],["path",{d:"M6 2v2"}]];$t(t,Vt({name:"coffee"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function na(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M12 10v6"}],["path",{d:"M9 13h6"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"}]];$t(t,Vt({name:"folder-plus"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Ac(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"}]];$t(t,Vt({name:"funnel"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function xc(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"}],["path",{d:"M9 18c-4.51 2-5-2-7-2"}]];$t(t,Vt({name:"github"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Zn(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]];$t(t,Vt({name:"info"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Ec(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M12 17v5"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z"}]];$t(t,Vt({name:"pin"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Dc(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]];$t(t,Vt({name:"refresh-cw"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Lc(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"m21 21-4.34-4.34"}],["circle",{cx:"11",cy:"11",r:"8"}]];$t(t,Vt({name:"search"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Kc(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"}],["circle",{cx:"12",cy:"12",r:"3"}]];$t(t,Vt({name:"settings"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function ia(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z"}]];$t(t,Vt({name:"star"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}function Ii(t,e){const n=At(e,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.536.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 */const i=[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]];$t(t,Vt({name:"x"},()=>n,{get iconNode(){return i},children:(s,r)=>{var o=Xe(),l=Le(o);Pt(l,e,"default",{}),E(s,o)},$$slots:{default:!0}}))}var Pc=(t,e,n)=>{g(e,!a(e)),n.updateSettings({keyboardCollapsed:a(e)})},Gc=(t,e)=>g(e,a(e)==="filtered"?"all":"filtered",!0),Oc=I('<button class="scope-toggle svelte-gd25ux" aria-label="Toggle heatmap scope"><span class="scope-label svelte-gd25ux">Show:</span> <span class="scope-value svelte-gd25ux"> </span></button>'),Fc=(t,e)=>g(e,!a(e)),Ic=(t,e)=>{const n=t.currentTarget.checked;e.updateSettings({devLoggingEnabled:n})},Tc=(t,e)=>{const n=t.currentTarget.checked;e.updateSettings({useBakedKeyNames:n})},Nc=(t,e)=>g(e,!a(e)),zc=(t,e)=>{const n=t.currentTarget.value;e.updateSettings({emulatedOS:n})},Vc=I('<div class="dev-dropdown svelte-gd25ux" role="menu"><div class="dev-item svelte-gd25ux"><label><input type="checkbox"/> <span>Dev logging</span></label></div> <div class="dev-item svelte-gd25ux"><label><input type="checkbox"/> <span>Use baked key names</span></label></div> <div class="dev-item svelte-gd25ux"><button class="link svelte-gd25ux"> </button></div> <div class="dev-item svelte-gd25ux"><label class="inline svelte-gd25ux" for="kbd-emu-os-select">Emulated OS:</label> <select id="kbd-emu-os-select" class="svelte-gd25ux"><option>None</option><option>Windows</option><option>macOS</option><option>Linux</option></select></div></div>'),$c=I('<div class="dev-menu svelte-gd25ux"><button class="dev-gear svelte-gd25ux" aria-haspopup="true" title="Developer options"><!></button> <!></div>'),qc=(t,e,n)=>{g(e,!a(e)),n.updateSettings({pinKeyboardPanel:a(e)})},Rc=()=>window.open("https://github.com/cogscides/obsidian-keyboard-analyzer","_blank"),Hc=()=>window.open("https://ko-fi.com/S6S5E6K74","_blank"),Bc=I('<div class="dev-row svelte-gd25ux"><span class="k svelte-gd25ux">Raw VK key:</span> <span class="v svelte-gd25ux"> </span></div> <div class="dev-row svelte-gd25ux"><span class="k svelte-gd25ux">Raw physical:</span> <span class="v svelte-gd25ux"> </span></div>',1),Wc=I('<div class="dev-inspector svelte-gd25ux" aria-live="polite"><div class="dev-row svelte-gd25ux"><span class="k svelte-gd25ux">Active key:</span><span class="v svelte-gd25ux"> </span></div> <div class="dev-row svelte-gd25ux"><span class="k svelte-gd25ux">Modifiers:</span><span class="v svelte-gd25ux"> </span></div> <!></div>'),Uc=I("<div></div>"),jc=I('<div class="dev-row"><span class="k"></span> <span class="v"> </span></div>'),Qc=I('<div class="dev-row"><span class="k">Last cmd:</span> <span class="v"> </span></div> <!>',1),Yc=I('<div class="keyboard-surface svelte-gd25ux"><div id="keyboard-layout" class="svelte-gd25ux"></div> <!></div>'),Xc=I('<div><div class="keyboard-toolbar svelte-gd25ux" role="toolbar" aria-label="Keyboard controls"><div class="toolbar-left svelte-gd25ux"><button class="panel-toggle svelte-gd25ux"><span>⌄</span> <span class="toggle-label svelte-gd25ux">Keyboard</span></button> <!></div> <div class="toolbar-right svelte-gd25ux"><!> <button class="pin-toggle svelte-gd25ux"><!> <span class="pin-label"> </span></button> <button class="github-badge svelte-gd25ux" aria-label="GitHub repository" title="Open GitHub repository"><!> <span class="sr-only">GitHub</span></button> <button class="donation-badge svelte-gd25ux" aria-label="Donate" title="Support development"><div style="padding-right: 6px;"><!></div> Donate</button></div></div> <div class="panel-content svelte-gd25ux"><!> <!></div></div>');function Zc(t,e){en(e,!0);let n=De(e,"visibleCommands",19,()=>[]),i=De(e,"strictModifierMatch",3,!1),s=De(e,"selectedGroupID",3,"");const r=Tt("keyboard-analyzer-plugin"),o=Tt("visualKeyboardManager"),l=Tt("activeKeysStore"),c=r.settingsManager,u=r.commandsManager;let d=Be(o.layout);function f(ne){return ne.rows.reduce((we,xe)=>{const Ze=xe.reduce((ut,Se)=>ut+(Se.width||1),0);return Math.max(we,Ze)},0)*4}gt(()=>{const ne=a(S)==="all"?u.getCommandsForGroup(Lt.All):n();o.calculateAndAssignWeights(ne,l.ActiveModifiers,l.ActiveKey,i())});let m=d.sections.map(ne=>`${ne.gridRatio}fr`).join(" "),y=`'${d.sections.map(ne=>ne.name).join(" ")}'`,p=d.sections.reduce((ne,we)=>(ne[we.name]=f(we),ne),{}),_=F(Be(!!c.getSetting("keyboardCollapsed"))),w=F(Be(!!c.getSetting("pinKeyboardPanel"))),S=F("filtered"),A=F(!1),x=F(!1);const L=He(()=>!!c.settings.enableDeveloperOptions);let K=He(()=>!!c.settings.devLoggingEnabled),M=He(()=>c.settings.emulatedOS||"none");var z=Xc(),te=h(z),se=h(te),N=h(se);N.__click=[Pc,_,c];var J=h(N),oe=k(N,2);{var U=ne=>{var we=Oc();we.__click=[Gc,S];var xe=k(h(we),2),Ze=h(xe);ee(()=>{le(we,"aria-pressed",a(S)==="all"),le(we,"title",a(S)==="filtered"?"Heatmap matches current filters/search":"Heatmap counts all commands"),ae(Ze,a(S)==="filtered"?"Filtered":"All")}),E(ne,we)};ve(oe,ne=>{!a(_)&&s()!==Lt.All&&ne(U)})}var $=k(se,2),re=h($);{var Ge=ne=>{var we=$c(),xe=h(we);xe.__click=[Fc,A];var Ze=h(xe);Kc(Ze,{size:16});var ut=k(xe,2);{var Se=Oe=>{var Fe=Vc(),it=h(Fe),Ve=h(it),je=h(Ve);je.__input=[Ic,c];var T=k(it,2),R=h(T),ke=h(R);ke.__input=[Tc,c];var ie=k(T,2),C=h(ie);C.__click=[Nc,x];var G=h(C),q=k(ie,2),pe=k(h(q),2);pe.__input=[zc,c];var ye=h(pe);ye.value=ye.__value="none";var he=k(ye);he.value=he.__value="windows";var v=k(he);v.value=v.__value="macos";var P=k(v);P.value=P.__value="linux",ee(H=>{Mt(je,a(K)),Mt(ke,H),ae(G,`${a(x)?"Hide":"Show"} Active Keys inspector`)},[()=>!!c.settings.useBakedKeyNames]),kr(pe,()=>a(M),H=>g(M,H)),E(Oe,Fe)};ve(ut,Oe=>{a(A)&&Oe(Se)})}ee(()=>le(xe,"aria-expanded",a(A))),E(ne,we)};ve(re,ne=>{a(L)&&ne(Ge)})}var b=k(re,2);b.__click=[qc,w,c];var O=h(b);Ec(O,{size:16});var j=k(O,2),Y=h(j),Q=k(b,2);Q.__click=[Rc];var fe=h(Q);xc(fe,{size:16});var W=k(Q,2);W.__click=[Hc];var Ne=h(W),ze=h(Ne);Cc(ze,{size:16});var X=k(te,2),We=h(X);{var et=ne=>{var we=Wc(),xe=h(we),Ze=k(h(xe)),ut=h(Ze),Se=k(xe,2),Oe=k(h(Se)),Fe=h(Oe),it=k(Se,2);nr(it,()=>l,Ve=>{var je=Bc();const T=He(()=>l.getDevRawInputs());var R=Le(je),ke=k(h(R),2),ie=h(ke),C=k(R,2),G=k(h(C),2),q=h(G);ee(()=>{ae(ie,a(T).vk||"—"),ae(q,a(T).physical?`${a(T).physical.code||"—"} (${a(T).physical.key||""})`:"—")}),E(Ve,je)}),ee((Ve,je)=>{ae(ut,Ve),ae(Fe,je)},[()=>l.getDisplayKey()||"—",()=>l.ActiveModifiers.length?l.ActiveModifiers.join(" + "):"—"]),E(ne,we)};ve(We,ne=>{a(x)&&ne(et)})}var Ue=k(We,2);{var ot=ne=>{var we=Yc(),xe=h(we);let Ze;Je(xe,21,()=>d.sections,It,(Se,Oe)=>{var Fe=Uc();let it;Je(Fe,21,()=>a(Oe).rows,It,(Ve,je)=>{var T=Xe(),R=Le(T);Je(R,17,()=>a(je),It,(ke,ie)=>{kc(ke,{get key(){return a(ie)}})}),E(Ve,T)}),ee(Ve=>{Ce(Fe,1,ii(a(Oe).name),"svelte-gd25ux"),it=Rn(Fe,"",it,Ve)},[()=>({"grid-template-columns":`repeat(${p[a(Oe).name]}, 1fr)`})]),E(Se,Fe)});var ut=k(xe,2);nr(ut,()=>l,Se=>{var Oe=Xe();const Fe=He(()=>l.getDevLastCommand());var it=Le(Oe);{var Ve=je=>{var T=Qc(),R=Le(T),ke=k(h(R),2),ie=h(ke),C=k(R,2);Je(C,17,()=>a(Fe).raw.slice(0,3),It,(G,q,pe)=>{var ye=jc(),he=h(ye);he.textContent=`Hotkey ${pe+1}:`;var v=k(he,2),P=h(v);ee(H=>ae(P,`${H??""}
                  ${a(q).key??""}`),[()=>(a(q).modifiers||[]).join(" + ")]),E(G,ye)}),ee(()=>ae(ie,a(Fe).id)),E(je,T)};ve(it,je=>{a(Fe)&&je(Ve)})}E(Se,Oe)}),ee(Se=>{le(xe,"data-scope",a(S)),Ze=Rn(xe,"",Ze,Se)},[()=>({"grid-template-columns":m,"grid-template-areas":y})]),E(ne,we)};ve(Ue,ne=>{a(_)||ne(ot)})}ee(()=>{Ce(z,1,`keyboard-panel ${a(_)?"collapsed":""} ${a(w)?"pinned":""}`,"svelte-gd25ux"),le(N,"aria-label",a(_)?"Expand keyboard":"Collapse keyboard"),le(N,"aria-expanded",!a(_)),le(N,"title",a(_)?"Show keyboard":"Hide keyboard"),Ce(J,1,`chevron ${a(_)?"is-collapsed":""}`,"svelte-gd25ux"),le(b,"aria-label",a(w)?"Unpin keyboard panel":"Pin keyboard panel"),le(b,"aria-pressed",a(w)),le(b,"title",a(w)?"Unpin from top":"Pin to top"),ae(Y,a(w)?"Unpin":"Pin")}),E(t,z),tn()}yn(["click","input"]);function St(t){const e=i=>{const s=i.target;if(!t||i.defaultPrevented||t.contains(s))return;const r={originalEvent:i};t.dispatchEvent(new CustomEvent("click_outside",{detail:r})),t.dispatchEvent(new CustomEvent("onclick_outside",{detail:r}))},n=i=>{const s=i.target;if(!t||i.defaultPrevented||t.contains(s))return;const r={originalEvent:i};t.dispatchEvent(new CustomEvent("click_outside",{detail:r})),t.dispatchEvent(new CustomEvent("onclick_outside",{detail:r}))};return document.addEventListener("pointerdown",e,!0),document.addEventListener("click",n,!0),{destroy(){document.removeEventListener("pointerdown",e,!0),document.removeEventListener("click",n,!0)}}}function yo(){const t=ti();return t==="macos"?!0:t==="windows"||t==="linux"?!1:rt.Platform.isMacOS}function Cr(t){const e=String(t);return yo()?e==="Ctrl"||e==="Control"?"⌃":e==="Shift"?"⇧":e==="Alt"||e==="Option"?"⌥":e==="Meta"||e==="Cmd"||e==="Win"||e==="Mod"?"⌘":e:e==="Ctrl"||e==="Control"||e==="Mod"?"Ctrl":e==="Shift"?"Shift":e==="Alt"||e==="Option"?"Alt":e==="Meta"||e==="Cmd"||e==="Win"?"Win":e}function Jc(t){const e=(t||"").trim();return e?e.length===1?e.toUpperCase():e.startsWith("Key")&&e.length===4?e.slice(3).toUpperCase():e.startsWith("Digit")&&e.length===6?e.slice(5):e:""}function Ar(t){const e=Jc(t);yo();const n=e.toLowerCase(),i={backspace:"⌫",delete:"Delete",del:"Delete",enter:"Enter",return:"Enter",tab:"Tab",escape:"Esc",esc:"Esc",space:"␣"," ":"␣",pageup:"Page Up",pagedown:"Page Down",home:"Home",end:"End",insert:"Ins",capslock:"Caps Lock",contextmenu:"Context Menu",context:"Context Menu",menu:"Context Menu",win:"Win",arrowup:"↑",arrowdown:"↓",arrowleft:"←",arrowright:"→",up:"↑",down:"↓",left:"←",right:"→",numpadenter:"Enter",numpaddivide:"÷",divide:"÷",numpadmultiply:"×",multiply:"×",numpadsubtract:"−",subtract:"−",numpadadd:"+",add:"+"};if(n in i)return i[n];const s={backquote:"`",minus:"-",equal:"=",bracketleft:"[",bracketright:"]",backslash:"\\",semicolon:";",quote:"'",comma:",",period:".",slash:"/"};return n in s?s[n]:e}function Ms(t){const e=hn(Hn(t.modifiers||[])).map(Cr),n=Ar(t.key||"");return[...e,n].filter(Boolean).join(" ")}function eu(t,e,n){if(t.key==="Escape"){if(t.stopPropagation(),t.preventDefault(),a(e)){g(e,!1);return}n()}}function tu(t,e,n){if(!e()||e()==="all")return;const i=n.getGroup(e());i&&n.setGroupDefaults(e(),{filters:i.filterSettings})}function nu(t,e,n){!e()||e()==="all"||n.applyDefaultsToGroupFilters(e())}function iu(t,e,n){var i;try{const s=(i=e==null?void 0:e.settings)==null?void 0:i.defaultFilterSettings;if(!s||typeof s!="object")return;n.setAllGroupDefaults({filters:{...s}})}catch(s){console.error("[groups] failed to set All defaults",s)}}function su(t,e,n,i,s){var o,l;!e()||e()==="all"||!confirm("Delete this group? This cannot be undone.")||(n.removeGroup(e()),(l=(o=i()).syncPerGroupCommands)==null||l.call(o),s()())}function ru(t,e,n,i){var r,o;const s=e.createGroup("New Group");s&&n(s),(o=(r=i()).syncPerGroupCommands)==null||o.call(r)}function au(t,e,n,i){var r,o;if(!e()||e()==="all")return;const s=n.duplicateGroup(e());s&&e(s),(o=(r=i()).syncPerGroupCommands)==null||o.call(r)}function ou(t,e){var n;(t.key==="Escape"||t.key==="Enter"||t.key===" ")&&(t.preventDefault(),(n=e())==null||n())}var lu=I("<option> </option>"),cu=(t,e)=>g(e,!a(e)),uu=I('<li draggable="true"><span class="kb-dnd-handle svelte-16yspta">≡</span> <span class="kb-dnd-label svelte-16yspta"> </span> <div class="kb-reorder-controls svelte-16yspta"><button class="kb-btn small svelte-16yspta" aria-label="Move up" title="Move up">↑</button> <button class="kb-btn small svelte-16yspta" aria-label="Move down" title="Move down">↓</button></div></li>'),du=I('<ul class="kb-group-reorder svelte-16yspta"></ul>'),fu=(t,e)=>e("default"),vu=(t,e)=>e("dynamic"),pu=(t,e)=>e.applyDefaultsToAllFilters(),hu=I('<div class="kb-group-behavior svelte-16yspta"><fieldset class="kb-fieldset"><legend class="u-muted small svelte-16yspta">On open</legend> <div class="kb-row svelte-16yspta"><label class="kb-radio svelte-16yspta"><input type="radio" name="onopen"/> Default settings</label> <label class="kb-radio svelte-16yspta"><input type="radio" name="onopen"/> Last used (dynamic)</label></div></fieldset> <div class="kb-row wrap svelte-16yspta"><button class="kb-btn" title="Save current filters as All Commands defaults">Use current filters as defaults</button> <button class="kb-btn" title="Apply saved All Commands defaults to current filters">Reset filters to defaults</button></div></div>'),mu=(t,e)=>t.key==="Enter"&&e(),gu=(t,e)=>e("default"),yu=(t,e)=>e("dynamic"),_u=(t,e)=>e(t.currentTarget.checked),bu=I('<button class="kb-icon clear svelte-16yspta" aria-label="Clear search" title="Clear"><!></button>'),ku=(t,e,n)=>e(a(n)),wu=(t,e,n)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(a(n))),Mu=I('<span class="hk svelte-16yspta"> </span>'),Su=I('<span class="hk u-muted svelte-16yspta">no hotkey</span>'),Cu=I('<li class="kb-cmd-option svelte-16yspta" role="option" aria-selected="false" tabindex="0"><span class="label svelte-16yspta"> </span> <!></li>'),Au=I('<ul id="kb-cmd-search-list" class="kb-cmd-dropdown svelte-16yspta" role="listbox"></ul>'),xu=I('<div class="kb-cmd-empty u-muted small svelte-16yspta">No matching commands</div>'),Eu=I('<div class="kb-cmd-search svelte-16yspta"><label class="u-muted small svelte-16yspta" for="kb-cmd-search-input">Add commands</label> <div class="kb-cmd-search-input svelte-16yspta"><input id="kb-cmd-search-input" class="kb-input svelte-16yspta" type="text" placeholder="Search commands to add..." role="combobox" aria-autocomplete="list" aria-haspopup="listbox" aria-controls="kb-cmd-search-list"/> <!></div> <!></div>'),Du=I('<div class="u-muted">No commands in this group yet.</div>'),Lu=I('<span class="hk svelte-16yspta"> </span>'),Ku=I('<span class="hk u-muted svelte-16yspta">no hotkey</span>'),Pu=(t,e,n,i)=>e.removeCommandFromGroup(n(),a(i).id),Gu=I('<button class="kb-icon rm-icon svelte-16yspta" title="Remove from group" aria-label="Remove from group"><!></button>'),Ou=I('<li><span class="kb-dnd-handle svelte-16yspta">≡</span> <span class="kb-dnd-label svelte-16yspta"> </span> <span class="kb-hk-list svelte-16yspta"><!></span> <!></li>'),Fu=I('<ul class="kb-dnd-list svelte-16yspta"></ul> <div class="u-muted small svelte-16yspta">Drag items to reorder. Changes save automatically.</div>',1),Iu=I(`<div class="kb-group-meta svelte-16yspta"><label class="u-muted small svelte-16yspta" for="kb-group-name">Name</label> <div class="kb-row svelte-16yspta"><input id="kb-group-name" class="kb-input svelte-16yspta" type="text"/> <button class="kb-btn danger svelte-16yspta" aria-label="Delete group">Delete</button></div></div> <div class="kb-group-behavior svelte-16yspta"><fieldset class="kb-fieldset"><legend class="u-muted small svelte-16yspta">On open</legend> <div class="kb-row svelte-16yspta"><label class="kb-radio svelte-16yspta"><input type="radio" name="onopen"/> Default settings</label> <label class="kb-radio svelte-16yspta"><input type="radio" name="onopen"/> Last used (dynamic)</label></div></fieldset> <div class="kb-row wrap svelte-16yspta"><button class="kb-btn" title="Save current filters as this group's defaults">Use current filters as defaults</button> <button class="kb-btn" title="Apply saved defaults to current filters">Reset filters to defaults</button></div></div> <div class="kb-group-commands"><span class="u-muted small svelte-16yspta">Command palette</span> <div class="kb-row svelte-16yspta"><label class="kb-radio svelte-16yspta"><input type="checkbox"/> </label></div></div> <!> <!>`,1),Tu=I('<section class="kb-main svelte-16yspta"><!></section>'),Nu=I('<div class="kb-modal-backdrop svelte-16yspta" role="button" tabindex="0" aria-label="Close dialog"></div> <div class="kb-modal svelte-16yspta" role="dialog" aria-modal="true" aria-label="Manage groups"><div class="kb-modal-header svelte-16yspta"><h3>Manage Groups</h3> <button class="kb-close svelte-16yspta" aria-label="Close">×</button></div> <div class="kb-modal-body stack svelte-16yspta"><div class="kb-controls-row svelte-16yspta"><label class="u-muted small svelte-16yspta" for="kb-group-dropdown">Group</label> <select id="kb-group-dropdown" class="kb-input svelte-16yspta" title="Select group"><option>All Commands</option><!></select> <button class="kb-btn" title="Create new group">+ New</button> <button class="kb-btn" title="Duplicate selected group">Duplicate</button> <button class="kb-btn" title="Reorder groups"> </button></div> <!></div></div>',1);function zu(t,e){en(e,!0);let n=De(e,"plugin",15),i=De(e,"selectedGroupId",15,"all"),s=De(e,"onClose",11,()=>{});n()||n(Tt("keyboard-analyzer-plugin"));const r=n().groupManager,o=n().commandsManager,l=n().settingsManager,c=n().hotkeyManager;let u=He(()=>r.getGroups()),d=He(()=>{var C;return((C=r.getGroup(i()||""))==null?void 0:C.name)||""}),f=F("");gt(()=>{g(f,a(d),!0)});let m=He(()=>o.getGroupCommands(i()||"")),y=F(""),p=F(!1),_=F(Be([])),w=20,S=F(null),A=null;function x(C){var q;const G=(q=C.hotkeys)==null?void 0:q[0];return G?l.settings.useBakedKeyNames?Ms(G):c.renderHotkey(G):""}function L(){const C=(a(y)||"").trim();if(!i()||i()==="all"){g(_,[],!0),g(p,!1);return}const G=new Set((a(m)||[]).map(pe=>pe.id));let q;if(C)q=o.searchCommandsByName(C,{excludeIds:G,limit:w});else{const pe=o.getCommandsList();q=[];for(const ye of pe)G.has(ye.id)||q.push(ye)}g(_,q,!0),g(p,!0)}function K(){A&&clearTimeout(A),A=setTimeout(L,180)}function M(){var C;g(y,""),g(_,[],!0),g(p,!1),(C=a(S))==null||C.focus()}function z(){!i()||i()==="all"||((a(y)||"").trim().length===0&&L(),g(p,!0))}function te(C){!i()||i()==="all"||(r.addCommandToGroup(i(),C.id),g(_,a(_).filter(G=>G.id!==C.id),!0))}let se=He(()=>r.getGroupBehavior(i()||"all")||"default");function N(C){i()&&r.setGroupBehavior(i(),C)}let J=He(()=>{if(!i()||i()==="all")return!1;const C=r.getGroup(i());return!!(C!=null&&C.registerCommand)});function oe(C){var G,q;!i()||i()==="all"||(r.setGroupRegisterCommand(i(),!!C),(q=(G=n()).syncPerGroupCommands)==null||q.call(G))}let U=F(null),$=F(null),re=F(!1);function Ge(C){g(U,C,!0)}function b(C,G){C.preventDefault();const pe=C.currentTarget.getBoundingClientRect(),ye=C.clientY>pe.top+pe.height/2;g($,G,!0),g(re,ye)}function O(){g($,null)}function j(){if(a(U)===null||i()==="all"||!i())return;if(a($)===null){g(U,null);return}let C=a($)+(a(re)?1:0);a(U)<C&&(C-=1),C<0&&(C=0),r.moveCommandInGroup(i(),a(U),C),g(U,null),g($,null)}let Y=F(null),Q=F(null),fe=F(!1),W=F(!1);function Ne(C){g(Y,C,!0)}function ze(C,G){C.preventDefault();const pe=C.currentTarget.getBoundingClientRect();g(Q,G,!0),g(fe,C.clientY>pe.top+pe.height/2)}function X(){g(Q,null)}function We(){if(a(Y)===null||a(Q)===null){g(Y,null),g(Q,null);return}let C=a(Q)+(a(fe)?1:0);a(Y)<C&&(C-=1),C<0&&(C=0),C!==a(Y)&&r.moveGroup(a(Y),C),g(Y,null),g(Q,null)}function et(){var G,q;if(!i()||i()==="all")return;const C=(a(f)||"").trim();C&&C!==a(d)&&(r.renameGroup(i(),C),(q=(G=n()).syncPerGroupCommands)==null||q.call(G))}var Ue=Nu(),ot=Le(Ue);ot.__click=function(...C){var G;(G=s())==null||G.apply(this,C)},ot.__keydown=[ou,s];var ne=k(ot,2),we=h(ne),xe=k(h(we),2);xe.__click=function(...C){var G;(G=s())==null||G.apply(this,C)};var Ze=k(we,2),ut=h(Ze),Se=k(h(ut),2),Oe=h(Se);Oe.value=Oe.__value="all";var Fe=k(Oe);Je(Fe,17,()=>a(u),C=>C.id,(C,G)=>{var q=lu(),pe=h(q),ye={};ee(he=>{ae(pe,a(G).name),ye!==(ye=he)&&(q.value=(q.__value=he)??"")},[()=>String(a(G).id)]),E(C,q)});var it=k(Se,2);it.__click=[ru,r,i,n];var Ve=k(it,2);Ve.__click=[au,i,r,n];var je=k(Ve,2);je.__click=[cu,W];var T=h(je),R=k(ut,2);{var ke=C=>{var G=du();Je(G,23,()=>a(u),q=>q.id,(q,pe,ye)=>{var he=uu(),v=k(h(he),2),P=h(v),H=k(v,2),B=h(H);B.__click=()=>r.moveGroup(a(ye),Math.max(0,a(ye)-1));var me=k(B,2);me.__click=()=>r.moveGroup(a(ye),Math.min(a(u).length-1,a(ye)+1)),ee(ue=>{Ce(he,1,ue,"svelte-16yspta"),ae(P,a(pe).name)},[()=>`kb-group-li ${String(a(pe).id)===i()?"is-active":""} ${a(Q)===a(ye)?a(fe)?"insert-after":"insert-before":""}`]),Qe("dragstart",he,()=>Ne(a(ye))),Qe("dragover",he,ue=>ze(ue,a(ye))),Qe("dragleave",he,X),Qe("drop",he,We),E(q,he)}),E(C,G)},ie=C=>{var G=Tu(),q=h(G);{var pe=he=>{var v=hu(),P=h(v),H=k(h(P),2),B=h(H),me=h(B);me.__change=[fu,N];var ue=k(B,2),_e=h(ue);_e.__change=[vu,N];var st=k(P,2),Ye=h(st);Ye.__click=[iu,l,r];var tt=k(Ye,2);tt.__click=[pu,r],ee(()=>{Mt(me,a(se)==="default"),Mt(_e,a(se)==="dynamic")}),E(he,v)},ye=he=>{var v=Iu(),P=Le(v),H=k(h(P),2),B=h(H);B.__keydown=[mu,et];var me=k(B,2);me.__click=[su,i,r,n,s];var ue=k(P,2),_e=h(ue),st=k(h(_e),2),Ye=h(st),tt=h(Ye);tt.__change=[gu,N];var Ie=k(Ye,2),be=h(Ie);be.__change=[yu,N];var Ae=k(_e,2),Ee=h(Ae);Ee.__click=[tu,i,r];var xt=k(Ee,2);xt.__click=[nu,i,r];var qt=k(ue,2),vt=k(h(qt),2),_t=h(vt),Et=h(_t);Et.__change=[_u,oe];var nn=k(Et),pt=k(qt,2);{var Ln=nt=>{var ht=Eu(),sn=k(h(ht),2),bt=h(sn);bt.__input=K,bt.__keydown=[eu,p,M],$n(bt,de=>g(S,de),()=>a(S));var Rt=k(bt,2);{var Qt=de=>{var $e=bu();$e.__click=M;var Ke=h($e);Ii(Ke,{size:14}),E(de,$e)};ve(Rt,de=>{a(y)&&de(Qt)})}var mt=k(sn,2);{var _n=de=>{var $e=Au();Je($e,21,()=>a(_),Ke=>Ke.id,(Ke,qe)=>{var dt=Cu();dt.__click=[ku,te,qe],dt.__keydown=[wu,te,qe];var kt=h(dt),at=h(kt),lt=k(kt,2);{var fn=Ht=>{var rn=Mu(),mi=h(rn);ee(gi=>ae(mi,gi),[()=>x(a(qe))]),E(Ht,rn)},Yt=Ht=>{var rn=Su();E(Ht,rn)};ve(lt,Ht=>{a(qe).hotkeys&&a(qe).hotkeys.length>0?Ht(fn):Ht(Yt,!1)})}ee(()=>{le(dt,"title",`${a(qe).pluginName}: ${a(qe).name}`),ae(at,`${a(qe).pluginName??""}: ${a(qe).name??""}`)}),E(Ke,dt)}),E(de,$e)},ce=de=>{var $e=Xe(),Ke=Le($e);{var qe=dt=>{var kt=xu();E(dt,kt)};ve(Ke,dt=>{a(p)&&a(y).trim().length>0&&dt(qe)},!0)}E(de,$e)};ve(mt,de=>{a(p)&&a(_).length>0?de(_n):de(ce,!1)})}Pi(ht,de=>St==null?void 0:St(de)),ee(()=>le(bt,"aria-expanded",a(p))),Qe("click_outside",ht,()=>g(p,!1)),Qe("focus",bt,z),di(bt,()=>a(y),de=>g(y,de)),E(nt,ht)};ve(pt,nt=>{i()!=="all"&&nt(Ln)})}var Kn=k(pt,2);{var Gt=nt=>{var ht=Du();E(nt,ht)},hi=nt=>{var ht=Fu(),sn=Le(ht);Je(sn,23,()=>a(m),bt=>bt.id,(bt,Rt,Qt)=>{var mt=Ou(),_n=k(h(mt),2),ce=h(_n),de=k(_n,2),$e=h(de);{var Ke=at=>{var lt=Xe(),fn=Le(lt);Je(fn,17,()=>a(Rt).hotkeys,It,(Yt,Ht)=>{var rn=Lu(),mi=h(rn);ee(gi=>ae(mi,gi),[()=>l.settings.useBakedKeyNames?Ms(a(Ht)):c.renderHotkey(a(Ht))]),E(Yt,rn)}),E(at,lt)},qe=at=>{var lt=Ku();E(at,lt)};ve($e,at=>{var lt;(lt=a(Rt).hotkeys)!=null&&lt.length?at(Ke):at(qe,!1)})}var dt=k(de,2);{var kt=at=>{var lt=Gu();lt.__click=[Pu,r,i,Rt];var fn=h(lt);Ii(fn,{size:14}),E(at,lt)};ve(dt,at=>{i()!=="all"&&at(kt)})}ee(()=>{Ce(mt,1,`kb-dnd-item ${a($)===a(Qt)?a(re)?"insert-after":"insert-before":""}`,"svelte-16yspta"),le(mt,"draggable",i()!=="all"),le(mt,"aria-grabbed",a(U)===a(Qt)),ae(ce,`${a(Rt).pluginName??""}: ${a(Rt).name??""}`)}),Qe("dragstart",mt,()=>Ge(a(Qt))),Qe("dragover",mt,at=>b(at,a(Qt))),Qe("dragleave",mt,O),Qe("drop",mt,j),E(bt,mt)}),E(nt,ht)};ve(Kn,nt=>{a(m).length===0?nt(Gt):nt(hi,!1)})}ee(()=>{Mt(tt,a(se)==="default"),Mt(be,a(se)==="dynamic"),Mt(Et,a(J)),ae(nn,` Register “Open: ${a(d)??""}”`)}),Qe("blur",B,et),di(B,()=>a(f),nt=>g(f,nt)),E(he,v)};ve(q,he=>{!i()||i()==="all"?he(pe):he(ye,!1)})}E(C,G)};ve(R,C=>{a(W)?C(ke):C(ie,!1)})}ee(()=>{Ve.disabled=!i()||i()==="all",le(je,"aria-pressed",a(W)),ae(T,a(W)?"Done":"Reorder")}),kr(Se,i),E(t,Ue),tn()}yn(["click","keydown","change","input"]);function Vu(t,e){g(e,!0)}var $u=I('<label class="u-muted svelte-1bwdlng" for="kb-group-select">Group</label>'),qu=(t,e,n)=>e()(n()),Ru=I("<option> </option>"),Hu=I('<button class="btn-manage svelte-1bwdlng" aria-label="Manage groups">Manage</button>'),Bu=I('<div class="kb-group-selector svelte-1bwdlng"><!> <div class="row svelte-1bwdlng"><select id="kb-group-select" class="dropdown svelte-1bwdlng"><option>All Commands</option><!></select> <!></div> <!></div>');function _o(t,e){en(e,!0);let n=De(e,"selectedGroup",15,"all"),i=De(e,"compact",11,!1),s=De(e,"onChange",11,K=>{});function r(){try{return Tt("keyboard-analyzer-plugin")}catch(K){D.error("[GroupSelector] failed to resolve plugin from context",K);return}}const o=e.plugin??r(),l=o==null?void 0:o.groupManager;let c=F(!1);function u(){g(c,!1)}var d=Bu(),f=h(d);{var m=K=>{var M=$u();E(K,M)};ve(f,K=>{i()||K(m)})}var y=k(f,2),p=h(y);p.__change=[qu,s,n];var _=h(p);_.value=_.__value="all";var w=k(_);Je(w,17,()=>{var K;return((K=l==null?void 0:l.getGroups)==null?void 0:K.call(l))||[]},K=>K.id,(K,M)=>{var z=Ru(),te=h(z),se={};ee(()=>{ae(te,a(M).name),se!==(se=a(M).id)&&(z.value=(z.__value=a(M).id)??"")}),E(K,z)});var S=k(p,2);{var A=K=>{var M=Hu();M.__click=[Vu,c],E(K,M)};ve(S,K=>{!i()&&o&&K(A)})}var x=k(y,2);{var L=K=>{zu(K,{get plugin(){return o},get selectedGroupId(){return n()},onClose:u})};ve(x,K=>{a(c)&&o&&K(L)})}ee(()=>le(d,"data-compact",i()?"true":"false")),kr(p,n),E(t,d),tn()}yn(["change","click"]);const Wu=t=>t;function Uu(t){const e=t-1;return e*e*e+1}function ju(t,{delay:e=0,duration:n=400,easing:i=Wu}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:i,css:r=>`opacity: ${r*s}`}}function sa(t,{delay:e=0,duration:n=400,easing:i=Uu,axis:s="y"}={}){const r=getComputedStyle(t),o=+r.opacity,l=s==="y"?"height":"width",c=parseFloat(r[l]),u=s==="y"?["top","bottom"]:["left","right"],d=u.map(S=>`${S[0].toUpperCase()}${S.slice(1)}`),f=parseFloat(r[`padding${d[0]}`]),m=parseFloat(r[`padding${d[1]}`]),y=parseFloat(r[`margin${d[0]}`]),p=parseFloat(r[`margin${d[1]}`]),_=parseFloat(r[`border${d[0]}Width`]),w=parseFloat(r[`border${d[1]}Width`]);return{delay:e,duration:n,easing:i,css:S=>`overflow: hidden;opacity: ${Math.min(S*20,1)*o};${l}: ${S*c}px;padding-${u[0]}: ${S*f}px;padding-${u[1]}: ${S*m}px;margin-${u[0]}: ${S*y}px;margin-${u[1]}: ${S*p}px;border-${u[0]}-width: ${S*_}px;border-${u[1]}-width: ${S*w}px;min-${l}: 0`}}const pn={StrictModifierMatch:"StrictModifierMatch",ViewWOhotkeys:"ViewWOhotkeys",OnlyCustom:"OnlyCustom",OnlyDuplicates:"OnlyDuplicates",DisplayInternalModules:"DisplayInternalModules",DisplaySystemShortcuts:"DisplaySystemShortcuts"},Qu={FeaturedFirst:"FeaturedFirst",GroupByPlugin:"GroupByPlugin",HighlightCustom:"HighlightCustom",HighlightDuplicates:"HighlightDuplicates",DisplayIDs:"DisplayIDs",HighlightBuiltIns:"HighlightBuiltIns",ShowPluginBadges:"ShowPluginBadges"};function Yu(t,e,n,i){var s;e()===""?a(n).reset():e(""),(s=i())==null||s.focus()}function Xu(t,e,n){const i=!a(e);g(e,i),i&&g(n,!1)}function Zu(t,e,n){var s;const i=!e();D.debug("[keys] toggle listener",{from:e(),to:i}),e(i),(s=n())==null||s.focus()}function Ju(t,e,n){g(e,!0),n.refreshCommands(),setTimeout(()=>{g(e,!1)},1e3)}function ra(t,e,n,i,s,r,o){if(t.key==="Escape"&&(a(e)||a(n))){g(e,!1),g(n,!1),t.stopPropagation();return}if(i()){t.stopPropagation(),t.preventDefault();return}if(t.key==="Backspace"&&String(s()||"").trim()===""){if(a(r).activeKey)a(r).clearActiveKey();else if(a(r).activeModifiers.length>0){const l=[...a(r).sortedModifiers];l.pop(),a(r).ActiveModifiers=l}o(),t.preventDefault(),t.stopPropagation();return}o()}var ed=(t,e,n)=>e(a(n)),td=I('<kbd class="modifier setting-hotkey"> </kbd>'),nd=(t,e)=>a(e).handleKeyClick(a(e).activeKey),id=I('<kbd class="modifier setting-hotkey"> </kbd>'),sd=(t,e)=>g(e,!a(e)),rd=(t,e,n)=>e(pn.StrictModifierMatch,!a(n).StrictModifierMatch),ad=(t,e,n)=>e(pn.ViewWOhotkeys,!a(n).ViewWOhotkeys),od=(t,e,n)=>e(pn.OnlyCustom,!a(n).OnlyCustom),ld=(t,e,n)=>e(pn.OnlyDuplicates,!a(n).OnlyDuplicates),cd=(t,e,n)=>e(pn.DisplaySystemShortcuts,!a(n).DisplaySystemShortcuts),ud=I('<div class="popup-filter-menu-container is-open"><div class="popup-filter-menu"><div class="setting-item mod-toggle"><div><input type="checkbox" tabindex="0" id="filter-StrictModifierMatch"/></div> <div class="setting-item-name popup-filter-title"> <span class="info-icon"><!></span></div></div> <div class="setting-item mod-toggle"><div><input type="checkbox" tabindex="0" id="filter-ViewWOhotkeys"/></div> <div class="setting-item-name popup-filter-title"> <span class="info-icon"><!></span></div></div> <div class="setting-item mod-toggle"><div><input type="checkbox" tabindex="0" id="filter-OnlyCustom"/></div> <div class="setting-item-name popup-filter-title"> <span class="info-icon"><!></span></div></div> <div class="setting-item mod-toggle"><div><input type="checkbox" tabindex="0" id="filter-OnlyDuplicates"/></div> <div class="setting-item-name popup-filter-title"> <span class="info-icon"><!></span></div></div> <div class="setting-item mod-toggle"><div><input type="checkbox" tabindex="0" id="filter-DisplaySystemShortcuts"/></div> <div class="setting-item-name popup-filter-title"> <span class="info-icon"><!></span></div></div></div> <div class="popup-filter-menu-background"></div></div>'),dd=(t,e,n,i)=>e(a(n),!a(i)[a(n)]),fd=I('<div class="setting-item mod-toggle"><div><input type="checkbox" tabindex="0"/></div> <div class="setting-item-name"> <span class="info-icon"><!></span></div></div>'),vd=I('<div class="popup-filter-menu-container is-open"><div class="popup-filter-menu"></div></div>'),pd=I('<span class="counts-line"><span class="n"> </span> <span class="label">keys</span> <span>|</span> <span class="n"> </span> <span class="label">cmds</span></span>'),hd=I("<span>Hotkeys not found</span>"),md=I('<!>  <div class="hotkey-settings-container"><div><div class="modifiers-wrapper"><!> <!></div> <div class="hotkey-search-container"><input type="text" placeholder="Filter..."/> <div class="meta-search-wrapper"><button><!></button> <button class="clear-icon icon" aria-label="Clear text or reset keys" title="Clear text or reset keys"><!></button></div></div></div> <div class="menu-anchor"><button id="hotkey-filter-button" aria-label="Filter Commands"><!></button> <!></div> <div class="menu-anchor"><button id="hotkey-view-button" aria-label="View Options">View</button> <!></div>  <div class="community-plugin-search-summary u-muted"><!></div> <button id="hotkey-refresh-button" aria-label="Refresh Commands" title="Refresh commands"><!></button></div>',1);function gd(t,e){en(e,!0);let n=De(e,"inputHTML",15),i=De(e,"searchCommandsCount",11,0),s=De(e,"searchHotkeysCount",11,0),r=De(e,"keyboardListenerIsActive",15,!1),o=De(e,"selectedGroup",15,""),l=De(e,"onSearch",11,()=>{}),c=De(e,"search",15,"");const u=e.plugin.settingsManager,d=e.plugin.commandsManager,f=e.plugin.groupManager,m={StrictModifierMatch:"Strict modifiers filtration",ViewWOhotkeys:"Only with hotkeys",OnlyCustom:"Only custom hotkeys",OnlyDuplicates:"Only duplicates",FeaturedFirst:"Featured first",HighlightCustom:"Highlight custom keys",HighlightDuplicates:"Highlight duplicates",HighlightBuiltIns:"Highlight built-in modules",DisplayIDs:"Display command IDs",ShowPluginBadges:"Show plugin badges",GroupByPlugin:"Group by plugin",DisplayGroupAssignment:"Show group assignment",DisplayInternalModules:"Display internal modules",DisplaySystemShortcuts:"Include system shortcuts"},y={StrictModifierMatch:"Match modifiers exactly. Example: Ctrl+K won't match Ctrl+Shift+K.",ViewWOhotkeys:"Show only commands that have at least one hotkey assigned.",OnlyCustom:"Show only commands that have at least one user-set hotkey.",OnlyDuplicates:"Show only commands where at least one hotkey is duplicated.",FeaturedFirst:"Pin featured commands to the top of results.",HighlightCustom:"Visually mark hotkeys customized by you.",HighlightDuplicates:"Highlight when the same hotkey is used by multiple commands.",HighlightBuiltIns:"Subtly mark built-in (internal) plugin groups in commands list.",DisplayIDs:"Show internal command IDs and allow searching by ID.",ShowPluginBadges:"Show a compact plugin label before each command (flat list).",GroupByPlugin:"Group commands by their plugin.",DisplayGroupAssignment:"Display which group a command belongs to.",DisplayInternalModules:"Include commands from Obsidian’s built-in modules (e.g., File Explorer).",DisplaySystemShortcuts:"List common OS/editor defaults like Copy/Paste, Undo/Redo, Zoom."},p=He(()=>(f.groups,u.settings.defaultFilterSettings,f.getGroupSettings(o())));gt(()=>{a(p),o()});const _=Tt("activeKeysStore");let w=F(!1),S=F(!1),A=F(!1),x=F(!1),L=He(()=>_),K=null,M=F(Be({search:"",activeKey:"",selectedGroup:"",modifiersSig:""}));function z(T,R){D.debug("SearchMenu setFilterSetting called",{selectedGroup:o(),setting:T,value:R}),f.updateGroupFilterSettings(o(),{[T]:R}),D.debug("SearchMenu after updateGroupFilterSettings",{selectedGroup:o(),persisted:f.getGroupSettings(o())}),te()}function te(){try{const T=En(a(L).activeModifiers),R={search:String(c()??""),activeKey:String(a(L).activeKey??""),selectedGroup:String(o()??""),modifiersSig:T.join("+")};if(R.search===a(M).search&&R.activeKey===a(M).activeKey&&R.selectedGroup===a(M).selectedGroup&&R.modifiersSig===a(M).modifiersSig)return;g(M,R,!0),l()(R.search,T,R.activeKey,R.selectedGroup)}catch{}}function se(){K&&clearTimeout(K);const T=Number(u.settings.searchDebounceMs??200);K=setTimeout(()=>{te()},Number.isNaN(T)?200:Math.max(0,Math.min(2e3,T)))}function N(T){const R=Ns(T);a(L).handleKeyClick(R),te()}gt(()=>{o(),te()});var J=md(),oe=Le(J);_o(oe,{get selectedGroup(){return o()},set selectedGroup(T){o(T)}});var U=k(oe,2);U.__keydown=[ra,w,A,r,c,L,te];var $=h(U);let re;var Ge=h($),b=h(Ge);Je(b,17,()=>a(L).sortedModifiers,It,(T,R)=>{var ke=td();ke.__click=[ed,N,R];var ie=h(ke);ee(C=>ae(ie,C),[()=>u.settings.useBakedKeyNames?Cr(a(R)):a(R)]),E(T,ke)});var O=k(b,2);{var j=T=>{var R=id();R.__click=[nd,L];var ke=h(R);ee(ie=>ae(ke,ie),[()=>u.settings.useBakedKeyNames?Ar(a(L).activeKey):a(L).getDisplayKey()]),E(T,R)};ve(O,T=>{a(L).activeKey&&T(j)})}var Y=k(Ge,2),Q=h(Y);Q.__keydown=[ra,w,A,r,c,L,te],Q.__input=se,$n(Q,T=>n(T),()=>n());var fe=k(Q,2),W=h(fe);W.__click=[Zu,r,n];var Ne=h(W);go(Ne,{size:16});var ze=k(W,2);ze.__click=[Yu,c,L,n];var X=h(ze);Ii(X,{size:16});var We=k($,2),et=h(We);et.__click=[sd,A];var Ue=h(et);Ac(Ue,{size:16});var ot=k(et,2);{var ne=T=>{var R=ud(),ke=h(R),ie=h(ke),C=h(ie);let G;C.__click=[rd,z,p];var q=h(C),pe=k(C,2),ye=h(pe),he=k(ye),v=h(he);Zn(v,{size:14});var P=k(ie,2),H=h(P);let B;H.__click=[ad,z,p];var me=h(H),ue=k(H,2),_e=h(ue),st=k(_e),Ye=h(st);Zn(Ye,{size:14});var tt=k(P,2),Ie=h(tt);let be;Ie.__click=[od,z,p];var Ae=h(Ie),Ee=k(Ie,2),xt=h(Ee),qt=k(xt),vt=h(qt);Zn(vt,{size:14});var _t=k(tt,2),Et=h(_t);let nn;Et.__click=[ld,z,p];var pt=h(Et),Ln=k(Et,2),Kn=h(Ln),Gt=k(Kn),hi=h(Gt);Zn(hi,{size:14});var nt=k(_t,2),ht=h(nt);let sn;ht.__click=[cd,z,p];var bt=h(ht),Rt=k(ht,2),Qt=h(Rt),mt=k(Qt),_n=h(mt);Zn(_n,{size:14}),ee((ce,de,$e,Ke,qe)=>{G=Ce(C,1,"checkbox-container",null,G,ce),Mt(q,a(p).StrictModifierMatch),ae(ye,`${m.StrictModifierMatch} `),le(he,"title",y.StrictModifierMatch),B=Ce(H,1,"checkbox-container",null,B,de),Mt(me,a(p).ViewWOhotkeys),ae(_e,`${m.ViewWOhotkeys} `),le(st,"title",y.ViewWOhotkeys),be=Ce(Ie,1,"checkbox-container",null,be,$e),Mt(Ae,a(p).OnlyCustom),ae(xt,`${m.OnlyCustom} `),le(qt,"title",y.OnlyCustom),nn=Ce(Et,1,"checkbox-container",null,nn,Ke),Mt(pt,a(p).OnlyDuplicates),ae(Kn,`${m.OnlyDuplicates} `),le(Gt,"title",y.OnlyDuplicates),sn=Ce(ht,1,"checkbox-container",null,sn,qe),Mt(bt,a(p).DisplaySystemShortcuts),ae(Qt,`${m.DisplaySystemShortcuts} `),le(mt,"title",y.DisplaySystemShortcuts)},[()=>({"is-enabled":a(p).StrictModifierMatch}),()=>({"is-enabled":a(p).ViewWOhotkeys}),()=>({"is-enabled":a(p).OnlyCustom}),()=>({"is-enabled":a(p).OnlyDuplicates}),()=>({"is-enabled":a(p).DisplaySystemShortcuts})]),Hs(3,ke,()=>ju),Hs(3,R,()=>sa),E(T,R)};ve(ot,T=>{a(A)&&T(ne)})}Pi(We,T=>St==null?void 0:St(T));var we=k(We,2),xe=h(we);xe.__click=[Xu,w,A];var Ze=k(xe,2);{var ut=T=>{var R=vd(),ke=h(R);Je(ke,21,()=>Object.values(Qu),It,(ie,C)=>{var G=fd(),q=h(G);let pe;q.__click=[dd,z,C,p];var ye=h(q),he=k(q,2),v=h(he),P=k(v),H=h(P);Zn(H,{size:14}),ee(B=>{pe=Ce(q,1,"checkbox-container",null,pe,B),Mt(ye,a(p)[a(C)]),le(ye,"id",`view-${a(C)}`),ae(v,`${(m[a(C)]||a(C))??""} `),le(P,"title",y[a(C)]||a(C))},[()=>({"is-enabled":a(p)[a(C)]})]),E(ie,G)}),Hs(3,R,()=>sa),E(T,R)};ve(Ze,T=>{a(w)&&T(ut)})}Pi(we,T=>St==null?void 0:St(T));var Se=k(we,2),Oe=h(Se);{var Fe=T=>{var R=pd(),ke=h(R),ie=h(ke),C=k(ke,6),G=h(C);ee(()=>{ae(ie,s()),ae(G,i())}),E(T,R)},it=T=>{var R=hd();E(T,R)};ve(Oe,T=>{i()!==0?T(Fe):T(it,!1)})}var Ve=k(Se,2);Ve.__click=[Ju,x,d];var je=h(Ve);Dc(je,{size:16}),ee((T,R)=>{re=Ce($,1,"search-wrapper",null,re,T),Ce(W,1,`keyboard-icon icon ${r()?"pulse":""}`),le(W,"aria-label",R),le(W,"aria-pressed",r()),le(W,"title",r()?"Deactivate key listener (Esc)":"Activate key listener"),Ce(et,1,ii(a(A)?"is-active":"")),le(et,"aria-pressed",a(A)),Ce(xe,1,ii(a(w)?"is-active":"")),le(xe,"aria-pressed",a(w)),Ce(Ve,1,ii(a(x)?"animation-is-active":""))},[()=>({"is-focused":a(S)}),()=>r()?"Press Esc to deactivate key listener":`Press ${En(["Mod"])[0]}+F or long press to activate key listener`]),Qe("focus",Q,()=>g(S,!0)),Qe("blur",Q,()=>g(S,!1)),di(Q,c),Qe("click_outside",We,()=>g(A,!1)),Qe("click_outside",we,()=>g(w,!1)),E(t,J),tn()}yn(["keydown","click","input"]);var yd=(t,e)=>g(e,""),_d=I('<button class="kb-clear svelte-bos8et" title="Clear" aria-label="Clear search"><!></button>'),bd=(t,e,n)=>e(String(a(n).id)),kd=I('<label class="kb-row svelte-bos8et"><input type="checkbox"/> <span> </span></label>'),wd=(t,e)=>t.key==="Enter"&&e(),Md=I('<div role="dialog" aria-label="Add to group"><div class="kb-popover-header svelte-bos8et"><div class="kb-input-wrap svelte-bos8et"><input type="text" placeholder="Search groups..." class="kb-input svelte-bos8et"/> <!></div></div> <div class="kb-popover-body svelte-bos8et"></div> <div class="kb-popover-footer svelte-bos8et"><input type="text" placeholder="New group name" class="kb-input svelte-bos8et"/> <button class="kb-btn svelte-bos8et">Create & Add</button></div></div>');function aa(t,e){en(e,!0);let n=De(e,"onClose",11,()=>{});const s=Tt("keyboard-analyzer-plugin").groupManager;let r=F(""),o=F(""),l=F(!1),c=F(0),u=null;function d(){const N=a(r).trim().toLowerCase(),J=s.getGroups();return N?J.filter(oe=>oe.name.toLowerCase().includes(N)):J}function f(N){s.isCommandInGroup(N,e.commandId)?s.removeCommandFromGroup(N,e.commandId):s.addCommandToGroup(N,e.commandId)}function m(){const N=a(o).trim();if(!N)return;const J=s.createGroup(N);J&&s.addCommandToGroup(String(J),e.commandId),g(o,""),g(r,"")}function y(){try{const N=u;if(!N)return;const oe=(N.parentElement||N).getBoundingClientRect(),U=window.innerHeight||document.documentElement.clientHeight,$=window.innerWidth||document.documentElement.clientWidth,re=U-oe.bottom,Ge=oe.top;g(l,re<260&&Ge>re,!0);const b=oe.left+0+a(c),O=b+((u==null?void 0:u.offsetWidth)||260);let j=0;O>$&&(j-=O-$+8),b+j<0&&(j+=-(b+j)+8),g(c,a(c)+j)}catch{}}let p=null;const _=()=>y();Is(()=>{y(),window.addEventListener("resize",y),document.addEventListener("scroll",_,!0),"ResizeObserver"in window&&u&&(p=new ResizeObserver(()=>y()),p.observe(u))}),ro(()=>{window.removeEventListener("resize",y),document.removeEventListener("scroll",_,!0),p==null||p.disconnect(),p=null});var w=Md(),S=h(w),A=h(S),x=h(A),L=k(x,2);{var K=N=>{var J=_d();J.__click=[yd,r];var oe=h(J);Ii(oe,{size:14}),E(N,J)};ve(L,N=>{a(r)&&N(K)})}var M=k(S,2);Je(M,21,d,N=>N.id,(N,J)=>{var oe=kd(),U=h(oe);U.__change=[bd,f,J];var $=k(U,2),re=h($);ee(Ge=>{Mt(U,Ge),ae(re,a(J).name)},[()=>s.isCommandInGroup(String(a(J).id),e.commandId)]),E(N,oe)});var z=k(M,2),te=h(z);te.__keydown=[wd,m];var se=k(te,2);se.__click=m,Pi(w,N=>St==null?void 0:St(N)),$n(w,N=>u=N,()=>u),ee(()=>{Ce(w,1,`kb-popover ${a(l)?"is-above":"is-below"}`,"svelte-bos8et"),Rn(w,`transform: translateX(${a(c)??""}px);`)}),Qe("click_outside",w,function(...N){var J;(J=n())==null||J.apply(this,N)}),di(x,()=>a(r),N=>g(r,N)),di(te,()=>a(o),N=>g(o,N)),E(t,w),tn()}yn(["click","change","keydown"]);function Sd(t,e,n){const i=new Set;for(const s of a(e))i.add(s.pluginName);g(n,i,!0)}function Cd(t,e){g(e,new Set,!0)}var Ad=I(`<div class="empty-title svelte-1kx0bvp">This group is empty</div> <div class="empty-subtitle svelte-1kx0bvp">Add commands from the “All Commands” list using the folder icon, or
            manage groups.</div>`,1),xd=I('<div class="empty-title svelte-1kx0bvp">No matching commands</div> <div class="empty-subtitle svelte-1kx0bvp">Try a different term or adjust filters.</div>',1),Ed=I('<ul class="empty-hints svelte-1kx0bvp"><li>Press Esc to clear keys</li> <li>Use the Filter button to tweak results</li> <li>Include built-ins if hidden</li></ul>'),Dd=I('<div class="empty-state svelte-1kx0bvp" role="status" aria-live="polite"><div class="empty-icon svelte-1kx0bvp"><!></div> <!> <!></div>'),Ld=(t,e,n)=>e(a(n).pluginName),Kd=(t,e,n)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(a(n).pluginName)),Pd=I('<span class="plugin-badge built-in">built-in</span>'),Gd=(t,e,n)=>e(a(n).id),Od=(t,e,n)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(a(n).id)),Fd=(t,e,n)=>e(t,a(n).id),Id=(t,e,n)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(t,a(n).id)),Td=I('<span class="kb-popover-anchor svelte-1kx0bvp"><!></span>'),Nd=I("<small> </small>"),zd=(t,e,n,i)=>e(a(n),a(i)),Vd=(t,e,n,i)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(a(n),a(i))),$d=I('<span role="button" tabindex="0"> </span>'),qd=I('<div><div class="setting-item-info"><div class="setting-item-name"><span class="command-name"> </span> <div class="action-icons svelte-1kx0bvp"><div class="star-icon icon" role="button" tabindex="0"><!></div> <div class="folder-plus-icon icon svelte-1kx0bvp" title="Add to group" role="button" tabindex="0"><!></div> <!></div></div> <!></div> <div class="kbanalizer-setting-item-control setting-item-control"><div class="setting-command-hotkeys"></div></div></div>'),Rd=I('<div class="plugin-group-body"></div>'),Hd=I('<div class="plugin-group"><div role="button" tabindex="0"><span><!></span> <span class="plugin-name"> </span> <!> <span class="plugin-meta u-muted"> </span></div> <!></div>'),Bd=I('<div class="plugin-groups-toolbar"><button class="btn-filter">Collapse all</button> <button class="btn-filter">Expand all</button></div> <!>',1),Wd=(t,e,n)=>e(a(n).pluginName),Ud=I("<button> </button>"),jd=(t,e,n)=>e(a(n).id),Qd=(t,e,n)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(a(n).id)),Yd=(t,e,n)=>e(t,a(n).id),Xd=(t,e,n)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(t,a(n).id)),Zd=I('<span class="kb-popover-anchor svelte-1kx0bvp"><!></span>'),Jd=I("<small> </small>"),ef=(t,e,n,i)=>e(a(n),a(i)),tf=(t,e,n,i)=>(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),e(a(n),a(i))),nf=I('<span role="button" tabindex="0"> </span>'),sf=I('<div><div class="setting-item-info"><div class="setting-item-name"><!> <span class="command-name"> </span> <div class="action-icons svelte-1kx0bvp"><div class="star-icon icon" role="button" tabindex="0"><!></div> <div class="folder-plus-icon icon svelte-1kx0bvp" title="Add to group" role="button" tabindex="0"><!></div> <!></div></div> <!></div> <div class="kbanalizer-setting-item-control setting-item-control"><div class="setting-command-hotkeys"></div></div></div>'),rf=I('<div id="hotkeys-wrapper" class="markdown-preview-sizer markdown-preview-section hotkey-settings-container"><div class="hotkey-list-container"><!></div></div>');function af(t,e){en(e,!0);let n=De(e,"filteredCommands",27,()=>Be([])),i=De(e,"selectedGroup",11,"all");const s=Tt("keyboard-analyzer-plugin"),r=s.settingsManager,o=s.groupManager,l=s.commandsManager,c=s.hotkeyManager,u=Tt("visualKeyboardManager"),d=Tt("activeKeysStore");let f=He(()=>(o.groups,o.getGroupSettings(i()))),m=He(()=>{var O;if(!i()||i()==="all")return!1;const b=o.getGroup(i());return!b||(((O=b.commandIds)==null?void 0:O.length)||0)===0});function y(b){return r.settings.useBakedKeyNames?Ms(b):c.renderHotkey(b)}let p=He(()=>new Set(r.settings.featuredCommandIDs||[]));function _(b,O){var Ne,ze;const j=(O||"").trim(),Y=b||"";if(!j)return Y;const Q=Y.toLowerCase(),fe=`${j.toLowerCase()}: `;return(((Ne=a(f))==null?void 0:Ne.GroupByPlugin)||((ze=a(f))==null?void 0:ze.ShowPluginBadges))&&Q.startsWith(fe)?Y.slice(fe.length).trim():Y}function w(b){var O;(O=e.onStarClick)==null||O.call(e,b)}function S(b){var O;(O=e.onPluginNameClick)==null||O.call(e,b)}function A(b,O){var j;O&&d.devSetLastCommand(O),(j=e.onDuplicateHotkeyClick)==null||j.call(e,b)}function x(b){const O=En(b.modifiers);u.updateVisualState(d.ActiveKey,d.ActiveModifiers),u.previewHoverState(b.key,O)}function L(){u.updateVisualState(d.ActiveKey,d.ActiveModifiers)}const K=b=>b.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"");let M=F(Be(new Set));function z(b){const O=new Set(a(M));O.has(b)?O.delete(b):O.add(b),g(M,O,!0)}function te(b){return a(M).has(b)}let se=F(null);function N(b,O){b.stopPropagation(),g(se,a(se)===O?null:O,!0)}let J=He(()=>{a(f);const b=new Map;for(const j of n()){const Y=j.pluginName||"Unknown",Q=b.get(Y)||[];Q.push(j),b.set(Y,Q)}const O=Array.from(b.entries()).map(([j,Y])=>{var fe;(fe=a(f))!=null&&fe.FeaturedFirst&&(Y=[...Y].sort((W,Ne)=>{const ze=l.featuredCommandIds.has(W.id),X=l.featuredCommandIds.has(Ne.id);return ze&&!X?-1:!ze&&X?1:0}));const Q=Y.some(W=>W.isInternalModule);return{pluginName:j,commands:Y,isBuiltIn:Q}});return O.sort((j,Y)=>j.pluginName.localeCompare(Y.pluginName)),O});var oe=rf(),U=h(oe),$=h(U);{var re=b=>{var O=Dd(),j=h(O),Y=h(j);Lc(Y,{size:28});var Q=k(j,2);{var fe=X=>{var We=Ad();E(X,We)},W=X=>{var We=xd();E(X,We)};ve(Q,X=>{a(m)?X(fe):X(W,!1)})}var Ne=k(Q,2);{var ze=X=>{var We=Ed();E(X,We)};ve(Ne,X=>{a(m)||X(ze)})}E(b,O)},Ge=b=>{var O=Xe(),j=Le(O);{var Y=fe=>{var W=Bd(),Ne=Le(W),ze=h(Ne);ze.__click=[Sd,J,M];var X=k(ze,2);X.__click=[Cd,M];var We=k(Ne,2);Je(We,17,()=>a(J),et=>et.pluginName,(et,Ue)=>{var ot=Hd(),ne=h(ot);ne.__click=[Ld,z,Ue],ne.__keydown=[Kd,z,Ue];var we=h(ne),xe=h(we);Sc(xe,{size:14});var Ze=k(we,2),ut=h(Ze),Se=k(Ze,2);{var Oe=T=>{var R=Pd();E(T,R)};ve(Se,T=>{a(Ue).isBuiltIn&&T(Oe)})}var Fe=k(Se,2),it=h(Fe),Ve=k(ne,2);{var je=T=>{var R=Rd();Je(R,21,()=>a(Ue).commands,ke=>ke.id,(ke,ie)=>{var C=qd();let G;var q=h(C),pe=h(q),ye=h(pe),he=h(ye),v=k(ye,2),P=h(v);P.__click=[Gd,w,ie],P.__keydown=[Od,w,ie];var H=h(P);ia(H,{size:16});var B=k(P,2);B.__click=[Fd,N,ie],B.__keydown=[Id,N,ie];var me=h(B);na(me,{size:16});var ue=k(B,2);{var _e=be=>{var Ae=Td(),Ee=h(Ae);aa(Ee,{get commandId(){return a(ie).id},onClose:()=>g(se,null)}),E(be,Ae)};ve(ue,be=>{a(se)===a(ie).id&&be(_e)})}var st=k(pe,2);{var Ye=be=>{var Ae=Nd(),Ee=h(Ae);ee(()=>ae(Ee,a(ie).id)),E(be,Ae)};ve(st,be=>{var Ae;(Ae=a(f))!=null&&Ae.DisplayIDs&&be(Ye)})}var tt=k(q,2),Ie=h(tt);Je(Ie,21,()=>a(ie).hotkeys,It,(be,Ae)=>{var Ee=$d();let xt;Ee.__click=[zd,A,Ae,ie],Ee.__keydown=[Vd,A,Ae,ie];var qt=h(Ee);ee((vt,_t)=>{xt=Ce(Ee,1,"kbanalizer-setting-hotkey setting-hotkey",null,xt,vt),ae(qt,_t)},[()=>{var vt,_t;return{"is-duplicate":c.isHotkeyDuplicate(a(ie).id,a(Ae))&&((vt=a(f))==null?void 0:vt.HighlightDuplicates),"is-customized":a(Ae).isCustom&&((_t=a(f))==null?void 0:_t.HighlightCustom)}},()=>y(a(Ae))]),Qe("mouseenter",Ee,()=>x(a(Ae))),Qe("mouseleave",Ee,L),E(be,Ee)}),ee((be,Ae)=>{G=Ce(C,1,"kbanalizer-setting-item setting-item compact",null,G,be),ae(he,Ae)},[()=>({"is-starred":a(p).has(a(ie).id),"show-actions":a(se)===a(ie).id}),()=>_(a(ie).name,a(ie).pluginName)]),E(ke,C)}),ee(ke=>le(R,"id",ke),[()=>`group-${K(a(Ue).pluginName)}`]),E(T,R)};ve(Ve,T=>{te(a(Ue).pluginName)||T(je)})}ee((T,R,ke)=>{var ie;Ce(ne,1,`plugin-group-header ${a(Ue).isBuiltIn&&((ie=a(f))!=null&&ie.HighlightBuiltIns)?"is-builtin":""}`),le(ne,"aria-expanded",T),le(ne,"aria-controls",R),Ce(we,1,`chevron ${ke??""}`),ae(ut,a(Ue).pluginName),ae(it,`${a(Ue).commands.length??""} cmds`)},[()=>!te(a(Ue).pluginName),()=>`group-${K(a(Ue).pluginName)}`,()=>te(a(Ue).pluginName)?"is-collapsed":""]),E(et,ot)}),E(fe,W)},Q=fe=>{var W=Xe(),Ne=Le(W);Je(Ne,17,n,ze=>ze.id,(ze,X)=>{var We=sf();let et;var Ue=h(We),ot=h(Ue),ne=h(ot);{var we=C=>{var G=Ud();G.__click=[Wd,S,X];var q=h(G);ee(()=>{var pe;Ce(G,1,`suggestion-prefix ${a(X).isInternalModule&&((pe=a(f))!=null&&pe.HighlightBuiltIns)?"is-builtin":""}`,"svelte-1kx0bvp"),ae(q,a(X).pluginName)}),E(C,G)};ve(ne,C=>{var G;(G=a(f))!=null&&G.ShowPluginBadges&&C(we)})}var xe=k(ne,2),Ze=h(xe),ut=k(xe,2),Se=h(ut);Se.__click=[jd,w,X],Se.__keydown=[Qd,w,X];var Oe=h(Se);ia(Oe,{size:16});var Fe=k(Se,2);Fe.__click=[Yd,N,X],Fe.__keydown=[Xd,N,X];var it=h(Fe);na(it,{size:16});var Ve=k(Fe,2);{var je=C=>{var G=Zd(),q=h(G);aa(q,{get commandId(){return a(X).id},onClose:()=>g(se,null)}),E(C,G)};ve(Ve,C=>{a(se)===a(X).id&&C(je)})}var T=k(ot,2);{var R=C=>{var G=Jd(),q=h(G);ee(()=>ae(q,a(X).id)),E(C,G)};ve(T,C=>{var G;(G=a(f))!=null&&G.DisplayIDs&&C(R)})}var ke=k(Ue,2),ie=h(ke);Je(ie,21,()=>a(X).hotkeys,It,(C,G)=>{var q=nf();let pe;q.__click=[ef,A,G,X],q.__keydown=[tf,A,G,X];var ye=h(q);ee((he,v)=>{pe=Ce(q,1,"kbanalizer-setting-hotkey setting-hotkey",null,pe,he),ae(ye,v)},[()=>{var he,v;return{"is-duplicate":c.isHotkeyDuplicate(a(X).id,a(G))&&((he=a(f))==null?void 0:he.HighlightDuplicates),"is-customized":a(G).isCustom&&((v=a(f))==null?void 0:v.HighlightCustom)}},()=>y(a(G))]),Qe("mouseenter",q,()=>x(a(G))),Qe("mouseleave",q,L),E(C,q)}),ee((C,G)=>{et=Ce(We,1,"kbanalizer-setting-item setting-item",null,et,C),ae(Ze,G)},[()=>({"is-starred":a(p).has(a(X).id),"show-actions":a(se)===a(X).id}),()=>_(a(X).name,a(X).pluginName)]),E(ze,We)}),E(fe,W)};ve(j,fe=>{var W;(W=a(f))!=null&&W.GroupByPlugin?fe(Y):fe(Q,!1)},!0)}E(b,O)};ve($,b=>{n().length===0?b(re):b(Ge,!1)})}E(t,oe),tn()}yn(["click","keydown"]);var of=I('<div id="keyboard-component"><div id="keyboard-preview-view"><!></div> <div class="shortcuts-wrapper"><!> <!></div></div>');function lf(t,e){en(e,!0);function n(b){return(b.metaKey||b.ctrlKey)&&!b.altKey&&!b.shiftKey&&b.key.toLowerCase()==="f"}const i=e.plugin.commandsManager,s=new Mr,r=new Sr(e.plugin.app,s),o=e.plugin.groupManager;wi("keyboard-analyzer-plugin",e.plugin),wi("activeKeysStore",r),wi("visualKeyboardManager",s),wi("isPhysicalListenerActive",()=>a(p));const l=b=>{var Q,fe,W;d==null||d.contains(b.target),d&&d.matches(":focus-within");const O=(()=>{var Ne,ze;try{const X=(Ne=e.plugin.app.workspace.activeLeaf)==null?void 0:Ne.view;return!!(X&&typeof X.getViewType=="function"&&((ze=X.getViewType)==null?void 0:ze.call(X))===Wt)}catch{return!1}})();if(n(b)&&O){b.preventDefault(),b.stopPropagation(),document.activeElement!==a(y)?((Q=a(y))==null||Q.focus(),D.debug("[keys] Mod+F: focus search")):(g(p,!a(p)),D.debug("[keys] Mod+F: toggle listener",{to:a(p)}));return}if(b.key==="Escape"&&O){b.preventDefault(),b.stopPropagation(),a(p)?(g(p,!1),(fe=a(y))==null||fe.focus(),D.debug("[keys] Esc: disable listener and focus search")):document.activeElement===a(y)&&((W=document.activeElement)==null||W.blur(),D.debug("[keys] Esc: blur search input"));return}const Y=Yr()==="global"?_s():O;if(!a(p)||!Y){b.key!=="Backspace"&&D.debug("[keys] ignored keydown (listener off)");return}r.recordPhysicalRaw(b),D.debug("[keys] keydown",{key:b.key,code:b.code}),r.handlePhysicalKeyDown(b,{inActiveView:O}),D.debug("[keys] state after keydown",r.state)},c=b=>{const j=Yr()==="global"?_s():(()=>{var Q,fe;try{const W=(Q=e.plugin.app.workspace.activeLeaf)==null?void 0:Q.view;return!!(W&&typeof W.getViewType=="function"&&((fe=W.getViewType)==null?void 0:fe.call(W))===Wt)}catch{return!1}})();if(!a(p)||!j){D.debug("[keys] ignored keyup (listener off)");return}const Y=(()=>{var Q,fe;try{const W=(Q=e.plugin.app.workspace.activeLeaf)==null?void 0:Q.view;return!!(W&&typeof W.getViewType=="function"&&((fe=W.getViewType)==null?void 0:fe.call(W))===Wt)}catch{return!1}})();D.debug("[keys] keyup",{key:b.key,code:b.code}),r.handlePhysicalKeyUp(b,{inActiveView:Y}),D.debug("[keys] state after keyup",r.state)};Is(()=>{const b=window,O=b.__kb_analyzer_keys_down,j=b.__kb_analyzer_keys_up;return O&&window.removeEventListener("keydown",O),j&&window.removeEventListener("keyup",j),window.addEventListener("keydown",l,!0),window.addEventListener("keyup",c,!0),b.__kb_analyzer_keys_down=l,b.__kb_analyzer_keys_up=c,D.debug("[keys] global listeners attached"),()=>{window.removeEventListener("keydown",l,!0),window.removeEventListener("keyup",c,!0),b.__kb_analyzer_keys_down===l&&(b.__kb_analyzer_keys_down=void 0),b.__kb_analyzer_keys_up===c&&(b.__kb_analyzer_keys_up=void 0)}});let u=F(0),d=null,f=F("desktop"),m=F(""),y=F(void 0),p=F(!1),_=F(Be(e.plugin.settingsManager.settings.lastOpenedGroupId||Lt.All));gt(()=>{const b=a(_)||Lt.All;queueMicrotask(()=>{var O;try{const j=o.getGroupBehavior(b);if(b===Lt.All){j==="default"&&o.applyDefaultsToAllFilters();return}const Y=o.getGroup(b);if(!Y){D.warn("[groups] selected group not found; skipping behavior apply",{gid:b});return}j==="default"?o.applyDefaultsToGroupFilters(b):(O=Y==null?void 0:Y.lastUsedState)!=null&&O.filters?o.applyDynamicLastUsedToGroupFilters(b):o.applyDefaultsToGroupFilters(b)}catch(j){D.error("[groups] error applying on-open behavior",{err:j,selectedGroupID:a(_)})}})}),gt(()=>{e.plugin.settingsManager.settings.defaultFilterSettings,g(S,i.filterCommands(a(m),r.ActiveModifiers,r.ActiveKey,a(_)),!0)});let w=He(()=>{o.groups;const b=a(_),O=o.getGroupSettings(b);return!!(O!=null&&O.StrictModifierMatch)}),S=F(Be([])),A=He(()=>a(S).length),x=He(()=>a(S).reduce((b,O)=>b+O.hotkeys.length,0));gt(()=>{g(S,i.filterCommands(a(m),r.ActiveModifiers,r.ActiveKey,a(_)),!0)});let L=F(Be(e.plugin.settingsManager.getSetting("lastOpenedGroupId")||Lt.All)),K=null;gt(()=>{const b=a(_);b&&b!==a(L)&&(K&&clearTimeout(K),K=setTimeout(()=>{e.plugin.settingsManager.updateSettings({lastOpenedGroupId:b}),g(L,b,!0)},200))}),gt(()=>{var b;(b=a(y))==null||b.focus()}),gt(()=>{M(a(u))}),gt(()=>{s.updateVisualState(r.ActiveKey,r.ActiveModifiers)});function M(b){b>=1400?g(f,"xxl"):b>=1200?g(f,"xl"):b>=992?g(f,"lg"):b>=768?g(f,"md"):b>=576?g(f,"sm"):g(f,"xs")}function z(b,O,j,Y){g(S,i.filterCommands(b,O,j,Y),!0)}function te(b){var O;a(m)?a(m).startsWith(b)?g(m,a(m).replace(b,""),!0):g(m,b+a(m)):((O=a(y))==null||O.focus(),g(m,b,!0))}function se(b){const{modifiers:O,key:j}=b,Y=En(O);r.ActiveModifiers.every(Q=>Y.includes(Q))&&r.ActiveKey.toLowerCase()===j.toLowerCase()?r.reset():(r.ActiveModifiers=Y,r.ActiveKey=j,g(m,""))}function N(b){i.toggleFeaturedCommand(b)}var J=of(),oe=h(J),U=h(oe);Zc(U,{get visibleCommands(){return a(S)},get strictModifierMatch(){return a(w)},get selectedGroupID(){return a(_)}});var $=k(oe,2),re=h($);gd(re,{get searchCommandsCount(){return a(A)},get searchHotkeysCount(){return a(x)},get plugin(){return e.plugin},onSearch:z,get inputHTML(){return a(y)},set inputHTML(b){g(y,b,!0)},get search(){return a(m)},set search(b){g(m,b,!0)},get keyboardListenerIsActive(){return a(p)},set keyboardListenerIsActive(b){g(p,b,!0)},get selectedGroup(){return a(_)},set selectedGroup(b){g(_,b,!0)}});var Ge=k(re,2);af(Ge,{onStarClick:N,onDuplicateHotkeyClick:se,onPluginNameClick:te,get filteredCommands(){return a(S)},set filteredCommands(b){g(S,b,!0)},get selectedGroup(){return a(_)},set selectedGroup(b){g(_,b,!0)}}),$n(J,b=>d=b,()=>d),ee(()=>Ce(J,1,ii(a(f)))),Zl(J,"offsetWidth",b=>g(u,b)),E(t,J),tn()}class Us extends rt.ItemView{constructor(n,i){super(n);Z(this,"plugin");Z(this,"component",null);Z(this,"activeKeysStore");Z(this,"visualKeyboardManager");Z(this,"navigation",!0);this.plugin=i,this.visualKeyboardManager=new Mr,this.activeKeysStore=new Sr(this.app,this.visualKeyboardManager)}async onload(){super.onload()}async onOpen(){await this.refresh()}async refresh(){await this.plugin.hotkeyManager.initialize(),this.plugin.commandsManager.initialize(),await this.draw()}getViewType(){return Wt}getDisplayText(){return"Keyboard Shortcuts Analyzer"}async draw(){const{contentEl:n}=this;n.empty(),n.setAttribute("id","KB-view"),n.style.padding="0",n.style.overflowX="hidden",this.component=ja(lf,{target:n,props:{plugin:this.plugin,view:this,activeKeysStore:this.activeKeysStore}})}onClose(){return this.component&&(Qa(this.component),this.component=null),Promise.resolve()}}function cf(t,e,n,i,s,r,o){var l,c,u;a(e).trim()===""?((c=(l=a(n))==null?void 0:l.reset)==null||c.call(l),g(i,""),g(s,[],!0)):g(e,""),r(),(u=a(o))==null||u.focus()}function uf(t,e,n){var i;g(e,!a(e)),(i=a(n))==null||i.focus()}function df(t,e){e()}function ff(t,e,n,i,s,r,o){var c,u,d,f,m;if((t.key==="f"||t.key==="F"||t.code==="KeyF")&&(t.metaKey||t.ctrlKey)){t.preventDefault(),t.stopPropagation(),(c=t.stopImmediatePropagation)==null||c.call(t),g(e,!a(e));return}if(a(e)&&t.key==="Escape"){t.preventDefault(),t.stopPropagation(),g(e,!1);return}if(t.key==="Backspace"&&!a(e)&&String(a(n)||"").trim()===""){if(a(i))(d=(u=a(s))==null?void 0:u.clearActiveKey)==null||d.call(u),g(i,"");else if((((f=a(r))==null?void 0:f.length)||0)>0){const y=[...((m=a(s))==null?void 0:m.sortedModifiers)||[]];y.pop(),a(s).ActiveModifiers=y,g(r,y,!0)}o(),t.preventDefault(),t.stopPropagation()}}function vf(t,e){const n=t.ctrlKey||t.metaKey,i=t.altKey;return e(n&&i?"split":!!n)}var pf=(t,e)=>g(e,!a(e)),hf=(t,e)=>g(e,!a(e)),mf=(t,e,n)=>{g(e,!a(e));try{n.updateSettings({quickViewAutoRun:a(e)})}catch(i){D.error("[qv] persist quickViewAutoRun failed",i)}},gf=(t,e,n)=>e(a(n).key,t.target.checked),yf=I('<label class="qv-filter svelte-19pvtfz"><input type="checkbox"/> </label>'),_f=I('<div class="qv-filters svelte-19pvtfz"></div>'),bf=(t,e,n,i,s,r)=>{var o,l,c,u;try{(l=(o=a(e))==null?void 0:o.handleKeyClick)==null||l.call(o,Ns(a(n))),g(i,((c=a(e))==null?void 0:c.sortedModifiers)||[],!0),g(s,((u=a(e))==null?void 0:u.ActiveKey)||"",!0)}catch{}r()},kf=(t,e,n,i,s,r)=>{var o,l,c,u;if(t.key==="Enter"||t.key===" "){t.preventDefault();try{(l=(o=a(e))==null?void 0:o.handleKeyClick)==null||l.call(o,Ns(a(n))),g(i,((c=a(e))==null?void 0:c.sortedModifiers)||[],!0),g(s,((u=a(e))==null?void 0:u.ActiveKey)||"",!0)}catch{}r()}},wf=I('<kbd class="modifier setting-hotkey svelte-19pvtfz" role="button" tabindex="0"> </kbd>'),Mf=(t,e,n,i,s)=>{var r,o,l,c;try{(o=(r=a(e))==null?void 0:r.handleKeyClick)==null||o.call(r,a(n))}catch{}g(i,((l=a(e))==null?void 0:l.sortedModifiers)||[],!0),g(n,((c=a(e))==null?void 0:c.ActiveKey)||"",!0),s()},Sf=(t,e,n,i,s)=>{var r,o,l,c;if(t.key==="Enter"||t.key===" "){t.preventDefault();try{(o=(r=a(e))==null?void 0:r.handleKeyClick)==null||o.call(r,a(n))}catch{}g(i,((l=a(e))==null?void 0:l.sortedModifiers)||[],!0),g(n,((c=a(e))==null?void 0:c.ActiveKey)||"",!0),s()}},Cf=I('<kbd class="modifier setting-hotkey svelte-19pvtfz" role="button" tabindex="0"> </kbd>'),Af=I('<div class="qv-empty">No matching commands</div>'),xf=I('<span class="hk svelte-19pvtfz"> </span>'),Ef=I('<div role="option" tabindex="0"><div class="qv-name svelte-19pvtfz"> </div> <div class="qv-hotkeys svelte-19pvtfz"></div></div>'),Df=I('<div role="dialog" tabindex="-1" aria-label="Quick Commands"><div class="qv-corner svelte-19pvtfz" title="Resize"></div> <div class="qv-left svelte-19pvtfz" title="Resize width"></div> <header class="qv-header svelte-19pvtfz"><div class="qv-row-1 svelte-19pvtfz"><div class="qv-group-wrapper svelte-19pvtfz"><!></div> <div class="spacer svelte-19pvtfz"></div> <div class="qv-actions svelte-19pvtfz"><button class="qv-btn svelte-19pvtfz">Filters</button> <div class="sep svelte-19pvtfz"></div> <button>Pin</button> <div class="sep svelte-19pvtfz"></div> <button class="qv-btn svelte-19pvtfz" title="Open view (Ctrl=new, Ctrl+Alt=split)">Open</button> <div class="sep svelte-19pvtfz"></div> <button>Run</button></div></div> <!> <div role="group"><div class="modifiers-wrapper svelte-19pvtfz"><!> <!></div> <div class="hotkey-search-container svelte-19pvtfz"><input type="text" placeholder="Filter..." class="svelte-19pvtfz"/> <div class="meta-search-wrapper svelte-19pvtfz"><button><!></button> <button class="clear-icon icon svelte-19pvtfz" aria-label="Clear text or reset keys" title="Clear text or reset keys"><!></button></div></div></div></header> <div class="qv-list svelte-19pvtfz" role="listbox" aria-label="Command results"><!></div></div>');function Lf(t,e){en(e,!0);let n=De(e,"anchorEl",3,null),i=De(e,"onClose",3,()=>{}),s=De(e,"listenToggle",3,0),r=De(e,"armTriggers",7,null);const o=e.plugin.commandsManager,l=e.plugin.settingsManager,c=e.plugin.groupManager;D.debug("[qv] script:init");try{typeof window<"u"&&(window.addEventListener("error",v=>{try{const P={message:(v&&v.message)??void 0,filename:(v&&v.filename)??void 0,lineno:(v&&v.lineno)??void 0,colno:(v&&v.colno)??void 0,error:(v&&v.error)??void 0};D.error("[qv] early window error",P)}catch{}},{once:!0}),window.addEventListener("unhandledrejection",v=>{try{D.error("[qv] early unhandledrejection",v&&v.reason)}catch{}},{once:!0}))}catch{}try{wi("keyboard-analyzer-plugin",e.plugin),D.debug("[qv] init context provided")}catch(v){D.error("[qv] context set failed",v)}let u=F(""),d=F(!1),f=F("all");try{const v=l.getSetting("lastOpenedGroupId")||"all";g(f,v,!0)}catch(v){D.error("[qv] read lastOpenedGroupId failed",v)}let m=F(null),y=F(null),p=F(""),_=F(Be([])),w=F(Be([])),S=F(0),A=F(null),x=F(null),L=F(null),K=F(!1),M=F(Be({top:0,left:0,width:380,height:360})),z=F(0),te=!1,se=0,N=F(!0),J=F(!1),oe=null,U=F(!1);function $(){const v=o.filterCommands(a(u),En(a(_)),a(p),a(f));g(w,v.slice(0,200),!0),g(S,Math.min(a(S),Math.max(0,a(w).length-1)),!0)}let re=!1;function Ge(){re||(re=!0,requestAnimationFrame(()=>{re=!1;try{b()}catch(v){D.error("[qv] recomputePosition:raf error",v)}}))}function b(){try{if(D.debug("[qv] recomputePosition:start"),!a(L)||!n()||te)return;const v=n().getBoundingClientRect(),P=window.innerHeight||document.documentElement.clientHeight,H=window.innerWidth||document.documentElement.clientWidth,B=6,me=v.bottom+B,ue=Math.floor(P*.6),_e=Math.min(ue,Math.max(240,a(M).height)),Ye=!(me+_e<=P),tt=Ye?Math.max(8,v.top-B-_e):Math.min(P-_e-8,me);let Ie=a(z)?v.left+a(z):v.left,be=a(M).width||a(L).offsetWidth||360;const Ae=Math.max(430,Math.floor(H*.92));be>Ae&&(be=Ae),Ie+be>H-8&&(Ie=Math.max(8,H-be-8)),Ie<8&&(Ie=8);const Ee={...a(M),top:tt,left:Ie,width:be};Ee.top!==a(M).top||Ee.left!==a(M).left||Ee.width!==a(M).width||Ye!==a(K)?queueMicrotask(()=>{g(K,Ye),g(M,Ee,!0),g(z,Ie-v.left),D.debug("[qv] recomputePosition:end",{coords:a(M)})}):(g(z,Ie-v.left),D.debug("[qv] recomputePosition:end",{coords:a(M)}))}catch(v){D.error("[qv] recomputePosition:error",v)}}let O=!1,j=0,Y=0,Q=0,fe=0,W=0,Ne=0;function ze(v){var P,H;v.preventDefault(),v.stopPropagation(),(H=(P=v.target).setPointerCapture)==null||H.call(P,v.pointerId),O=!0,te=!0,j=v.clientX,Y=v.clientY,Q=a(M).left,fe=a(M).top,W=a(M).width,Ne=a(M).height,se=Date.now()+250,D.debug("[qv] resize:corner:down",{startLeft:Q,startTop:fe,startW:W,startH:Ne}),window.addEventListener("pointermove",X,!0),window.addEventListener("pointerup",We,!0)}function X(v){if(!O)return;const P=v.clientX-j,H=v.clientY-Y;let B=Q+P,me=fe+H,ue=W-P,_e=Ne-H;const st=430,Ye=240,tt=window.innerWidth||document.documentElement.clientWidth,Ie=window.innerHeight||document.documentElement.clientHeight,be=Math.floor(Ie*.6),Ae=Math.floor(tt*.92);if(ue<st&&(B=Q+(W-st),ue=st),ue>Ae&&(ue=Ae,B=Math.min(B,tt-8-ue)),B<8&&(B=8,ue=Math.max(st,Math.min(W-(Q-8),tt-16))),B+ue>tt-8&&(ue=Math.max(st,tt-8-B)),_e<Ye&&(_e=Ye,me=fe+(Ne-Ye)),_e>be&&(_e=be,me=Math.max(8,fe-(be-Ne))),me<8){const Ee=8-me;me=8,_e=Math.min(be,Math.max(Ye,_e-Ee))}if(me+_e>Ie-8){const Ee=me+_e-(Ie-8);_e=Math.max(Ye,_e-Ee)}g(M,{...a(M),left:B,top:me,width:ue,height:_e},!0),D.debug("[qv] resize:corner:move",{left:B,top:me,width:ue,height:_e});try{n()&&g(z,a(M).left-n().getBoundingClientRect().left)}catch{}l.updateSettings({quickViewWidth:ue,quickViewHeight:_e})}function We(){O&&(O=!1,te=!1,se=Date.now()+120,D.debug("[qv] resize:corner:up",a(M)),window.removeEventListener("pointermove",X,!0),window.removeEventListener("pointerup",We,!0))}let et=!1,Ue=0,ot=0,ne=0;function we(v){var P,H;v.preventDefault(),v.stopPropagation(),(H=(P=v.target).setPointerCapture)==null||H.call(P,v.pointerId),et=!0,te=!0,Ue=v.clientX,ot=a(M).left,ne=a(M).width,se=Date.now()+250,D.debug("[qv] resize:left:down",{startLLeft:ot,startLW:ne}),window.addEventListener("pointermove",xe,!0),window.addEventListener("pointerup",Ze,!0)}function xe(v){if(!et)return;const P=v.clientX-Ue;let H=ot+P,B=ne-P;const me=430,ue=window.innerWidth||document.documentElement.clientWidth,_e=Math.floor(ue*.92);B<me&&(B=me,H=ot+(ne-me)),B>_e&&(B=_e,H=Math.min(H,ue-8-B)),H<8&&(H=8,B=Math.max(me,Math.min(ne-(ot-8),ue-16))),H+B>ue-8&&(B=Math.max(me,ue-8-H)),g(M,{...a(M),left:H,width:B},!0),D.debug("[qv] resize:left:move",{left:H,width:B});try{n()&&g(z,a(M).left-n().getBoundingClientRect().left)}catch{}l.updateSettings({quickViewWidth:B})}function Ze(){et&&(et=!1,te=!1,se=Date.now()+120,D.debug("[qv] resize:left:up",a(M)),window.removeEventListener("pointermove",xe,!0),window.removeEventListener("pointerup",Ze,!0))}function ut(v){const P=Math.max(0,a(w).length-1);return P===0?0:v<0?P:v>P?0:v}function Se(v){g(S,ut(a(S)+v),!0),queueMicrotask(()=>{var B;const P=(B=a(A))==null?void 0:B.querySelectorAll(".qv-row"),H=P==null?void 0:P[a(S)];H==null||H.scrollIntoView({block:"nearest"})})}function Oe(){var P;const v=a(w)[a(S)];if(v){try{e.plugin.app.commands.executeCommandById(v.id),o.addRecentCommand(v.id)}catch{}a(J)||(P=i())==null||P({restoreFocus:!0,reason:"run-selected"})}}function Fe(v){var me,ue,_e,st,Ye,tt,Ie,be,Ae,Ee,xt,qt,vt,_t,Et,nn;if(!a(L))return;const P=a(L).contains(v.target);if(v.key==="Escape"){if(v.preventDefault(),v.stopPropagation(),(me=v.stopImmediatePropagation)==null||me.call(v),a(d)){g(d,!1);return}(ue=i())==null||ue({restoreFocus:!0,reason:"escape"});return}if((v.key==="f"||v.key==="F"||v.code==="KeyF")&&(v.metaKey||v.ctrlKey)){v.preventDefault(),v.stopPropagation(),(_e=v.stopImmediatePropagation)==null||_e.call(v),document.activeElement!==a(x)?(st=a(x))==null||st.focus():g(d,!a(d));return}if(a(d)){if(v.preventDefault(),v.stopPropagation(),(Ye=v.stopImmediatePropagation)==null||Ye.call(v),v.key==="ArrowDown"){Se(1);return}if(v.key==="ArrowUp"){Se(-1);return}if(v.key==="Tab"){Se(v.shiftKey?-1:1);return}if(v.key==="Enter"){a(N)&&Oe();return}try{(Ie=(tt=a(y)).handlePhysicalKeyDown)==null||Ie.call(tt,v,{inActiveView:!0})}catch{}g(p,(be=a(y))==null?void 0:be.ActiveKey,!0),g(_,((Ae=a(y))==null?void 0:Ae.sortedModifiers)||[],!0),$();return}if(r()&&Date.now()<r().until)try{const pt=[];v.ctrlKey&&pt.push("Control"),v.metaKey&&pt.push("Meta"),v.altKey&&pt.push("Alt"),v.shiftKey&&pt.push("Shift");const Ln=Gi(v.code||v.key||"");if(r().triggers.some(Gt=>bs({modifiers:Hn(Gt.modifiers),key:Gt.key},pt,Ln,{strictModifierMatch:!0,allowKeyOnly:!1,platformize:!0}))){v.preventDefault(),v.stopPropagation(),(Ee=v.stopImmediatePropagation)==null||Ee.call(v),g(d,!0),r(null);return}}catch{}if(!P)return;if((v.key==="f"||v.key==="F"||v.code==="KeyF")&&(v.metaKey||v.ctrlKey)){if(v.preventDefault(),v.stopPropagation(),(xt=v.stopImmediatePropagation)==null||xt.call(v),document.activeElement!==a(x)){(qt=a(x))==null||qt.focus();return}g(d,!a(d));return}if(v.key==="Backspace"&&!a(d)&&String(a(u)||"").trim()===""){if(a(p))(_t=(vt=a(y))==null?void 0:vt.clearActiveKey)==null||_t.call(vt),g(p,"");else if((((Et=a(_))==null?void 0:Et.length)||0)>0){const pt=[...((nn=a(y))==null?void 0:nn.sortedModifiers)||[]];pt.pop(),a(y).ActiveModifiers=pt,g(_,pt,!0)}$(),v.preventDefault(),v.stopPropagation();return}if(v.key==="ArrowDown"){v.preventDefault(),v.stopPropagation(),Se(1);return}if(v.key==="ArrowUp"){v.preventDefault(),v.stopPropagation(),Se(-1);return}if(v.key==="Tab"){v.preventDefault(),v.stopPropagation(),Se(v.shiftKey?-1:1);return}if(v.key==="Enter"){v.preventDefault(),v.stopPropagation(),a(N)&&Oe();return}}function it(v){var P,H,B,me,ue;if(!(!a(L)||!a(d))){v.preventDefault(),v.stopPropagation(),(P=v.stopImmediatePropagation)==null||P.call(v);try{(B=(H=a(y))==null?void 0:H.handlePhysicalKeyUp)==null||B.call(H,v,{inActiveView:!0})}catch{}g(p,(me=a(y))==null?void 0:me.ActiveKey,!0),g(_,((ue=a(y))==null?void 0:ue.sortedModifiers)||[],!0),$()}}let Ve=F(0);gt(()=>{const v=Number(s()||0);Number.isFinite(v)&&v>0&&v!==a(Ve)&&(g(Ve,v,!0),g(d,!0),queueMicrotask(()=>{var P;return(P=a(x))==null?void 0:P.focus()}))});function je(v){var P;e.plugin.addShortcutsView(v),(P=i())==null||P({restoreFocus:!1,reason:"open-full"})}let T=F(!1);const R=[{key:pn.StrictModifierMatch,label:"Strict modifiers"},{key:pn.ViewWOhotkeys,label:"Only with hotkeys"},{key:pn.OnlyDuplicates,label:"Only duplicates"},{key:pn.DisplayInternalModules,label:"Include internal modules"}];function ke(v,P){c.updateGroupFilterSettings(a(f),{[v]:P}),$()}const ie=()=>b();let C=null;Is(()=>{D.debug("[qv] mount",{anchorExists:!!n()});try{g(m,new Mr,!0),g(y,new Sr(e.plugin.app,a(m)),!0),D.debug("[qv] stores initialized")}catch(v){D.error("[qv] failed to init stores",v)}try{oe=new rt.Scope(e.plugin.app.scope),oe.register(["Mod"],"F",v=>{var P,H,B;try{(P=v==null?void 0:v.preventDefault)==null||P.call(v),(H=v==null?void 0:v.stopPropagation)==null||H.call(v),document.activeElement!==a(x)?(B=a(x))==null||B.focus():g(d,!a(d))}catch{}return!0})}catch(v){D.error("[qv] key scope init failed",v)}try{const v=Number(l.settings.quickViewWidth||380),P=Number(l.settings.quickViewHeight||360);g(M,{...a(M),width:Math.max(430,Math.min(520,Number.isFinite(v)?v:380)),height:Math.max(240,Number.isFinite(P)?P:360)},!0),D.debug("[qv] size from settings",a(M))}catch(v){D.error("[qv] read size settings failed",v)}try{g(N,!!l.settings.quickViewAutoRun)}catch(v){D.error("[qv] read quickViewAutoRun failed",v)}try{$()}catch(v){D.error("[qv] refilter on mount failed",v)}try{Ge()}catch(v){D.error("[qv] recompute on mount failed",v)}window.addEventListener("resize",Ge),document.addEventListener("scroll",ie,!0),window.addEventListener("keydown",Fe,!0),window.addEventListener("keyup",it,!0),queueMicrotask(()=>{var v;return(v=a(x))==null?void 0:v.focus()}),g(U,!0)}),ro(()=>{window.removeEventListener("resize",b),document.removeEventListener("scroll",ie,!0),C==null||C.disconnect(),C=null,window.removeEventListener("keydown",Fe,!0),window.removeEventListener("keyup",it,!0),window.removeEventListener("pointermove",X,!0),window.removeEventListener("pointerup",We,!0),window.removeEventListener("pointermove",xe,!0),window.removeEventListener("pointerup",Ze,!0);try{oe&&e.plugin.app.keymap.popScope(oe)}catch{}});let G=F(Be(l.getSetting("lastOpenedGroupId")||"all")),q=null;gt(()=>{const v=a(f);!v||v===a(G)||(q&&clearTimeout(q),q=setTimeout(()=>{try{l.updateSettings({lastOpenedGroupId:v}),g(G,v,!0)}catch(P){D.error("[qv] persist lastOpenedGroupId failed",P)}},200))});var pe=Xe(),ye=Le(pe);{var he=v=>{var P=Df();let H;var B=h(P);B.__pointerdown=ze;var me=k(B,2);me.__pointerdown=we;var ue=k(me,2),_e=h(ue),st=h(_e),Ye=h(st);_o(Ye,{get plugin(){return e.plugin},compact:!0,onChange:()=>$(),get selectedGroup(){return a(f)},set selectedGroup(ce){g(f,ce,!0)}});var tt=k(st,4),Ie=h(tt);Ie.__click=[pf,T];var be=k(Ie,4);be.__click=[hf,J];var Ae=k(be,4);Ae.__click=[vf,je];var Ee=k(Ae,4);Ee.__click=[mf,N,l];var xt=k(_e,2);{var qt=ce=>{var de=_f();Je(de,21,()=>R,It,($e,Ke)=>{var qe=Xe(),dt=Le(qe);nr(dt,()=>a(f),kt=>{var at=yf(),lt=h(at);lt.__change=[gf,ke,Ke];var fn=k(lt);ee(Yt=>{Mt(lt,Yt),ae(fn,` ${a(Ke).label??""}`)},[()=>c.getGroupSettings(a(f))[a(Ke).key]]),E(kt,at)}),E($e,qe)}),E(ce,de)};ve(xt,ce=>{a(T)&&ce(qt)})}var vt=k(xt,2);let _t;var Et=h(vt),nn=h(Et);Je(nn,17,()=>{var ce;return((ce=a(y))==null?void 0:ce.sortedModifiers)||[]},It,(ce,de)=>{var $e=wf();$e.__click=[bf,y,de,_,p,$],$e.__keydown=[kf,y,de,_,p,$];var Ke=h($e);ee(qe=>ae(Ke,qe),[()=>l.settings.useBakedKeyNames?Cr(a(de)):a(de)]),E(ce,$e)});var pt=k(nn,2);{var Ln=ce=>{var de=Cf();de.__click=[Mf,y,p,_,$],de.__keydown=[Sf,y,p,_,$];var $e=h(de);ee(Ke=>ae($e,Ke),[()=>{var Ke,qe;return l.settings.useBakedKeyNames?Ar(a(p)):((qe=(Ke=a(y))==null?void 0:Ke.getDisplayKey)==null?void 0:qe.call(Ke))||a(p)}]),E(ce,de)};ve(pt,ce=>{a(p)&&ce(Ln)})}var Kn=k(Et,2),Gt=h(Kn);Gt.__input=[df,$],Gt.__keydown=[ff,d,u,p,y,_,$],$n(Gt,ce=>g(x,ce),()=>a(x));var hi=k(Gt,2),nt=h(hi);nt.__click=[uf,d,x];var ht=h(nt);go(ht,{size:16});var sn=k(nt,2);sn.__click=[cf,u,y,p,_,$,x];var bt=h(sn);Ii(bt,{size:16});var Rt=k(ue,2),Qt=h(Rt);{var mt=ce=>{var de=Af();E(ce,de)},_n=ce=>{var de=Xe(),$e=Le(de);Je($e,19,()=>a(w),Ke=>Ke.id,(Ke,qe,dt)=>{var kt=Ef();kt.__click=()=>{g(S,a(dt),!0),a(N)&&Oe()},kt.__keydown=Yt=>{(Yt.key==="Enter"||Yt.key===" ")&&(Yt.preventDefault(),g(S,a(dt),!0),a(N)&&Oe())};var at=h(kt),lt=h(at),fn=k(at,2);Je(fn,21,()=>a(qe).hotkeys,It,(Yt,Ht)=>{var rn=xf(),mi=h(rn);ee(gi=>ae(mi,gi),[()=>l.settings.useBakedKeyNames?Ms(a(Ht)):e.plugin.hotkeyManager.renderHotkey(a(Ht))]),E(Yt,rn)}),ee(()=>{Ce(kt,1,`qv-row ${a(dt)===a(S)?"is-selected":""}`,"svelte-19pvtfz"),le(kt,"aria-selected",a(dt)===a(S)),ae(lt,a(qe).name)}),E(Ke,kt)}),E(ce,de)};ve(Qt,ce=>{a(w).length===0?ce(mt):ce(_n,!1)})}$n(Rt,ce=>g(A,ce),()=>a(A)),Pi(P,ce=>St==null?void 0:St(ce)),$n(P,ce=>g(L,ce),()=>a(L)),ee((ce,de,$e,Ke)=>{H=Ce(P,1,"qv svelte-19pvtfz",null,H,ce),Rn(P,`position: fixed; top:${a(M).top??""}px; left:${a(M).left??""}px; width:${a(M).width??""}px; height:${de??""}px;`),le(Ie,"aria-expanded",a(T)),Ce(be,1,`qv-btn ${a(J)?"is-on":""}`,"svelte-19pvtfz"),le(be,"title",a(J)?"Unpin popover":"Pin popover to prevent auto-close"),le(be,"aria-pressed",a(J)),Ce(Ee,1,`qv-btn ${a(N)?"is-on":""}`,"svelte-19pvtfz"),le(Ee,"title",a(N)?"Click/Enter runs command":"Select only; no run on Enter/click"),_t=Ce(vt,1,"search-wrapper svelte-19pvtfz",null,_t,$e),Ce(nt,1,`keyboard-icon icon ${a(d)?"pulse":""}`,"svelte-19pvtfz"),le(nt,"aria-label",Ke),le(nt,"aria-pressed",a(d)),le(nt,"title",a(d)?"Deactivate key listener (Esc)":"Activate key listener")},[()=>({"is-above":a(K)}),()=>Math.min(a(M).height,Math.floor((window.innerHeight||600)*.6)),()=>({"is-focused":document.activeElement===a(x)}),()=>a(d)?"Press Esc to deactivate key listener":`Press ${En(["Mod"])[0]}+F or long press to activate key listener`]),Qe("click_outside",P,()=>{var ce;Date.now()<se||a(J)||(ce=i())==null||ce({restoreFocus:!0,reason:"click-outside"})}),Qe("mouseenter",P,()=>{try{oe&&e.plugin.app.keymap.pushScope(oe)}catch{}}),Qe("mouseleave",P,()=>{try{oe&&e.plugin.app.keymap.popScope(oe)}catch{}}),di(Gt,()=>a(u),ce=>g(u,ce)),E(v,P)};ve(ye,v=>{a(U)&&v(he)})}E(t,pe),tn()}yn(["pointerdown","click","change","keydown","input"]);class Kf extends rt.PluginSettingTab{constructor(n){super(n.app,n);Z(this,"plugin");this.plugin=n}display(){const{containerEl:n}=this;n.empty(),n.createEl("h2",{text:"Keyboard Analyzer"}),new rt.Setting(n).setName("Enable developer options").setDesc("Show extra developer tools in the UI and settings.").addToggle(i=>{i.setValue(!!this.plugin.settingsManager.getSetting("enableDeveloperOptions")),i.onChange(s=>{this.plugin.settingsManager.updateSettings({enableDeveloperOptions:s})})}),new rt.Setting(n).setName("Developer logging").setDesc("Enable verbose logging to the console for diagnostics.").addToggle(i=>{i.setValue(!!this.plugin.settingsManager.getSetting("devLoggingEnabled")),i.onChange(s=>{this.plugin.settingsManager.updateSettings({devLoggingEnabled:s}),gs(s)})}),new rt.Setting(n).setName("Emulated OS").setDesc("Temporarily override OS to test modifier mapping.").addDropdown(i=>{i.addOption("none","None"),i.addOption("windows","Windows"),i.addOption("macos","macOS"),i.addOption("linux","Linux"),i.setValue(this.plugin.settingsManager.getSetting("emulatedOS")||"none"),i.onChange(s=>{const r=s;this.plugin.settingsManager.updateSettings({emulatedOS:r}),ys(r)})}),new rt.Setting(n).setName("Use baked key names").setDesc("Show human-friendly key names (e.g., Backspace, Up Arrow, Cmd). Turn off to debug raw keys/glyphs.").addToggle(i=>{i.setValue(!!this.plugin.settingsManager.getSetting("useBakedKeyNames")),i.onChange(s=>{this.plugin.settingsManager.updateSettings({useBakedKeyNames:s})})}),new rt.Setting(n).setName("Key listener scope").setDesc("Restrict the active key listener to the Analyzer view, or allow it globally (global requires modifiers: On hold).").addDropdown(i=>{i.addOption("activeView","Active view only"),i.addOption("global","Global");const s=this.plugin.settingsManager.getSetting("keyListenerScope")||"activeView";i.setValue(s),i.onChange(r=>{const o=r||"activeView",l=this.plugin.settingsManager.getSetting("modifierActivationMode")||"click";o==="global"&&l!=="press"?this.plugin.settingsManager.updateSettings({keyListenerScope:"activeView"}):this.plugin.settingsManager.updateSettings({keyListenerScope:o})})}),new rt.Setting(n).setName("Modifier activation").setDesc("Choose how modifiers activate: On click (to add / remove) or On hold (select on hold, clears when released). Applies to modifiers only globally. Inside the Analyzer view, when the listener is active, you can select keys by clicking or by pressing keys; globally only modifiers are tracked.").addDropdown(i=>{i.addOption("click","On click"),i.addOption("press","On hold"),i.setValue(this.plugin.settingsManager.getSetting("modifierActivationMode")||"click"),i.onChange(s=>{const r=s||"click",o=this.plugin.settingsManager.getSetting("keyListenerScope")||"activeView",l={modifierActivationMode:r};r==="click"&&o==="global"&&(l.keyListenerScope="activeView"),this.plugin.settingsManager.updateSettings(l)})}),new rt.Setting(n).setName("Search debounce (ms)").setDesc("Delay before applying text filter changes.").addText(i=>{i.inputEl.type="number",i.setPlaceholder("200"),i.setValue(String(this.plugin.settingsManager.getSetting("searchDebounceMs")??200)),i.onChange(s=>{const r=Number(s);this.plugin.settingsManager.updateSettings({searchDebounceMs:Number.isFinite(r)?r:200})})})}}class Pf extends rt.Plugin{constructor(n,i){super(n,i);Z(this,"commandsManager");Z(this,"hotkeyManager");Z(this,"settingsManager");Z(this,"groupManager");Z(this,"registeredGroupCommandIds",new Set);Z(this,"quickViewComponent",null);Z(this,"quickViewAnchorEl",null);Z(this,"quickViewPrevActiveEl",null);Z(this,"lastQuickViewInvoke",0);Z(this,"quickViewListenNonce",0);Z(this,"quickViewListeningActive",!1);Z(this,"lastQuickViewCloseAt",0);Z(this,"quickViewArm",null);this.settingsManager=ws.getInstance(this),this.groupManager=ks.getInstance(this.settingsManager),this.commandsManager=Oi.getInstance(this.app,this),this.hotkeyManager=Fi.getInstance(this.app),this.hotkeyManager.attachCommandsManager(this.commandsManager)}get full(){const n=this.app.workspace.getLeavesOfType(Wt),i=n.length?n[0]:null;return(i==null?void 0:i.view)instanceof Us?i.view:null}async focusView(n){const i=this.full;i&&this.app.workspace.revealLeaf(i.leaf)}async onload(){await this.settingsManager.loadSettings();try{this.groupManager.normalizeAllGroups()}catch{}await this.hotkeyManager.initialize(),this.commandsManager.initialize(),gs(!!this.settingsManager.getSetting("devLoggingEnabled")),fo("debug"),ys(this.settingsManager.getSetting("emulatedOS")||"none"),this.registerPluginHotkeys(),this.registerGroupOpenCommand(),this.syncPerGroupCommands(),this.addStatusBarIndicator(),this.addQuickViewCommand(),this.registerView(Wt,n=>new Us(n,this)),this.addSettingTab(new Kf(this)),this.app.workspace.onLayoutReady(()=>{this.app.workspace.getLeavesOfType(Wt).forEach(n=>{n.view instanceof Us&&(n.view.plugin=this,n.view.onOpen())})})}async onunload(){try{await this.settingsManager.flushAllSaves()}catch{}this.app.workspace.detachLeavesOfType(Wt)}addStatusBarIndicator(){const n=this.addStatusBarItem();n.addClass("mod-clickable"),n.setAttribute("aria-label","Keyboard Shortcuts"),n.setAttribute("title","Quick View — Click to open. Cmd/Ctrl+Click opens full view. Alt+Meta splits."),n.style.order="10";const i=n.createSpan("icon");rt.setIcon(i,"keyboard-glyph"),this.quickViewAnchorEl=i,i.addEventListener("click",s=>this.onStatusBarClick(s)),i.addEventListener("contextmenu",s=>{s.preventDefault();try{this.quickViewPrevActiveEl=document.activeElement}catch{}this.quickViewComponent?this.closeQuickView():this.openQuickView(!1)})}async onStatusBarClick(n){const i=n.ctrlKey===!0||n.metaKey===!0,s=n.altKey===!0;try{this.quickViewPrevActiveEl=document.activeElement}catch{}if(i){let r=!1;r=s?"split":!0,this.addShortcutsView(r);return}if(this.quickViewComponent){this.closeQuickView();return}Date.now()-this.lastQuickViewCloseAt<200||this.openQuickView(!1)}async addShortcutsView(n=!1){const i=this.app.workspace.getLeavesOfType(Wt);if(i.length>0&&!n){this.app.workspace.revealLeaf(i[0]);return}await this.app.workspace.getLeaf(n||!1).setViewState({type:Wt,active:!0})}registerPluginHotkeys(){this.addCommand({id:"open-shortcuts-analyzer-view",name:"Open keyboard shortcuts view",checkCallback:n=>{if(this.app.workspace.getLeavesOfType(Wt).length===0)return n||this.addShortcutsView(),!0}}),this.addCommand({id:"focus-shortcuts-analyzer-view",name:"Focus keyboard shortcuts view",checkCallback:n=>(n||this.focusView(Wt),!0)})}registerGroupOpenCommand(){this.addCommand({id:"open-keyboard-analyzer-group",name:"Open Keyboard Analyzer: Group…",callback:()=>this.openGroupPicker()})}addQuickViewCommand(){this.addCommand({id:"open-quick-view",name:"Open Quick View",callback:()=>{try{this.quickViewPrevActiveEl=document.activeElement}catch{}const n=Date.now(),i=n-this.lastQuickViewInvoke<=500;if(this.lastQuickViewInvoke=n,!this.quickViewComponent){const s=n-this.lastQuickViewCloseAt<250;this.openQuickView(i&&!s,!0);return}i?this.enterQuickViewListenMode():this.closeQuickView()}})}openQuickView(n=!1,i=!1){try{if(!this.quickViewPrevActiveEl)try{this.quickViewPrevActiveEl=document.activeElement}catch{}const s=this.quickViewAnchorEl||document.querySelector(".status-bar-item.plugin-keyboard-analyzer span.icon");if(this.quickViewAnchorEl=s||this.quickViewAnchorEl,n?(this.quickViewListenNonce++,this.quickViewListeningActive=!0):this.quickViewListeningActive=!1,this.quickViewArm=null,i)try{const r=`${this.manifest.id}:open-quick-view`,o=this.app.hotkeyManager.getDefaultHotkeys(r)||[],l=this.app.hotkeyManager.customKeys[r]||[],c=new Map,u=m=>Array.isArray(m)?m:typeof m=="string"?m?m.split(","):[]:[],d=(m,y)=>{const p=u(m),_=[...p].sort().join(",");c.set(`${_}|${y}`,{modifiers:p,key:y})};for(const m of o)d(m.modifiers,m.key||"");for(const m of l)d(m.modifiers,m.key||"");const f=Array.from(c.values());f.length&&(this.quickViewArm={triggers:f,until:Date.now()+900})}catch{}this.quickViewComponent=ja(Lf,{target:document.body,props:{plugin:this,anchorEl:this.quickViewAnchorEl,onClose:r=>this.closeQuickView(r),listenToggle:this.quickViewListeningActive?this.quickViewListenNonce:0,armTriggers:this.quickViewArm}})}catch(s){this.quickViewComponent=null,this.quickViewListeningActive=!1;try{if(!!this.settingsManager.getSetting("devLoggingEnabled")){const o=s instanceof Error?`${s.message}
${s.stack||""}`:String(s);console.error("[Keyboard Analyzer] Quick View mount failed:",o)}}catch{}}}closeQuickView(n){var s,r,o;if(this.quickViewComponent){try{Qa(this.quickViewComponent)}catch{}this.quickViewComponent=null}if(this.quickViewListeningActive=!1,this.lastQuickViewCloseAt=Date.now(),this.quickViewArm=null,(n==null?void 0:n.restoreFocus)!==!1){let l=!1;try{const c=this.quickViewPrevActiveEl;c&&c.isConnected&&((s=c.focus)==null||s.call(c,{preventScroll:!0}),l=document.activeElement===c)}catch{}if(!l)try{const c=this.app.workspace.getActiveViewOfType(rt.MarkdownView);(o=(r=c==null?void 0:c.editor)==null?void 0:r.focus)==null||o.call(r)}catch{}}this.quickViewPrevActiveEl=null}enterQuickViewListenMode(){var n,i;if(!this.quickViewComponent){this.openQuickView(!0);return}this.quickViewListeningActive=!0,this.quickViewListenNonce++;try{(i=(n=this.quickViewComponent)==null?void 0:n.update)==null||i.call(n,{listenToggle:this.quickViewListenNonce})}catch{this.closeQuickView(),this.openQuickView(!0)}}async openGroupPicker(){const n=this,i=[{id:"all",name:"All Commands"},...n.settingsManager.settings.commandGroups];class s extends rt.SuggestModal{constructor(c,u){super(c);Z(this,"available");this.available=u,this.setPlaceholder("Open group…")}getSuggestions(c){const u=c.toLowerCase().trim();return u?this.available.filter(d=>d.name.toLowerCase().includes(u)):this.available}renderSuggestion(c,u){u.setText(c.name)}onChooseSuggestion(c){n.openWithGroup(c.id)}}new s(this.app,i.map(o=>({id:String(o.id),name:o.name}))).open()}async openWithGroup(n){this.settingsManager.updateSettings({lastOpenedGroupId:n}),await this.addShortcutsView(!1)}syncPerGroupCommands(){for(const i of this.registeredGroupCommandIds)try{this.app.commands.removeCommand(i)}catch{}this.registeredGroupCommandIds.clear();const n=this.settingsManager.getSetting("commandGroups")||[];for(const i of n){if(!(i!=null&&i.registerCommand))continue;const s=`open-group:${String(i.id)}`,r=`${this.manifest.id}:${s}`;this.addCommand({id:s,name:`Open: ${i.name}`,callback:()=>this.openWithGroup(String(i.id))}),this.registeredGroupCommandIds.add(r)}}}module.exports=Pf;


/* nosourcemap */